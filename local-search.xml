<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>script标签中的async和defer属性</title>
    <link href="/2022/10/01/script%E6%A0%87%E7%AD%BE%E4%B8%AD%E7%9A%84async%E5%92%8Cdefer%E5%B1%9E%E6%80%A7/"/>
    <url>/2022/10/01/script%E6%A0%87%E7%AD%BE%E4%B8%AD%E7%9A%84async%E5%92%8Cdefer%E5%B1%9E%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<h1>script标签中的async和defer属性</h1><blockquote><p><a href="https://www.growingwiththeweb.com/2014/02/async-vs-defer-attributes.html">参考地址</a></p></blockquote><p>在 HTML 中会遇到以下三类 script：</p><ul><li><code>&lt;script src='xxx'&gt;&lt;/script&gt;</code></li><li><code>&lt;script src='xxx' async&gt;&lt;/script&gt;</code></li><li><code>&lt;script src='xxx' defer&gt;&lt;/script&gt;</code></li></ul><p><img src="0.jpg" alt="解释"></p><h2 id="script">script</h2><p>浏览器在解析HTML的时候，如果遇到一个没有任何属性的<code>script</code>标签，就会暂停解析，，先发送网络请求获取该JS脚本的代码内容，然后让JS引擎执行该代码，当代码执行完毕后恢复解析。</p><p><code>script</code> 会阻塞浏览器对 HTML 的解析，如果获取 JS 脚本的网络请求迟迟得不到响应，或者 JS 脚本执行时间过长，都会导致白屏，用户看不到页面内容。</p><p><img src="1.jpg" alt="script"></p><h2 id="async-script">async script</h2><p>当浏览器遇到带有 async 属性的 script 时，请求该脚本的网络请求是异步的，不会阻塞浏览器解析 HTML，一旦网络请求回来之后，如果此时 HTML 还没有解析完，浏览器会暂停解析，先让 JS 引擎执行代码，执行完毕后再进行解析。</p><p>但如果在 JS 脚本请求回来之前，HTML 已经解析完毕了，那就会立即执行 JS 代码，这种情况下就不会阻塞浏览器解析HTML。</p><p><img src="2.jpg" alt="async script"></p><h2 id="defer-script">defer script</h2><p>当浏览器遇到带有 defer 属性的 script 时，获取该脚本的网络请求也是异步的，不会阻塞浏览器解析 HTML，一旦网络请求回来之后，如果此时 HTML 还没有解析完，浏览器不会暂停解析并执行 JS 代码，而是等待 HTML 解析完毕再执行 JS 代码。</p><p>如果存在多个 defer script 标签，浏览器（IE9及以下除外）会保证它们按照在 HTML 中出现的顺序执行，不会破坏 JS 脚本之间的依赖关系。</p><p><img src="3.jpg" alt="defer script"></p><h2 id="总结">总结</h2><p>不同类型 script 的执行顺序及其是否阻塞解析 HTML 总结如下：</p><table><thead><tr><th>script 标签</th><th>JS 执行顺序</th><th>是否阻塞解析 HTML</th></tr></thead><tbody><tr><td><code>&lt;script&gt;</code></td><td>在 HTML 中的顺序</td><td>阻塞</td></tr><tr><td><code>&lt;script async&gt;</code></td><td>网络请求返回顺序</td><td>可能阻塞，也可能不阻塞</td></tr><tr><td><code>&lt;script defer&gt;</code></td><td>在 HTML 中的顺序</td><td>不阻塞</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>CSS和HTML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>单页面应用路由实现</title>
    <link href="/2022/09/29/%E5%8D%95%E9%A1%B5%E9%9D%A2%E5%BA%94%E7%94%A8%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/09/29/%E5%8D%95%E9%A1%B5%E9%9D%A2%E5%BA%94%E7%94%A8%E8%B7%AF%E7%94%B1%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1>单页面应用路由实现</h1><h2 id="单页面应用与多页面应用">单页面应用与多页面应用</h2><h3 id="什么是单页面应用？">什么是单页面应用？</h3><p>单页面应用指的是第一次进入页面的时候会请求一个<code>html</code>文件，切换到其他组件的时候，虽然路径会发生相应的变化，但是没有新的<code>html</code>文件请求，原理是<code>javascript</code>会感知到<code>url</code>的变化，然后<code>javascript</code>会动态的将当前页面的内容清除掉，然后将下一个页面的内容挂载到当前的页面上，这个时候的路由不是由后端做的而是由前端来做的，来判断页面到底显示哪个组件，这个过程就是单页面应用。</p><h3 id="单页面应用的优缺点">单页面应用的优缺点</h3><ul><li>优点：页面切换快，因为页面每次切换的时候，并不需要做<code>html</code>文件的请求，这样就减少了很多<code>http</code>发送的时延。</li><li>缺点：单页面应用的首屏加载时间比较慢，首屏加载需要一个<code>html</code>请求和一次<code>javascript</code>请求，时间相对较慢。而且SEO效果差，因为搜索引擎只认识<code>html</code>中的内容，但是单页面应用中的内容很多需要靠<code>javascript</code>渲染出来，搜索引擎不识别这一部分的内容，就会导致SEO效果不好。</li></ul><h3 id="什么是多页面应用？">什么是多页面应用？</h3><p>多页面应用指的是每一次页面跳转，服务器都会返回一个新的HTML资源，这种类型的应用就叫做多页面应用。</p><h3 id="多页面应用的优缺点">多页面应用的优缺点</h3><ul><li>优点：首屏加载快，SEO效果好。因为客户端向服务端发送请求的时候，服务端只返回一个HTML页面，所以加载比较快。</li><li>缺点：页面切换比较慢。</li></ul><h3 id="单页面应用和多页面应用的区别">单页面应用和多页面应用的区别</h3><ol><li><p>应用构成不同</p><p>多页面应用是由多个不同的页面构成，单页面应用是一个外壳页面和多个页面片段构成。</p></li><li><p>页面跳转方式不同</p><p>多页面应用的页面跳转是从一个页面跳转到另一个页面，而单页面应用则是把一个页面片段删除或隐藏，加载另一个页面片段。</p></li><li><p>跳转后公共资源是否重新加载。</p><p>跳转后多页面应用是需要进行重新加载的，但的那页面不需要重新加载。</p></li><li><p>用户体验不同</p><p>多页面应用首屏加载快但是切换慢，单页面应用首屏加载慢但是切换快。</p></li><li><p>页面传递数据的方式不同</p><p>多页面应用依靠<code>URL</code>、<code>Cookie</code>、<code>LocalStorage</code>来传递数据，单页面应用则是靠组件进行通信，相对更加简单。</p></li></ol><h2 id="单页面的路由实现原理">单页面的路由实现原理</h2><blockquote><p>前端路由本质上是在不刷新浏览器的请求下修改URL、检测URL的变化，截获URL的地址，通过解析、匹配路由规则从而实现UI的更新。路由的实现通常有两种形式，一种是Hash模式，一种是History模式。</p></blockquote><h3 id="Hash路由的原理">Hash路由的原理</h3><p>在Hash模式下，<code>url</code>中#后面的部分表示的是一个客户端状态，当这部分发生改变的时候，浏览器本身就不会刷新，即在不刷新浏览器的情况下修改浏览器链接，同时监听<code>hashChange</code>事件来监听<code>url</code>中<code>hash</code>值的变化，触发相关函数，改变相关组件。</p><h3 id="History路由的原理">History路由的原理</h3><p><code>History</code>模式利用了HTML5中<code>history</code>的API，<code>history.pushState</code>和<code>history.replaceState</code>这两个方法可以在不刷新页面的情况下，操作浏览器的历史记录，然后通过监听<code>popState</code>事件来监听<code>url</code>的变化，触发相关函数，改变相关组件。</p>]]></content>
    
    
    <categories>
      
      <category>浏览器</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Event-Loop</title>
    <link href="/2022/09/22/Event-Loop/"/>
    <url>/2022/09/22/Event-Loop/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Promise/A+</title>
    <link href="/2022/09/20/Promise-A/"/>
    <url>/2022/09/20/Promise-A/</url>
    
    <content type="html"><![CDATA[<h1>Promise/A</h1><blockquote><p><a href="https://github.com/promises-aplus">Promise/A+</a>可以用来检验手写的Promise时候合格，一共872个样例。</p></blockquote><h2 id="如何使用">如何使用</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yarn init<br>yarn add -D promises-aplus-tests<br></code></pre></div></td></tr></table></figure><ul><li>初始化并安装<code>npm</code>包（笔者习惯用<code>yarn</code>）。</li><li>把自己的写好的<code>Promise</code>对象放入一个文件，命名为<code>TestPromise.js</code>。</li><li>根据<code>github</code>上的描述增加一个静态方法，并用<code>commonJS</code>的方式导出<code>promise</code>类，</li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">myPromise.<span class="hljs-property">deferred</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> result = &#123;&#125;;<br>  result.<span class="hljs-property">promise</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    result.<span class="hljs-property">resolve</span> = resolve;<br>    result.<span class="hljs-property">reject</span> = reject;<br>  &#125;);<br><br>  <span class="hljs-keyword">return</span> result;<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = myPromise;<br></code></pre></div></td></tr></table></figure><h2 id="如何手写">如何手写</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PENDING</span> = <span class="hljs-string">&quot;pending&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FULFILLED</span> = <span class="hljs-string">&quot;fulfilled&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">REJECTED</span> = <span class="hljs-string">&quot;rejected&quot;</span>;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">myPromise</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">fn</span>) &#123;<br>    <span class="hljs-comment">// 状态</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-variable constant_">PENDING</span>;<br>    <span class="hljs-comment">// 终值</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;<br>    <span class="hljs-comment">// 拒因</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;<br>    <span class="hljs-comment">// 执行回调队列</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span> = [];<br>    <span class="hljs-comment">// 拒绝回调队列</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span> = [];<br><br>    <span class="hljs-comment">// 执行的方法</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; &#123;<br>      <span class="hljs-comment">// 需要异步，这里使用宏任务</span><br>      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-variable constant_">PENDING</span>) &#123;<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-variable constant_">FULFILLED</span>;<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;<br>          <span class="hljs-comment">// 等待态-&gt;执行态</span><br>          <span class="hljs-comment">// 需要调用执行回调队列的所有方法</span><br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">f</span>) =&gt;</span> <span class="hljs-title function_">f</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>));<br>        &#125;<br>      &#125;);<br>    &#125;;<br><br>    <span class="hljs-comment">// 拒绝的方法</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; &#123;<br>      <span class="hljs-comment">// 需要异步，这里使用宏任务</span><br>      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-variable constant_">PENDING</span>) &#123;<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-variable constant_">REJECTED</span>;<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;<br>          <span class="hljs-comment">// 等待态-&gt;拒绝态</span><br>          <span class="hljs-comment">// 需要调用拒绝回调队列的所有方法</span><br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">f</span>) =&gt;</span> <span class="hljs-title function_">f</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>));<br>        &#125;<br>      &#125;);<br>    &#125;;<br><br>    <span class="hljs-comment">// 如果报错，就调用拒绝方法</span><br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-title function_">fn</span>(resolve, reject);<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>      <span class="hljs-title function_">reject</span>(e);<br>    &#125;<br>  &#125;<br><br><span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) &#123;<br>    <span class="hljs-keyword">let</span> promise;<br><br>    <span class="hljs-keyword">const</span> isFunFulfilled = <span class="hljs-keyword">typeof</span> onFulfilled === <span class="hljs-string">&quot;function&quot;</span>;<br>    <span class="hljs-keyword">const</span> isFunRejected = <span class="hljs-keyword">typeof</span> onRejected === <span class="hljs-string">&quot;function&quot;</span>;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-variable constant_">PENDING</span>) &#123;<br>      promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 是否函数判断、写到里面一层</span><br>            <span class="hljs-keyword">if</span> (isFunFulfilled) &#123;<br>              <span class="hljs-keyword">const</span> x = <span class="hljs-title function_">onFulfilled</span>(value);<br>              <span class="hljs-title class_">ResolutionProcedure</span>(promise, x, resolve, reject);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-comment">// 在构造函数里，如果状态完成或失败了，会执行相应的回调队列。</span><br>              <span class="hljs-comment">// 在这个方法内部，肯定是状态完成了，才执行的。</span><br>              <span class="hljs-comment">// 而且value也是this.value</span><br>              <span class="hljs-title function_">resolve</span>(value);<br>            &#125;<br>          &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-title function_">reject</span>(e);<br>          &#125;<br>        &#125;);<br><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 与上面同理</span><br>            <span class="hljs-keyword">if</span> (isFunRejected) &#123;<br>              <span class="hljs-keyword">const</span> x = <span class="hljs-title function_">onRejected</span>(reason);<br>              <span class="hljs-title class_">ResolutionProcedure</span>(promise, x, resolve, reject);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-title function_">reject</span>(reason);<br>            &#125;<br>          &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-title function_">reject</span>(e);<br>          &#125;<br>        &#125;);<br>      &#125;);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-variable constant_">FULFILLED</span>) &#123;<br>      promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 是否函数判断、写到里面一层</span><br>            <span class="hljs-keyword">if</span> (isFunFulfilled) &#123;<br>              <span class="hljs-keyword">const</span> x = <span class="hljs-title function_">onFulfilled</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);<br>              <span class="hljs-title class_">ResolutionProcedure</span>(promise, x, resolve, reject);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-comment">// 看看45行，状态是完成的了</span><br>              <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);<br>            &#125;<br>          &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-title function_">reject</span>(e);<br>          &#125;<br>        &#125;);<br>      &#125;);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-variable constant_">REJECTED</span>) &#123;<br>      promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>          <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 与上面同理</span><br>            <span class="hljs-keyword">if</span> (isFunRejected) &#123;<br>              <span class="hljs-keyword">const</span> x = <span class="hljs-title function_">onRejected</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);<br>              <span class="hljs-title class_">ResolutionProcedure</span>(promise, x, resolve, reject);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-title function_">reject</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);<br>            &#125;<br>          &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-title function_">reject</span>(e);<br>          &#125;<br>        &#125;);<br>      &#125;);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> promise;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">ResolutionProcedure</span>(<span class="hljs-params">promise, x, resolve, reject</span>) &#123;<br>  <span class="hljs-keyword">if</span> (promise === x) &#123;<br>    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;循环引用&quot;</span>));<br>    <span class="hljs-keyword">return</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (x <span class="hljs-keyword">instanceof</span> myPromise) &#123;<br>    <span class="hljs-keyword">switch</span> (x.<span class="hljs-property">state</span>) &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-attr">PENDING</span>:<br>        x.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> &#123;<br>          <span class="hljs-title class_">ResolutionProcedure</span>(promise, value, resolve, reject);<br>        &#125;, reject);<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-attr">FULFILLED</span>:<br>        <span class="hljs-title function_">resolve</span>(x.<span class="hljs-property">value</span>);<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-attr">REJECTED</span>:<br>        <span class="hljs-title function_">reject</span>(x.<span class="hljs-property">reason</span>);<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x &amp;&amp; [<span class="hljs-string">&quot;object&quot;</span>, <span class="hljs-string">&quot;function&quot;</span>].<span class="hljs-title function_">includes</span>(<span class="hljs-keyword">typeof</span> x)) &#123;<br>    <span class="hljs-keyword">let</span> firstRun = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">const</span> then = x.<span class="hljs-property">then</span>;<br><br>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> then === <span class="hljs-string">&quot;function&quot;</span>) &#123;<br>        <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolvePromise</span> = (<span class="hljs-params">y</span>) =&gt; &#123;<br>          <span class="hljs-keyword">if</span> (firstRun) <span class="hljs-keyword">return</span>;<br>          firstRun = <span class="hljs-literal">true</span>;<br>          <span class="hljs-title class_">ResolutionProcedure</span>(promise, y, resolve, reject);<br>        &#125;;<br><br>        <span class="hljs-keyword">const</span> <span class="hljs-title function_">rejectPromise</span> = (<span class="hljs-params">r</span>) =&gt; &#123;<br>          <span class="hljs-keyword">if</span> (firstRun) <span class="hljs-keyword">return</span>;<br>          firstRun = <span class="hljs-literal">true</span>;<br>          <span class="hljs-title function_">reject</span>(r);<br>        &#125;;<br><br>        then.<span class="hljs-title function_">call</span>(x, resolvePromise, rejectPromise);<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_">resolve</span>(x); <span class="hljs-comment">// 2.3.3.4 如果then不是函数，用x来完成promise</span><br>      &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>      <span class="hljs-keyword">if</span> (firstRun) <span class="hljs-keyword">return</span>;<br>      firstRun = <span class="hljs-literal">true</span>;<br>      <span class="hljs-title function_">reject</span>(e);<br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_">resolve</span>(x); <span class="hljs-comment">// 2.3.4 如果x不是对象或者函数，用x来完成promise</span><br>  &#125;<br>&#125;<br><br>myPromise.<span class="hljs-property">deferred</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> result = &#123;&#125;;<br>  result.<span class="hljs-property">promise</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">myPromise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) &#123;<br>    result.<span class="hljs-property">resolve</span> = resolve;<br>    result.<span class="hljs-property">reject</span> = reject;<br>  &#125;);<br><br>  <span class="hljs-keyword">return</span> result;<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = myPromise;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VDOM</title>
    <link href="/2022/09/17/VDOM/"/>
    <url>/2022/09/17/VDOM/</url>
    
    <content type="html"><![CDATA[<h1>VDOM</h1><blockquote><p>一个手写的VDOM类库</p></blockquote><h2 id="使用babel转换jsx代码">使用babel转换jsx代码</h2><blockquote><p>目前实现jsx到js的转换不需要完全依赖react的库，只需要用babel的新插件</p></blockquote><h3 id="配置环境">配置环境</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yarn init<br>yarn add -D @babel/cli @babel/core @babel/plugin-transform-react-jxs<br></code></pre></div></td></tr></table></figure><h3 id="运行babel">运行babel</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">./node_modules/.bin/babel src --out-dir lib<br></code></pre></div></td></tr></table></figure><h2 id="createVdom">createVdom</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 1.利用函数创建一个vdom，传入三个参数</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">createVdom</span> = (<span class="hljs-params">type, props, ...children</span>) =&gt;&#123;<br><span class="hljs-keyword">return</span> &#123;<br>type,<br>props,<br>children,<br>&#125;;<br>&#125;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createVdom;<br></code></pre></div></td></tr></table></figure><h2 id="convertVdom">convertVdom</h2><ul><li><code>isCustomProp</code>：对<code>prop</code>的判断</li><li><code>isEventProp</code>：对事件回调属性的判断</li><li><code>extractEventName</code>：处理事件回调属性的<code>key</code></li><li><code>setProp</code>：设置属性</li><li><code>toRealDom</code>：转化成真实<code>dom</code>的主函数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 2.将虚拟dom转化成真实dom</span><br><span class="hljs-comment">/*关于 isCustomProp 函数:</span><br><span class="hljs-comment">有一类属性是我们的自定义属性，例如主流框架中的组件间的状态传递，</span><br><span class="hljs-comment">即通过props来进行传递的，我们并不希望这一类属性显示在 DOM 中，</span><br><span class="hljs-comment">因此需要编写一个函数isCustomProp来检查这个属性是否是自定义属性，</span><br><span class="hljs-comment">因为本文只是为了实现 Virtual DOM 的核心思想，为了方便，在本文中，这个函数直接返回false。</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">isCustomProp</span> =(<span class="hljs-params">name</span>)=&gt;&#123;<br><span class="hljs-comment">/* 这里需要对prop进行判断 */</span><br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-comment">//判断是否有事件回调属性</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">isEventProp</span> =(<span class="hljs-params">name</span>)=&gt; &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-regexp">/^on/</span>.<span class="hljs-title function_">test</span>(name);<br>&#125;<br><br><span class="hljs-comment">//去掉on，在JSX中还要转化成小写</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">extractEventName</span> =(<span class="hljs-params">name</span>) =&gt;&#123;<br><span class="hljs-keyword">return</span> name.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">toLowerCase</span>();<br>&#125;<br><br><span class="hljs-comment">//给真实dom设置prop</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">setProp</span> =(<span class="hljs-params">$target, name, value</span>)=&gt; &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_">isCustomProp</span>(name)) &#123;<br><span class="hljs-keyword">return</span>;<br><span class="hljs-comment">//主要针对jsx生成虚拟DOM</span><br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name === <span class="hljs-string">&#x27;className&#x27;</span>) &#123; <br><span class="hljs-keyword">return</span> $target.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;class&#x27;</span>, value);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isEventProp</span>(name)) &#123;<br><span class="hljs-keyword">return</span> $target.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-title function_">extractEventName</span>(name), value);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&#x27;boolean&#x27;</span>) &#123;<br><span class="hljs-keyword">if</span> (value) &#123;<br>$target.<span class="hljs-title function_">setAttribute</span>(name, value);<br>&#125;<br><span class="hljs-comment">//如果value是false的话真实dom没有必要加上这个属性</span><br>$target[name] = value;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>$target.<span class="hljs-title function_">setAttribute</span>(name, value);<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">toRealDom</span> = (<span class="hljs-params">vNode</span>) =&gt;&#123;<br><span class="hljs-comment">///$dom表示真实DOM</span><br><span class="hljs-keyword">let</span> $dom;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> vNode === <span class="hljs-string">&#x27;string&#x27;</span>) &#123;<br><span class="hljs-comment">//如果vdom的类型是string而不是对象</span><br>$dom = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(vNode);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>$dom = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(vNode.<span class="hljs-property">type</span>);<br>&#125;<br><br><span class="hljs-comment">//处理虚拟DOM上的props</span><br><span class="hljs-keyword">if</span> (vNode.<span class="hljs-property">props</span>) &#123;<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(vNode.<span class="hljs-property">props</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br><span class="hljs-title function_">setProp</span>($dom, key, vNode.<span class="hljs-property">props</span>[key]);<br>&#125;);<br>&#125;<br><br><span class="hljs-comment">//递归处理子节点，这里需要注意 空数组[]返回的是true 因此加上 vNode.children.length</span><br><span class="hljs-keyword">if</span> (vNode.<span class="hljs-property">children</span> &amp;&amp; vNode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>) &#123;<br>vNode.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">childVdom</span> =&gt;</span> &#123;<br><span class="hljs-keyword">const</span> realChildDom = <span class="hljs-title function_">toRealDom</span>(childVdom);<br>$dom.<span class="hljs-title function_">appendChild</span>(realChildDom);<br>&#125;);<br>&#125;<br><br><span class="hljs-keyword">return</span> $dom;<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> toRealDom;<br></code></pre></div></td></tr></table></figure><h2 id="updateDom">updateDom</h2><ul><li><code>updateDom</code>：更新DOM的主函数</li><li><code>isNodeChanged</code>：来判断节点是否改变</li><li><code>isPropsChanged</code>：来判断属性值是否改变</li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> toRealDom <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./convertVdom.js&quot;</span>;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type"></span>&#125;$parent 表示挂载的父节点</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>&#123;<span class="hljs-type"></span>&#125;oldVnode 表示旧的节点</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type"></span>&#125;newNode 表示新的节点</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">number</span>&#125; index 表示当前更新第几子节点，默认为0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">updateDom</span> = (<span class="hljs-params">$parent, oldVNode, newVNode, index</span>) =&gt; &#123;<br>  <span class="hljs-comment">// 当前索引的真实DOM为传入的父节点的</span><br>  <span class="hljs-keyword">const</span> $currentDom = $parent.<span class="hljs-property">childNodes</span>[index];<br>  <span class="hljs-comment">// 先考虑新旧VDOM的类型变化</span><br>  <span class="hljs-comment">// 没有旧的节点，添加新的节点</span><br>  <span class="hljs-keyword">if</span> (!oldVNode) &#123;<br>    <span class="hljs-keyword">return</span> $parent.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title function_">toRealDom</span>(newVNode));<br>  &#125;<br><br>  <span class="hljs-comment">// 没有新的节点，删去旧的RDOM</span><br>  <span class="hljs-keyword">if</span> (!newVNode) &#123;<br>    <span class="hljs-keyword">return</span> $parent.<span class="hljs-title function_">removeChild</span>($currentDom);<br>  &#125;<br><br>  <span class="hljs-comment">// 都是文本节点，都没有发生变化</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> oldVNode === <span class="hljs-string">&quot;string&quot;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> newVNode === <span class="hljs-string">&quot;string&quot;</span> &amp;&amp; oldVNode === newVNode) &#123;<br>      <span class="hljs-keyword">return</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isNodeChanged</span>(oldVNode, newVNode)) &#123;<br>    <span class="hljs-keyword">return</span> $parent.<span class="hljs-title function_">replaceChild</span>(<span class="hljs-title function_">toRealDom</span>(newVNode), $currentDom);<br>  &#125;<br><br>  <span class="hljs-keyword">const</span> oldProps = oldVNode.<span class="hljs-property">props</span> || &#123;&#125;;<br>  <span class="hljs-keyword">const</span> newProps = newVNode.<span class="hljs-property">props</span> || &#123;&#125;;<br><br>  <span class="hljs-comment">// 在考虑新旧节点上props的变化</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isPropsChanged</span>(oldProps, newProps)) &#123;<br>    <span class="hljs-keyword">const</span> oldPropsKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(oldProps);<br>    <span class="hljs-keyword">const</span> newPropsKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(newProps);<br><br>    <span class="hljs-comment">// 如果新节点没有属性，把旧的节点的属性清除掉</span><br>    <span class="hljs-keyword">if</span> (newPropsKeys.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) &#123;<br>      oldPropsKeys.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">propKey</span>) =&gt;</span> &#123;<br>        <span class="hljs-title function_">removeProp</span>($currentDom, propKey, oldProps[propKey]);<br>      &#125;);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">const</span> allPropsKeys = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...oldPropsKeys, ...newPropsKeys]);<br>      allPropsKeys.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">propKey</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (!newProps[propKey]) &#123;<br>          <span class="hljs-keyword">return</span> <span class="hljs-title function_">removeProp</span>($currentDom, propKey, oldProps[propKey]);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (newProps[propKey] !== oldProps[propKey]) &#123;<br>          <span class="hljs-keyword">return</span> <span class="hljs-title function_">setProp</span>($currentDom, propKey, newProps[propKey]);<br>        &#125;<br>      &#125;);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// 递归处理子节点</span><br>  <span class="hljs-keyword">if</span> (<br>    (oldVNode.<span class="hljs-property">children</span> &amp;&amp; oldVNode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>) ||<br>    (newVNode.<span class="hljs-property">children</span> &amp;&amp; newVNode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>)<br>  ) &#123;<br>    <span class="hljs-keyword">for</span> (<br>      <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<br>      i &lt; oldVNode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> || i &lt; newVNode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>;<br>      i++<br>    ) &#123;<br>      <span class="hljs-title function_">updateDom</span>($currentDom, oldVNode.<span class="hljs-property">children</span>[i], newVNode.<span class="hljs-property">children</span>[i], i);<br>    &#125;<br>  &#125;<br>&#125;;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>&#123;<span class="hljs-type"></span>&#125;oldVnode 表示旧的节点</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type"></span>&#125;newNode 表示新的节点</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">bealean</span>&#125; 当前节点是否发生修改</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">isNodeChanged</span> = (<span class="hljs-params">oldVNode, newVNode</span>) =&gt; &#123;<br>  <span class="hljs-comment">//一个是textNode(string)，一个是element(object)</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> oldVNode !== <span class="hljs-keyword">typeof</span> newVNode) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>  &#125;<br><br>  <span class="hljs-comment">//都是textNode(string) 则需比较文本是否发生改变</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> oldVNode === <span class="hljs-string">&quot;string&quot;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> newVNode === <span class="hljs-string">&quot;string&quot;</span>) &#123;<br>    <span class="hljs-keyword">return</span> oldVNode !== newVNode;<br>  &#125;<br><br>  <span class="hljs-comment">//都是element节点，比较节点类型是否发生改变</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> oldVNode === <span class="hljs-string">&quot;object&quot;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> newVNode === <span class="hljs-string">&quot;object&quot;</span>) &#123;<br>    <span class="hljs-keyword">return</span> oldVNode.<span class="hljs-property">type</span> !== newVNode.<span class="hljs-property">type</span>;<br>  &#125;<br>&#125;;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>&#123;<span class="hljs-type"></span>&#125;oldProps 表示旧的props</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type"></span>&#125;newProps 表示新的props</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">bealean</span>&#125; 当前props是否发生修改</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">isPropsChanged</span> = (<span class="hljs-params">oldProps, newProps</span>) =&gt; &#123;<br>  <span class="hljs-comment">// 类型不一致，props肯定发生变化</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> oldProps !== <span class="hljs-keyword">typeof</span> newProps) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>  &#125;<br><br>  <span class="hljs-comment">// props为对象</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> oldProps === <span class="hljs-string">&quot;object&quot;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> newProps === <span class="hljs-string">&quot;object&quot;</span>) &#123;<br>    <span class="hljs-keyword">const</span> oldKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(oldProps);<br>    <span class="hljs-keyword">const</span> newKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(newProps);<br><br>    <span class="hljs-comment">//如果数目不同一定发生变化直接返回true</span><br>    <span class="hljs-keyword">if</span> (oldKeys.<span class="hljs-property">length</span> !== newKeys.<span class="hljs-property">length</span>) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; oldKeys.<span class="hljs-property">length</span>; i++) &#123;<br>      <span class="hljs-keyword">const</span> key = oldKeys[i];<br>      <span class="hljs-comment">// 如果key也发生改变了那就不能做到一一对应，newProps[key] === undefined</span><br>      <span class="hljs-keyword">if</span> (oldProps[key] !== newProps[key]) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;;<br><br><span class="hljs-comment">// removeProp 与 setProp 相对应</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">isCustomProp</span> = (<span class="hljs-params">name</span>) =&gt; &#123;<br>  <span class="hljs-comment">/* 这里需要对prop进行判断 */</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;;<br><span class="hljs-comment">//判断是否有事件回调属性</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">isEventProp</span> = (<span class="hljs-params">name</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-regexp">/^on/</span>.<span class="hljs-title function_">test</span>(name);<br>&#125;;<br><span class="hljs-comment">//去掉on，在JSX中还要转化成小写</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">extractEventName</span> = (<span class="hljs-params">name</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> name.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">toLowerCase</span>();<br>&#125;;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">removeProp</span> = (<span class="hljs-params">$target, name, value</span>) =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isCustomProp</span>(name)) &#123;<br>    <span class="hljs-keyword">return</span>;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name === <span class="hljs-string">&quot;className&quot;</span>) &#123;<br>    <span class="hljs-keyword">return</span> $target.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">&quot;class&quot;</span>);<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isEventProp</span>(name)) &#123;<br>    <span class="hljs-keyword">return</span> $target.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-title function_">extractEventName</span>(name), value);<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&quot;boolean&quot;</span>) &#123;<br>    $target.<span class="hljs-title function_">removeAttribute</span>(name);<br>    $target[name] = <span class="hljs-literal">false</span>;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    $target.<span class="hljs-title function_">removeAttribute</span>(name);<br>  &#125;<br>&#125;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">setProp</span> = (<span class="hljs-params">$target, name, value</span>) =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isCustomProp</span>(name)) &#123;<br>    <span class="hljs-keyword">return</span>;<br>    <span class="hljs-comment">//主要针对jsx生成虚拟DOM</span><br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name === <span class="hljs-string">&quot;className&quot;</span>) &#123;<br>    <span class="hljs-keyword">return</span> $target.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;class&quot;</span>, value);<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isEventProp</span>(name)) &#123;<br>    <span class="hljs-keyword">return</span> $target.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-title function_">extractEventName</span>(name), value);<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&quot;boolean&quot;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (value) &#123;<br>      $target.<span class="hljs-title function_">setAttribute</span>(name, value);<br>    &#125;<br>    <span class="hljs-comment">//如果value是false的话真实dom没有必要加上这个属性</span><br>    $target[name] = value;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    $target.<span class="hljs-title function_">setAttribute</span>(name, value);<br>  &#125;<br>&#125;;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> updateDom;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React</title>
    <link href="/2022/08/02/React/"/>
    <url>/2022/08/02/React/</url>
    
    <content type="html"><![CDATA[<h1>React</h1><h2 id="语法基础">语法基础</h2><h3 id="jsx语法规范">jsx语法规范</h3><ul><li>定义虚拟DOM时，不要写引号。</li><li>标签中混入JS表达式要用<code>&#123;&#125;</code>.</li><li>样式的类名指定不要用<code>class</code>而要用<code>className</code>。</li><li>内联样式。要用<code>style=&#123;&#123;key:value&#125;&#125;</code>的形式去写。</li><li>只有一个根标签。</li><li>标签必须闭合。</li><li>标签首字母<ul><li>若小写字母开头，则将改标签为<code>html</code>中同名的元素。</li><li>若大写字母开头，<code>React</code>将该标签当做是组件。</li></ul></li></ul><h3 id="列表渲染">列表渲染</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> data = [<span class="hljs-string">&#x27;Angular&#x27;</span>,<span class="hljs-string">&#x27;React&#x27;</span>,<span class="hljs-string">&#x27;Vue&#x27;</span>];<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">VDOM</span> = (<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">    &#123;</span><br><span class="language-xml">                data.map((item,index) =&gt;&#123;</span><br><span class="language-xml">    return <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">&#125;)</span><br><span class="language-xml">            &#125;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>)<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="hljs-variable constant_">VDOM</span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));<br></code></pre></div></td></tr></table></figure><h3 id="组件的定义方式">组件的定义方式</h3><h4 id="函数式组件">函数式组件</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>我是函数定义的组件<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span>/&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));<br></code></pre></div></td></tr></table></figure><p>执行<code>ReactDOM.render(&lt;MyComponent/&gt;,document.getElementById('root'))</code>后发生了什么？</p><ul><li><code>React</code>解析组件标签，找到<code>MyComponent</code>组件。</li><li>发现组件是使用函数定义的，随后调用该函数，将返回的虚拟DOM转为真实DOM，随后呈现在页面上。</li></ul><h4 id="类式组件">类式组件</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br><span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>我的用类定义的组件<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br>&#125;<br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span>/&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));<br></code></pre></div></td></tr></table></figure><p>执行<code>ReactDOM.render(&lt;MyComponent/&gt;,document.getElementById('root'))</code>后发生了什么？</p><ul><li><code>React</code>解析组件标签，找到<code>MyComponent</code>组件。</li><li>发现组件是使用类定义的，随后<code>new</code>出来该类的实例，并通过该实例调用到原型上的<code>render</code>方法。</li><li>将<code>render</code>返回的虚拟DOM转为真实DOM，随后呈现在页面上。</li></ul><h4 id="类的知识点补充">类的知识点补充</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br><span class="hljs-title function_">constructor</span>(<span class="hljs-params">name,age</span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>        <span class="hljs-comment">//this.speak = this.speak.bind(this);</span><br>&#125;<br><span class="hljs-title function_">speak</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>p1.<span class="hljs-title function_">speak</span>(); <span class="hljs-comment">//p1</span><br><span class="hljs-keyword">const</span> x = p1.<span class="hljs-property">speak</span>;<br><span class="hljs-title function_">x</span>(); <span class="hljs-comment">//undefined</span><br></code></pre></div></td></tr></table></figure><ul><li><p>类中的方法是开启局部严格模式的。</p></li><li><p>通过类的实例调用原型链上的方法时，this指向的是类的实例。</p></li><li><p>直接调用类的原型链上的方法时，this指向的是undefined，正常情况下应该是window，但是类中的方法是开启局部严格模式的，因此指向的是undefined。</p></li><li><p>如何解决让类中的方法的this始终指向类的实例对象？在构造器中添加如下代码</p><p><code>this.speak = this.speak.bind(this)</code></p><p>直接将原型上的方法加到类的实例对象上去。</p></li></ul><h3 id="组件属性">组件属性</h3><blockquote><p>属性的三大属性是针对于类式组件。（除了props）</p></blockquote><h4 id="state">state</h4><ul><li>状态不可以直接更改，要借助内置的API<code>setState</code>（在原型链的<code>React.Component</code>身上）进行更改。</li><li><code>setState</code>的过程是一种合并，而不是替换。</li></ul><p><strong>标准写法</strong>：</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Weather</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&#123;<br><span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>)&#123;<br><span class="hljs-variable language_">super</span>(props);<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;<span class="hljs-attr">isHot</span>:<span class="hljs-literal">false</span>,<span class="hljs-attr">wind</span>:<span class="hljs-string">&#x27;slight&#x27;</span>&#125;;<br>        <span class="hljs-comment">//如果没有这句，那么在render()执行的时候changeWeather的this是null</span><br>        <span class="hljs-comment">//因为在render()中changeWeather()的调用是直接调用而不是实例调用</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">changeWeather</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">changeWeather</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);<br>&#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">const</span> &#123;isHot,wind&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.changeWeather&#125;</span>&gt;</span>天气&#123;isHot ? &#x27;Hot&#x27; : &#x27;cool&#x27;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;<br>    &#125;<br>    <span class="hljs-title function_">changeWeather</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">const</span> isHot = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">isHot</span>;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;<span class="hljs-attr">isHot</span>:!isHot&#125;);<br>    &#125;<br>&#125;<br>root.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Weather</span>/&gt;</span></span>);<br><span class="hljs-comment">//ReactDom.render(&lt;Weather/&gt;,document.getElementById(&#x27;root&#x27;));</span><br></code></pre></div></td></tr></table></figure><p><strong>精简写法</strong>：</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Weather</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&#123;<br>    <span class="hljs-comment">//Weather的实例对象上添加属性</span><br>state = &#123;<span class="hljs-attr">isHot</span>:<span class="hljs-literal">false</span>,<span class="hljs-attr">wind</span>:<span class="hljs-string">&#x27;slight&#x27;</span>&#125;;<br>    <br><span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">const</span> &#123;isHot,wind&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.changeWeather&#125;</span>&gt;</span>天气&#123;isHot ? &#x27;Hot&#x27; : &#x27;cool&#x27;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;<br>    &#125;;<br>    <br>    <span class="hljs-comment">//在Weather的实例对象上添加方法</span><br>    changeWeather = <span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-comment">//写成箭头函数，让this直接指向Weather的实例对象</span><br>    <span class="hljs-keyword">const</span> isHot = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">isHot</span>;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;<span class="hljs-attr">isHot</span>:!isHot&#125;);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="props">props</h4><h5 id="展开运算符">展开运算符</h5><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr1 = [<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<span class="hljs-number">9</span>];<br><span class="hljs-keyword">let</span> arr2 = [<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>];<br><br><span class="hljs-comment">//展开一个数组</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(...arr1);  <span class="hljs-comment">// 1 3 5 7 9</span><br><span class="hljs-comment">//合并数组</span><br><span class="hljs-keyword">let</span> arr3 = [...arr1,...arr2];<br><br><span class="hljs-comment">//表示参数不确定，将所有传入的参数用一个数组收集起来</span><br><span class="hljs-comment">//配合array.reduce非常好用</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">...numbers</span>)&#123;<br>   <span class="hljs-keyword">return</span> numbers.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">preValue,currentValue</span>) =&gt;</span>&#123;<br>        <span class="hljs-keyword">return</span> preValue + currentValue;<br>    &#125;)<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>)); <span class="hljs-comment">//10</span><br><br><span class="hljs-comment">//展开运算符不能展开一个对象，但可以复制对象</span><br><span class="hljs-keyword">let</span> person = &#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;Tom&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>&#125;;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(...person); <span class="hljs-comment">//报错</span><br><span class="hljs-keyword">let</span> person2 = &#123;...person&#125; <span class="hljs-comment">//相当于深拷贝一个对象</span><br>person.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;Jack&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person2.<span class="hljs-property">name</span>); <span class="hljs-comment">//Tom</span><br><br><span class="hljs-comment">//合并对象时相同key后者的value优先</span><br><span class="hljs-keyword">let</span> person3 = &#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;Tom&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>&#125;;<br><span class="hljs-keyword">let</span> person4 = &#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;Jack&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>&#125;;<br><span class="hljs-keyword">let</span> person5 = &#123;...person3,...person4&#125;;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person5); <span class="hljs-comment">//&#123;name:&#x27;Jack&#x27;,age:18&#125;;</span><br></code></pre></div></td></tr></table></figure><h5 id="props的使用"><code>props</code>的使用</h5><ul><li>在组件标签中直接传入<code>props</code>，然后在<code>render()</code>内取出<code>props</code>放在页面中。</li><li>也可以用展开运算符的方式传入组件标签中。</li></ul><h5 id="对props的限制">对<code>props</code>的限制</h5><p>引入<code>prop-types.js</code>，只用可以添加定义的类的一个属性<code>propTypes</code>，在这个属性（对象）中对<code>props</code>的类型和必要性进行限制。</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&#123;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">const</span> &#123;name,age,sex&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>;<br>        <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;age&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;sex&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-comment">//对标签属性进行类型、必要性的限制</span><br><span class="hljs-title class_">Person</span>.<span class="hljs-property">proTypes</span> = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">string</span>.<span class="hljs-property">isRequired</span>,<br>    <span class="hljs-attr">sex</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">string</span>,<br>    <span class="hljs-attr">age</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">number</span>,<br>    <span class="hljs-comment">//func需要特别记住</span><br>    <span class="hljs-attr">speak</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">func</span>,<br>&#125;<br><span class="hljs-comment">//指定默认标签属性值</span><br><span class="hljs-title class_">Person</span>.<span class="hljs-property">defaultProps</span> = &#123;<br>    <span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;questioned&#x27;</span>,<br>    <span class="hljs-attr">age</span>:<span class="hljs-number">18</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="props的简写方式"><code>props</code>的简写方式</h5><p>直接使用类的<code>static</code>属性，在类本身上添加属性或方法。</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&#123;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">const</span> &#123;name,age,sex&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>;<br>        <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;age&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;sex&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br>        )<br>    &#125;<br>    <span class="hljs-comment">//对标签属性进行类型、必要性的限制</span><br><span class="hljs-keyword">static</span> propTypes = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">string</span>.<span class="hljs-property">isRequired</span>,<br>    <span class="hljs-attr">sex</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">string</span>,<br>    <span class="hljs-attr">age</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">number</span>,<br>    <span class="hljs-comment">//func需要特别记住</span><br>    <span class="hljs-attr">speak</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">func</span>,<br>&#125;<br><span class="hljs-comment">//指定默认标签属性值</span><br><span class="hljs-keyword">static</span> defaultProps = &#123;<br>    <span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;questioned&#x27;</span>,<br>    <span class="hljs-attr">age</span>:<span class="hljs-number">18</span><br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="类式组件构造器中的props">类式组件构造器中的<code>props</code></h5><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&#123;<br><span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>)&#123;<br><span class="hljs-variable language_">super</span>(props);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>);  <span class="hljs-comment">//实例上的props能正常输出</span><br>&#125;<br><span class="hljs-comment">//如果写构造器的话需要 传props和写super(props)</span><br>    <span class="hljs-comment">//但事实上类中的构造器能省略就省略</span><br><span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">super</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>);  <span class="hljs-comment">//实例上的props不能正常输出</span><br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="函数组件使用props">函数组件使用<code>props</code></h5><p>类式组件的三大属性中只有<code>props</code>是可以在函数组件中使用的。</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">props</span>)&#123;<br><span class="hljs-keyword">const</span> &#123;name,age,sex&#125; = props;<br><span class="hljs-keyword">return</span> &#123;<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;age&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>&#123;sex&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br>&#125;<br>&#125;<br><span class="hljs-comment">//函数式组件只能写在外面</span><br><span class="hljs-title class_">Person</span>.<span class="hljs-property">propTypes</span> = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">string</span>.<span class="hljs-property">isRequired</span>,<br>    <span class="hljs-attr">sex</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">string</span>,<br>    <span class="hljs-attr">age</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">number</span>,<br>    <span class="hljs-comment">//func需要特别记住</span><br>    <span class="hljs-attr">speak</span>:<span class="hljs-title class_">PropTypes</span>.<span class="hljs-property">func</span>,<br>&#125;<br><span class="hljs-comment">//指定默认标签属性值</span><br><span class="hljs-title class_">Person</span>.<span class="hljs-property">defaultProps</span> = &#123;<br>    <span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;questioned&#x27;</span>,<br>    <span class="hljs-attr">age</span>:<span class="hljs-number">18</span><br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Person</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;jerry&quot;</span> <span class="hljs-attr">sex</span>=<span class="hljs-string">&quot;female&quot;</span> <span class="hljs-attr">age</span>=<span class="hljs-string">&#123;18&#125;/</span>&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));<br></code></pre></div></td></tr></table></figure><h4 id="refs">refs</h4><blockquote><p>跟Vue中的ref蛮像的</p></blockquote><h5 id="回调函数形式的ref">回调函数形式的<code>ref</code></h5><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&#123;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span>(<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">          &#123; /*<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;currentNode</span> =&gt;</span> this.input = currentNode&#125; type=&quot;text&quot;/&gt;*/&#125;</span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;this.saveInput&#125;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span>/&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.showInfo&#125;</span>&gt;</span>点我<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>    showInfo = <span class="hljs-function">() =&gt;</span>&#123;<br>        <span class="hljs-keyword">const</span> &#123;input&#125; = <span class="hljs-variable language_">this</span>;<br>        <span class="hljs-title function_">alert</span>(input.<span class="hljs-property">value</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>Q：在使用内联回调<code>ref</code>时会被调用了几次？</p><p>A：如果 <code>ref</code> 回调函数是以内联函数的方式定义的，在<strong>更新过程</strong>中它会被执行两次，第一次传入参数 <code>null</code>，然后第二次会传入参数 DOM 元素。这是因为在每次渲染时会创建一个新的函数实例，所以 React 清空旧的 ref 并且设置新的。通过将 ref 的回调函数定义成 <strong>class 的绑定函数</strong>的方式可以避免上述问题，<strong>但是大多数情况下它是无关紧要的。</strong>（在上述代码中jsx的注释中为ref的内联回调函数写法，然后可以写成class的绑定函数，当页面更新的时候就不会再执行了）</p><h5 id="createRef-的使用"><code>createRef()</code>的使用</h5><blockquote><p>React最为推荐的ref的使用方式</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&#123;<br>    <span class="hljs-comment">//React.createRef()调用后可以返回一个容器，该容器可以存储被ref所标识的节点</span><br>    <span class="hljs-comment">//当input的这个节点用ref标识的时候，就被储存进myRef这个容器中</span><br>    <span class="hljs-comment">//该容器是只能储存一个节点的，且当第二次调用的时候会覆盖前一个节点</span><br>    myRef = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createRef</span>();<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span>(<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;this.myRef&#125;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span>/&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;this.showInfo&#125;</span>&gt;</span>点我<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>    &#125;<br>    showInfo = <span class="hljs-function">() =&gt;</span>&#123;<br>        <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">this</span>.<span class="hljs-property">myRef</span>.<span class="hljs-property">current</span>;<br>        <span class="hljs-title function_">alert</span>(input.<span class="hljs-property">value</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="事件处理">事件处理</h3><ul><li>通过<code>onXxx</code>属性指定事件处理函数（注意大小写）。<ul><li>React使用的是自定义（合成）事件，而不是使用原生的DOM事件。</li><li>React中的事件是通过事件委托方式处理的（委托给组件最外层的元素）——为了更高的效率。</li></ul></li><li>通过<code>event.target</code>得到发生事件的DOM元素。（当发生事件的元素和处理事件的元素是同一个的时候就可以避免使用<code>ref</code>）</li></ul><h3 id="收集表单数据">收集表单数据</h3><blockquote><p>相当于vue中的 v-bind和v-model 的区别</p></blockquote><h4 id="非受控组件">非受控组件</h4><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Login</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>        event.<span class="hljs-title function_">preventDefault</span>();  <span class="hljs-comment">//阻止表单提交</span><br>        <span class="hljs-keyword">const</span> &#123;username,password&#125; = <span class="hljs-variable language_">this</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(username.<span class="hljs-property">value</span>,password.<span class="hljs-property">value</span>);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">&#123;this.handleSubmit&#125;</span>&gt;</span></span><br><span class="language-xml">            用户名:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;c</span> =&gt;</span> this.username = c&#125; type=&quot;text&quot;/&gt;</span><br><span class="language-xml">                密码:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;c</span> =&gt;</span> this.password = c&#125; type=&quot;password&quot;/&gt;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Login</span>/&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));<br></code></pre></div></td></tr></table></figure><h4 id="受控组件">受控组件</h4><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Login</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    state = &#123;<br>        <span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">password</span>:<span class="hljs-string">&#x27;&#x27;</span><br>    &#125;<br>    <br>    saveUsername = <span class="hljs-function">(<span class="hljs-params">event</span>)=&gt;</span>&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;<span class="hljs-attr">username</span>:event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>&#125;);<br>    &#125;<br>    <br>    savePassword = <span class="hljs-function">(<span class="hljs-params">event</span>)=&gt;</span>&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;<span class="hljs-attr">password</span>:event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>&#125;);<br>    &#125;<br>    <br>    handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>        event.<span class="hljs-title function_">preventDefault</span>();  <span class="hljs-comment">//阻止表单提交</span><br>        <span class="hljs-keyword">const</span> &#123;username,password&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(username,password);<br>    &#125;<br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">&#123;this.handleSubmit&#125;</span>&gt;</span></span><br><span class="language-xml">            用户名:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;this.saveUsername&#125;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span>/&gt;</span></span><br><span class="language-xml">                密码:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;this.savePassword&#125;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span>/&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Login</span>/&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));<br></code></pre></div></td></tr></table></figure><p><strong>代码优化</strong></p><blockquote><p>关于事件回调的说明：</p><p>1.在事件回调中如果传入参数写成<code>onChange=&#123;this.saveFormData(username)&#125;</code>的形式的话，会返回这个函数执行完的返回值作为事件回调。</p><p>2.<code>onChange=&#123;this.saveFormData&#125;</code>则是将整个函数作为事件回调。</p><p>高阶函数：</p><p>如果一个函数接受的参数为函数或者调用的返回值为函数，那么这个函数可以被称为高阶函数。</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Login</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    state = &#123;<br>        <span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">password</span>:<span class="hljs-string">&#x27;&#x27;</span><br>    &#125;<br>    <br>    <span class="hljs-title function_">saveFormData</span>(<span class="hljs-params">dataType</span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>            <span class="hljs-comment">//这里在对象中使用变量dataType需要用中括号</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;[dataType]:event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>&#125;);<br>        &#125;<br>    &#125;<br>    <br>    handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>        event.<span class="hljs-title function_">preventDefault</span>();  <span class="hljs-comment">//阻止表单提交</span><br>        <span class="hljs-keyword">const</span> &#123;username,password&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(username,password);<br>    &#125;<br>    <br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">&#123;this.handleSubmit&#125;</span>&gt;</span></span><br><span class="language-xml">            用户名:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;this.saveFormData(</span>&#x27;<span class="hljs-attr">username</span>&#x27;)&#125; <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span>/&gt;</span></span><br><span class="language-xml">                密码:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;this.saveFormData(</span>&#x27;<span class="hljs-attr">password</span>&#x27;)&#125; <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span>/&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Login</span>/&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));<br></code></pre></div></td></tr></table></figure><p><strong>不使用柯里化的写法</strong></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Login</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>    state = &#123;<br>        <span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">password</span>:<span class="hljs-string">&#x27;&#x27;</span><br>    &#125;<br>    <br>    <span class="hljs-title function_">saveFormData</span>(<span class="hljs-params">dataType,event</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;[dataType]:event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>&#125;);<br>    &#125;<br>    <br>    handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>        event.<span class="hljs-title function_">preventDefault</span>();  <span class="hljs-comment">//阻止表单提交</span><br>        <span class="hljs-keyword">const</span> &#123;username,password&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(username,password);<br>    &#125;<br>    <br>    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">&#123;this.handleSubmit&#125;</span>&gt;</span></span><br><span class="language-xml">            用户名:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">event</span> =&gt;</span> this.saveFormData(&#x27;username&#x27;,event)&#125; type=&quot;text&quot;/&gt;</span><br><span class="language-xml">                密码:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">event</span> =&gt;</span> this.saveFormData(&#x27;password&#x27;,event)&#125; type=&quot;password&quot;/&gt;</span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br>        )<br>    &#125;<br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Login</span>/&gt;</span></span>,<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>));<br></code></pre></div></td></tr></table></figure><h3 id="生命周期（旧）">生命周期（旧）</h3><p><img src="React-lifecycle-old.jpg" alt="React-lifecycle-old"></p><ul><li>初始化阶段：由<code>ReactDOM.render()</code>触发<ul><li><code>constructor()</code></li><li><code>componentWillMount()</code></li><li><code>render()</code></li><li><code>componentDidMount()</code>（初始化，如开启定时器、发送网络请求、订阅消息）</li></ul></li><li>更新阶段：由组件内部<code>this.setState()</code>或父组件重新<code>render</code>时触发<ul><li><code>shouldComponentUpdate()</code>，需要返回<code>true</code>或<code>false</code></li><li><code>componentWillUpdate()</code></li><li><code>render()</code></li><li><code>componentDidUpdate()</code></li></ul></li><li>卸载组件：由<code>React.unmountComponentAtNode()</code>触发<ul><li><code>componentWillUnmount()</code>（收尾工作，关闭定时器、取消订阅消息）</li></ul></li></ul><h3 id="生命周期（新）">生命周期（新）</h3><p><strong>删去</strong></p><ul><li><code>componentWillUpdate()</code></li><li><code>componentWillMount()</code></li><li><code>componentWillReceiveProps()</code></li></ul><p><strong>新增</strong></p><ul><li><code>getSnapshotBeforeUpdate()</code></li><li><code>static getDerivedStateFromProps()</code></li></ul><h3 id="React中proxy">React中proxy</h3><ul><li><p><code>package.json</code>中可以直接配置一个代理。</p></li><li><p><code>src</code>中新建<code>setupProxy.js</code></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Koa2</title>
    <link href="/2022/07/22/Koa2/"/>
    <url>/2022/07/22/Koa2/</url>
    
    <content type="html"><![CDATA[<h1>Koa2</h1><h2 id="什么是koa框架？">什么是koa框架？</h2><p>koa是一个基于node实现的一个新的web框架，它是由express框架的原班人马打造的。它的特点是优雅、简洁、表达力强、自由度高。它更express相比，它是一个更轻量的node框架，因为它所有功能都通过插件实现，这种插拔式的架构设计模式，很符合unix哲学。</p><h2 id="koa源码结构">koa源码结构</h2><p><img src="koa-lib.png" alt="koa源码目录"></p><p><code>lib</code>文件夹下放着四个<code>koa2</code>的核心文件：<code>application.js</code>、<code>context.js</code>、<code>request.js</code>、<code>response.js</code>。</p><h3 id="application-js">application.js</h3><p><code>application.js</code>是koa的入口文件，它向外导出了创建<code>class</code>实例的构造函数，它继承了<code>events</code>，这样就会赋予框架事件监听和事件触发的能力。<code>application</code>还暴露了一些常用的<code>api</code>，比如t<code>oJSON</code>、<code>listen</code>、<code>use</code>等等。</p><p><code>listen</code>的实现原理其实就是对<code>http.createServer</code>进行了一个封装，重点是这个函数中传入的<code>callback</code>，它里面包含了中间件的合并，上下文的处理，对<code>res</code>的特殊处理。</p><p><code>use</code>是收集中间件，将多个中间件放入一个缓存队列中，然后通过<code>koa-compose</code>这个插件进行递归组合调用这一些列的中间件。</p><h3 id="context-js">context.js</h3><p>这部分就是koa的应用上下文<code>ctx</code>,其实就一个简单的对象暴露，里面的重点在<code>delegate</code>，这个就是代理，这个就是为了开发者方便而设计的，比如我们要访问<code>ctx.repsponse.status</code>但是我们通过<code>delegate</code>，可以直接访问<code>ctx.status</code>访问到它。</p><h3 id="request-js、response-js">request.js、response.js</h3><p>这两部分就是对原生的<code>res</code>、<code>req</code>的一些操作了，大量使用<code>es6</code>的<code>get</code>和<code>set</code>的一些语法，去取<code>headers</code>或者设置<code>headers</code>、还有设置<code>body</code>等等，这些就不详细介绍了，有兴趣的读者可以自行看源码。</p><h2 id="实现koa2的四大模块">实现koa2的四大模块</h2><p>实现一个<code>koa2</code>的框架需要实现四个大模块，分别是：</p><ul><li>封装<code>node http server</code>、创建<code>Koa</code>类构造函数</li><li>构造<code>request</code>、<code>response</code>、<code>context</code>对象</li><li>中间件机制和洋葱模型的实现</li><li>错误捕获和错误处理</li></ul><h2 id="koa洋葱圈模型">koa洋葱圈模型</h2><p><img src="koa%E6%B4%8B%E8%91%B1%E5%9C%88%E6%A8%A1%E5%9E%8B.png" alt="koa洋葱圈模型"></p><h3 id="什么是中间件？">什么是中间件？</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 注册接口</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/register&#x27;</span>, userValidator, verifyUser, cryptPassword, register)<br></code></pre></div></td></tr></table></figure><p>以注册接口为例,路由一次经过了</p><ul><li><code>userValidator</code>判断用户密码输入是否有效。</li><li><code>verifyUser</code> 查询用户是否已经注册(需要查询数据库)。</li><li><code>cryptPassword</code>通过<code>bcryptjs</code>插件进行密码加盐加密。</li><li><code>register</code>存储信息到数据库返回信息。</li></ul><h3 id="为什么要使用中间件？">为什么要使用中间件？</h3><ul><li>中间件让代码的思路变得更加清晰，每一步干什么，通过中间件的语义化能够很好的增加<strong>代码可读性</strong></li><li>提高代码的复用性，举个例子，我们在注册和登录的时候都需要对用户输入有效性进行判断，于是就可以直接用两次<code>userValidator</code>。</li></ul><h3 id="async-await-语法">async await 语法</h3><ul><li><code>async</code>：声明异步函数。</li><li><code>await</code>：后面跟一个<code>promise</code>对象。</li><li>如果要使用<code>await</code>就需要在函数声明前加上<code>async</code>。</li></ul><h3 id="源码分析">源码分析</h3><h4 id="Listen函数">Listen函数</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">listen (...args) &#123;<br>  <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;listen&#x27;</span>)<br>  <span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">callback</span>())<br>  <span class="hljs-keyword">return</span> server.<span class="hljs-title function_">listen</span>(...args)<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="callback函数">callback函数</h4><p><code>return</code>的是<code>this.handleRequest(ctx,fn)</code></p><ul><li><code>createContext</code>如何生成<code>ctx</code>？</li><li><code>handleRequest</code>如何运行的？</li><li>关键点，<code>middleware</code>是什么？<code>compose</code>对它进行了怎样的封装？</li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">callback () &#123;<br>  <span class="hljs-keyword">const</span> fn = <span class="hljs-title function_">compose</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">middleware</span>)<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">listenerCount</span>(<span class="hljs-string">&#x27;error&#x27;</span>)) <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onerror</span>)<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleRequest</span> = (<span class="hljs-params">req, res</span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> ctx = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createContext</span>(req, res)<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRequest</span>(ctx, fn)<br>  &#125;<br>  <span class="hljs-keyword">return</span> handleRequest<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="use函数">use函数</h4><p><code>use</code>函数关键的一步就是将<code>fn</code>放入<code>middleware</code>数组中。 所以<code>app.use</code>并不是马上执行，而是将函数先放入数组中。这也就是为什么<code>use</code>里面的中间件必须是函数，我们在<code>app/index.js</code>中注册使用路由的时候会调用<code>.routes()</code>方法，<code>app.use(userRouter.routes())</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">this</span>.<span class="hljs-property">middleware</span> = []<br>use (fn) &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fn !== <span class="hljs-string">&#x27;function&#x27;</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;middleware must be a function!&#x27;</span>)<br>  <span class="hljs-title function_">debug</span>(<span class="hljs-string">&#x27;use %s&#x27;</span>, fn.<span class="hljs-property">_name</span> || fn.<span class="hljs-property">name</span> || <span class="hljs-string">&#x27;-&#x27;</span>)<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">middleware</span>.<span class="hljs-title function_">push</span>(fn)<br>  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="compose函数">compose函数</h4><blockquote><p>打开<code>node_modules</code>我们会发现，在<code>npm i koa</code>的时候，装上了<code>koa-compose</code>这个插件</p></blockquote><ol><li><p>判断<code>middleware</code>是否是一个数组(存放中间件函数)</p></li><li><p>判断数组中每个元素是否是一个函数</p></li><li><p>简单来说<code>compose</code>就是一个递归调用中间件的过程</p></li></ol><ul><li><code>index=-1</code>  这里很巧妙，用了一个闭包的技巧，执行函数后，<code>index=i</code>，所以<code>index&gt;=i</code>时<code>reject</code>(说明多次调用了！)</li><li>不断取<code>fn=middle[i]</code>，如果<code>fn</code>不为空就执行</li><li>递归调用下一层<ul><li><code> dispatch.bind(null, i + 1))</code>一定要用<code>bind(null)</code>吗？这里不是单纯的递归调用，而是传入一个函数，所以必须用到<code>bind</code>（<code>call/apply</code> 改变了函数的 <code>this</code> 上下文后马上执行该函数；<code>bind</code> 则是返回改变了上下文后的函数，不执行该函数 。）</li><li>将<code>下一个中间件</code>作为<code>next</code>参数传递下去了(这就是为什么<code>await next()</code>能够形成洋葱圈模型了)</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">compose</span> (middleware) &#123;<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(middleware)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Middleware stack must be an array!&#x27;</span>)<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> fn <span class="hljs-keyword">of</span> middleware) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fn !== <span class="hljs-string">&#x27;function&#x27;</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&#x27;Middleware must be composed of functions!&#x27;</span>)<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Object</span>&#125; <span class="hljs-variable">context</span></span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">Promise</span>&#125;</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@api</span> <span class="hljs-variable">public</span></span><br><span class="hljs-comment">   */</span><br><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">context, next</span>) &#123;<br>    <span class="hljs-comment">// last called middleware #</span><br>    <span class="hljs-keyword">let</span> index = -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">dispatch</span>(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">dispatch</span> (i) &#123;<br>      <span class="hljs-comment">//这里闭包了，i&lt;=index不会在一开始就执行，然后让index = i</span><br>      <span class="hljs-comment">//禁止在一个函数中重复调用next():当next()重复调用，i就会小于index，就会抛出错误</span><br>      <span class="hljs-keyword">if</span> (i &lt;= index) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;next() called multiple times&#x27;</span>))<br>      index = i<br>      <span class="hljs-keyword">let</span> fn = middleware[i]<br>      <span class="hljs-keyword">if</span> (i === middleware.<span class="hljs-property">length</span>) fn = next<br>      <span class="hljs-comment">//如果middleware[]中没元素了就直接返回Promise.resolve()</span><br>      <span class="hljs-keyword">if</span> (!fn) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();<br>      <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">//在构造函数中，因此这里不需要指定this就传入null</span><br>        <span class="hljs-comment">//Promise.resolve(value)方法返回一个以给定值解析后的 Promise 对象。如果这个值是一个 promise ，那么将返回这个 promise ；如果这个值是 thenable（即带有&quot;then&quot; 方法），返回的 promise 会“跟随”这个 thenable 的对象，采用它的最终状态；否则返回的 promise 将以此值完成。</span><br>        <span class="hljs-comment">//而我们在定义中间件的时候都是会用async定义函数，即返回promise对象</span><br>        <span class="hljs-comment">//在第一个中间件内部遇到 next 函数，其实就是调用传入的fn函数的第二个参数即 dispatch 函数，只不过此时参数 i 的值为 1。next() === dispatch.bind(null,i+1);</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">fn</span>(context, dispatch.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, i + <span class="hljs-number">1</span>)))<br>      &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(err)<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>单独处理一个问题：</p><p>Q：为什么<code>return</code>的是一个<code>Promise</code>的对象（<code>Promise.resolve</code>也是一个<code>promise</code>对象）？</p><p>A：因为我们<code>await next()</code>的时候，<code>await</code>是等待且执行一个<code>async</code>函数的完成，<code>async</code>会默认返回一个<code>promise</code>对象，所以这里<code>return</code>的是一个<code>promise</code>对象。我们在每个中间里面<code>await mext()</code>指的就是下一个中间件</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>( <span class="hljs-comment">// 第一个中间件</span><br>  <span class="hljs-keyword">function</span>(<span class="hljs-params">context,next</span>)&#123;  <span class="hljs-comment">// 这里的next第二个中间件也就是dispatch(1)</span><br>     <span class="hljs-comment">// await next上的代码 （中间件1）</span><br>    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>( <span class="hljs-comment">// 第二个中间件</span><br>      <span class="hljs-keyword">function</span>(<span class="hljs-params">context,next</span>)&#123;  <span class="hljs-comment">// 这里的next第二个中间件也就是dispatch(2)</span><br>          <span class="hljs-comment">// await next上的代码 （中间件2）</span><br>        <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>( <span class="hljs-comment">// 第三个中间件</span><br>          <span class="hljs-keyword">function</span>(<span class="hljs-params">context,next</span>)&#123;  <span class="hljs-comment">// 这里的next第二个中间件也就是dispatch(3)</span><br>             <span class="hljs-comment">// await next上的代码 （中间件3）</span><br>            <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>()<br>            <span class="hljs-comment">// await next下的代码 （中间件3）</span><br>          &#125;<br>        )<br>          <span class="hljs-comment">// await next下的代码 （中间件2）</span><br>      &#125;<br>    )<br>      <span class="hljs-comment">// await next下的代码 （中间件1）</span><br>  &#125;<br>) <br></code></pre></div></td></tr></table></figure><h3 id="洋葱模型的流程总结">洋葱模型的流程总结</h3><p>通过<code>use</code>传进来的中间件是一个回调函数，回调函数的参数是<code>ctx</code>上下文和<code>next</code>，<code>next</code>其实就是控制权的交接棒，<code>next</code>的作用是停止运行当前中间件，将控制权交给下一个中间件，执行下一个中间件的<code>next()</code>之前的代码，当下一个中间件运行的代码遇到了<code>next()</code>，又会将代码执行权交给下下个中间件，当执行到最后一个中间件的时候，控制权发生反转，开始回头去执行之前所有中间件中剩下未执行的代码，这整个流程有点像一个伪递归，当最终所有中间件全部执行完后，会返回一个<code>Promise</code>对象，因为我们的<code>compose</code>函数返回的是一个<code>async</code>的函数，<code>async</code>函数执行完后会返回一个<code>Promise</code>，这样我们就能将所有的中间件异步执行同步化，通过<code>then</code>就可以执行响应函数和错误处理函数。</p>]]></content>
    
    
    <categories>
      
      <category>Node.js</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NodeJS</title>
    <link href="/2022/07/18/NodeJS/"/>
    <url>/2022/07/18/NodeJS/</url>
    
    <content type="html"><![CDATA[<h1>NodeJS</h1><h2 id="art-template">art-template</h2><h3 id="使用说明">使用说明</h3><ol><li>在<code>zsh</code>中使用<code>npm install art-template</code>命令进行下载。</li><li>使用<code>const template = require('art-template')</code>引入模板引擎。</li><li>告诉模板引擎要拼接的数据和模板在哪 <code>const html = template('模板路径'，数据);</code></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//导入模板引擎模块</span><br><span class="hljs-keyword">const</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;art-template&#x27;</span>);<br><span class="hljs-comment">//将特定的模板与特定数据进行拼接</span><br><span class="hljs-keyword">const</span> html = <span class="hljs-title function_">template</span>(<span class="hljs-string">&#x27;./views/index.art&#x27;</span>,&#123;<br><span class="hljs-attr">data</span>:&#123;<br><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;张三&#x27;</span>,<br><span class="hljs-attr">age</span>:<span class="hljs-number">20</span>,<br>&#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="标准语法与原始语法">标准语法与原始语法</h3><ul><li><p>标准语法：<code>&#123;&#123;  &#125;&#125;</code></p></li><li><p>原始语法：<code>&lt;%=  %&gt;</code></p></li></ul><h3 id="原文输出">原文输出</h3><blockquote><p>如果数据中携带HTML标签，默认情况下模板引擎为了安全考虑不会去解析标签，会将其转义后输出。</p></blockquote><p>解决办法：</p><ul><li>标准语法：<code>&#123;&#123; @数据 &#125;&#125;</code></li><li>原始语法：<code>&lt;%- 数据  %&gt;</code></li></ul><h3 id="条件判断">条件判断</h3><figure class="highlight handlebars"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml">//模板文件中</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name"><span class="hljs-built_in">if</span></span> age &gt; <span class="hljs-number">18</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">A</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;&#123;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> age &lt; 15&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">B</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;&#123;<span class="hljs-keyword">else</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">C</span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;&#123;/<span class="hljs-name"><span class="hljs-built_in">if</span></span>&#125;&#125;</span><br></code></pre></div></td></tr></table></figure><h3 id="循环">循环</h3><figure class="highlight handlebars"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">//循环data中的users数组</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name"><span class="hljs-built_in">each</span></span> users&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">//使用$value代表数组元素</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">$value.name</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">$value.age</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml"></span><span class="hljs-template-tag">&#123;&#123;/<span class="hljs-name"><span class="hljs-built_in">each</span></span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure><h3 id="子模板">子模板</h3><blockquote><p>使用子模板可以将网站公共区块 （头部、底部）抽离到单独的文件中</p></blockquote><figure class="highlight handlebars"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">include</span> <span class="hljs-string">&#x27;./header.art&#x27;</span>&#125;&#125;</span><br></code></pre></div></td></tr></table></figure><h3 id="模板继承">模板继承</h3><blockquote><p>使用模板继承可以将网站的HTML骨架抽离到单独的文件中，其他页面模板可以继承骨架文件。</p></blockquote><h2 id="HTTP模块">HTTP模块</h2><h3 id="web服务器">web服务器</h3><p>Q：什么是Web服务器？</p><p>A：当应用程序（客户端）需要某一个资源时，可以向一台服务器，通过HTTP请求获取到这个资源；提供资源的这个服务器就是一个web服务器</p><h3 id="创建服务器的方式">创建服务器的方式</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>);<br><br><span class="hljs-comment">//第一种创建方式</span><br><span class="hljs-keyword">const</span> server1 = http.<span class="hljs-title function_">createServer</span>();<br>server1.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>,<span class="hljs-function">()=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;监听端口3000&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">//第二种创建方式</span><br><span class="hljs-keyword">const</span> server2 = <span class="hljs-keyword">new</span> http.<span class="hljs-title class_">Server</span>();<br>server2.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>,<span class="hljs-function">()=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;监听端口3000&#x27;</span>)<br>&#125;)<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Node.js</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sass</title>
    <link href="/2022/07/18/sass/"/>
    <url>/2022/07/18/sass/</url>
    
    <content type="html"><![CDATA[<h1>SASS</h1>]]></content>
    
    
    <categories>
      
      <category>CSS和HTML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mongodb</title>
    <link href="/2022/07/15/mongodb/"/>
    <url>/2022/07/15/mongodb/</url>
    
    <content type="html"><![CDATA[<h1>mongodb</h1><h2 id="数据库基本命令">数据库基本命令</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">db     <span class="hljs-comment">//查询当前数据库</span><br>show dbs<span class="hljs-comment">//查询所有的数据库</span><br>usexxx<span class="hljs-comment">//创建或者切换数据库</span><br>db.<span class="hljs-title function_">stats</span>()<span class="hljs-comment">//查看当前数据库的状态</span><br>db.<span class="hljs-title function_">version</span>()<span class="hljs-comment">//查看当前数据库的版本</span><br>db.<span class="hljs-title function_">getMongo</span>()<span class="hljs-comment">//查看当前DB的链接机器地址</span><br>db.<span class="hljs-title function_">dropDatabase</span>()<span class="hljs-comment">//删除数据库</span><br></code></pre></div></td></tr></table></figure><h2 id="Collection集合操作">Collection集合操作</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">db.<span class="hljs-title function_">createCollection</span>(<span class="hljs-string">&#x27;xxx&#x27;</span>) <span class="hljs-comment">//创建一个集合</span><br>db.<span class="hljs-property">collectionName</span>.<span class="hljs-title function_">isCapped</span>()<span class="hljs-comment">//判断集合是否为定容量</span><br>db.<span class="hljs-title function_">getCollection</span>(<span class="hljs-string">&#x27;xxx&#x27;</span>)<span class="hljs-comment">//得到指定名称的集合</span><br>db.<span class="hljs-title function_">getCollectionNames</span>()<span class="hljs-comment">//得到当前db的所有集合</span><br>db.<span class="hljs-title function_">printCollectionStats</span>()<span class="hljs-comment">//显示当前db所有集合的状态</span><br>db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">drop</span>()<span class="hljs-comment">//删除指定集合</span><br></code></pre></div></td></tr></table></figure><h2 id="增删改查集合数据">增删改查集合数据</h2><h3 id="插入数据">插入数据</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//支持一次性插入多条</span><br>db.<span class="hljs-property">EasonChan</span>.<span class="hljs-title function_">insert</span>([&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;Eason-Chan&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">47</span>&#125;])<br>db.<span class="hljs-property">EasonChan</span>.<span class="hljs-title function_">insert</span>([&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;m1&#x27;</span>,<span class="hljs-attr">release</span>:<span class="hljs-string">&#x27;2010-10-12&#x27;</span>&#125;,&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;m2&#x27;</span>,<span class="hljs-attr">release</span>:<span class="hljs-string">&#x27;2010-10-13&#x27;</span>&#125;])<br><span class="hljs-comment">//save方法同insert，若只有一条数据也可以不写[]</span><br>db.<span class="hljs-property">EasonChan</span>.<span class="hljs-title function_">save</span>([&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;Eason-Chan&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">47</span>&#125;])<br></code></pre></div></td></tr></table></figure><h3 id="查询数据">查询数据</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//查询所有数据</span><br>db.<span class="hljs-property">EasonChan</span>.<span class="hljs-title function_">find</span>()<br><br><span class="hljs-comment">//查询所有key为name的value，筛去重复的。</span><br>db.<span class="hljs-property">EasonChan</span>.<span class="hljs-title function_">distinct</span>(<span class="hljs-string">&#x27;name&#x27;</span>)<br><br><span class="hljs-comment">//查询前5条数据</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">limit</span>(<span class="hljs-number">5</span>)<br><span class="hljs-comment">//先跳过3条再查询前5条数据</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">limit</span>(<span class="hljs-number">5</span>).<span class="hljs-title function_">skip</span>(<span class="hljs-number">3</span>)<br></code></pre></div></td></tr></table></figure><h4 id="条件查询">条件查询</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//查询age=22的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-number">22</span>&#125;)<br><span class="hljs-comment">//查询age&gt;22的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-string">&quot;age&quot;</span>:&#123;<span class="hljs-attr">$gt</span>:<span class="hljs-number">22</span>&#125;&#125;)<br><span class="hljs-comment">//查询age&lt;22的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-string">&quot;age&quot;</span>:&#123;<span class="hljs-attr">$lt</span>:<span class="hljs-number">22</span>&#125;&#125;)<br><span class="hljs-comment">//查询age&gt;=25的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-string">&quot;age&quot;</span>:&#123;<span class="hljs-attr">$gte</span>:<span class="hljs-number">25</span>&#125;&#125;)<br><span class="hljs-comment">//查询age&lt;=25的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-string">&quot;age&quot;</span>:&#123;<span class="hljs-attr">$lte</span>:<span class="hljs-number">25</span>&#125;&#125;)<br><span class="hljs-comment">//查询age&gt;=23并且age&lt;=26的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-string">&quot;age&quot;</span>:&#123;<span class="hljs-attr">$gte</span>:<span class="hljs-number">23</span>,<span class="hljs-attr">$lte</span>:<span class="hljs-number">26</span>&#125;&#125;)<br><span class="hljs-comment">//查询name中包含mongo的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-regexp">/mongo/</span>&#125;)<br><span class="hljs-comment">//查询name中以mongo开头的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-regexp">/^mongo/</span>&#125;)<br><span class="hljs-comment">//查询年龄为22或者年龄为25的记录</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(<span class="hljs-attr">$or</span>:[&#123;<span class="hljs-attr">age</span>:<span class="hljs-number">22</span>&#125;,&#123;<span class="hljs-attr">age</span>:<span class="hljs-number">25</span>&#125;])<br><span class="hljs-comment">//查询第一条数据</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">findOne</span>()<br><span class="hljs-comment">//查询某个结果集的记录条数</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>(&#123;<span class="hljs-attr">age</span>:&#123;<span class="hljs-attr">$gte</span>:<span class="hljs-number">25</span>&#125;&#125;).<span class="hljs-title function_">count</span>()<br></code></pre></div></td></tr></table></figure><h4 id="查找并排序">查找并排序</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//按照年龄排序，1为升序，-1位降序</span><br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">sort</span>(&#123;<span class="hljs-attr">age</span>:<span class="hljs-number">1</span>&#125;)<br>db.<span class="hljs-property">userinfo</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">sort</span>(&#123;<span class="hljs-attr">age</span>:-<span class="hljs-number">1</span>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="修改数据">修改数据</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//直接修改数据使用$set</span><br>db.<span class="hljs-property">EasonChan</span>.<span class="hljs-title function_">update</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;m1&#x27;</span>&#125;,&#123;<span class="hljs-attr">$set</span>:&#123;<span class="hljs-attr">release</span>:<span class="hljs-string">&#x27;2010-10-12&#x27;</span>&#125;&#125;)<br><span class="hljs-comment">//在当前数据上增加数据使用$inc,支持负数</span><br>db.<span class="hljs-property">EasonChan</span>.<span class="hljs-title function_">update</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;Eason-Chan&#x27;</span>&#125;,&#123;<span class="hljs-attr">$inc</span>:&#123;<span class="hljs-attr">age</span>:<span class="hljs-number">2</span>&#125;&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="update方法的参数">update方法的参数</h4><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">db.EasonChan.<span class="hljs-keyword">update</span>(&#123;<span class="hljs-type">name</span>:<span class="hljs-string">&#x27;m1&#x27;</span>&#125;,&#123;$inc:&#123;<span class="hljs-built_in">public</span>:<span class="hljs-number">100</span>&#125;&#125;,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">true</span>);<br></code></pre></div></td></tr></table></figure><ul><li>第一个参数代表，如果没有匹配数据，在<code>update</code>的时候是否增加。</li><li>第二个参数代表，如果存在多条匹配数据，是否同时<code>update</code>。</li><li>默认值均为<code>false</code>，即如果是默认值，存在多条匹配数据则只<code>update</code>第一条；如果没有匹配数据则不<code>update</code>也不创建数据。</li></ul><h3 id="删除数据">删除数据</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//若存在多条匹配数据，一并删除</span><br>db.<span class="hljs-property">EasonChan</span>.<span class="hljs-title function_">remove</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;m1&#x27;</span>&#125;)<br></code></pre></div></td></tr></table></figure><h1>mongoose</h1><blockquote><p>mongoose是一个npm包，在node.js中对mongodb数据库进行操作。</p></blockquote><h2 id="连接mongodb">连接mongodb</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mongoose&#x27;</span>);<br><br>mongoose.<span class="hljs-title function_">connect</span>(<span class="hljs-string">&#x27;mongodb://localhost/music&#x27;</span>,&#123;<br><span class="hljs-attr">useNewUrlParser</span>: <span class="hljs-literal">true</span>, <br><span class="hljs-attr">useUnifiedTopology</span>: <span class="hljs-literal">true</span>,<br><span class="hljs-attr">family</span>: <span class="hljs-number">4</span>,&#125;)<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;success&#x27;</span>))<br>.<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;failed&#x27;</span>,err))<br></code></pre></div></td></tr></table></figure><h2 id="创建集合">创建集合</h2><p>创建集合分为两步，一是对集合设定规则，二是创建集合，创建<code>mongoose.Schema</code>构造函数的实例即可创建集合。下面代码会在mongdb的当前数据库下创建一个名叫<code>courses</code>的集合。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//设定集合规则</span><br><span class="hljs-keyword">const</span> courseSchema = <span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>(&#123;<br><span class="hljs-attr">name</span>:<span class="hljs-title class_">String</span>,<br>    <span class="hljs-attr">author</span>:<span class="hljs-title class_">String</span>,<br>    <span class="hljs-attr">isPublished</span>:<span class="hljs-title class_">Boolean</span><br>&#125;);<br><span class="hljs-comment">//创建集合并应用规则,返回值为一个构造函数</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Course</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">&#x27;Course&#x27;</span>,courseSchema);<br></code></pre></div></td></tr></table></figure><h3 id="集合规则对当前字段的验证规则">集合规则对当前字段的验证规则</h3><ul><li><code>required</code>：该配置项代表该集合中每条数据中某个元素是否是必须的，其值可以是简单的<code>Boolean</code>，也可以是一个数组，第一个值为<code>Boolean</code>，第二个值为错误信息。</li><li><code>minlength</code>和<code>maxlength</code>：限制了传入字段的长度，同时也可以写成是数组的形式，自定义错误信息。</li><li><code>trim</code>：如果值为<code>true</code>则去除了字符串两边的空格。</li><li><code>min</code>和<code>max</code>：需要我们注意的是，<code>minlength</code>和<code>maxlength</code>针对<code>type</code>为<code>string</code>的字段，而<code>min</code>和<code>max</code>针对的是<code>type</code>为<code>number</code>的字段，限制了传入字段的数值区间。</li><li><code>default</code>：可用于<code>Date</code>字段，如果设置<code>default</code>为<code>Date.now</code>则传入当前时间。</li><li><code>num</code>：枚举字段，意思是传入的<code>category</code>的值只能是<code>enum</code>中列举的。</li><li><code>validate</code>：对传入数据进行验证的配置对象。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> courseSchema = <span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>(&#123;<br><span class="hljs-attr">name</span>:&#123;<br><span class="hljs-attr">type</span>:<span class="hljs-title class_">String</span>,<br>        <span class="hljs-attr">required</span>:[<span class="hljs-literal">true</span>,<span class="hljs-string">&quot;name can&#x27;t be blank&quot;</span>],<br>        <span class="hljs-attr">minlength</span>:<span class="hljs-number">2</span>,<br>        <span class="hljs-attr">maxlength</span>:<span class="hljs-number">5</span>,<br>        <span class="hljs-attr">trim</span>:<span class="hljs-literal">true</span>,<br>&#125;,<br>    <span class="hljs-attr">age</span>:&#123;<br>        <span class="hljs-attr">type</span>:<span class="hljs-title class_">Number</span>,<br>        <span class="hljs-attr">min</span>:<span class="hljs-number">18</span>,<br>        <span class="hljs-attr">max</span>:<span class="hljs-number">100</span><br>    &#125;,<br>    <span class="hljs-attr">publishDate</span>:&#123;<br>        <span class="hljs-attr">type</span>:<span class="hljs-title class_">Date</span>,<br>        <span class="hljs-attr">default</span>:<span class="hljs-title class_">Date</span>.<span class="hljs-property">now</span><br>    &#125;,<br>    <span class="hljs-attr">category</span>:&#123;<br>        <span class="hljs-attr">type</span>:<span class="hljs-title class_">String</span>,<br>        <span class="hljs-attr">enum</span>:&#123;<br>            <span class="hljs-attr">values</span>:[<span class="hljs-string">&#x27;html&#x27;</span>,<span class="hljs-string">&#x27;css&#x27;</span>,<span class="hljs-string">&#x27;javascript&#x27;</span>],<br>            <span class="hljs-attr">message</span>:<span class="hljs-string">&#x27;分类名称需要在一定的范围内&#x27;</span><br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">author</span>:&#123;<br>        <span class="hljs-attr">type</span>:<span class="hljs-title class_">String</span>,<br>        <span class="hljs-attr">validate</span>:&#123;<br>            <span class="hljs-comment">//定义验证规则</span><br>            <span class="hljs-attr">validate</span>: <span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> &#123;<br>                <span class="hljs-comment">//返回布尔值,true为验证成功，false为验证失败</span><br>               <span class="hljs-keyword">return</span> v &amp;&amp; v.<span class="hljs-property">length</span> &gt; <span class="hljs-number">2</span><br>            &#125;,<br>            <span class="hljs-comment">//自定义错误信息</span><br>            <span class="hljs-attr">message</span>:<span class="hljs-string">&#x27;传入的值不符合验证规则&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;);<br></code></pre></div></td></tr></table></figure><h2 id="创建文档">创建文档</h2><p>创建文档实际上就是向集合中插入数据，分为两步，一是创建集合实例，二是调用实例对象下的<code>save</code>方法将数据保存到数据库中。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//创建集合实例</span><br><span class="hljs-keyword">const</span> course = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Course</span>(&#123;<br><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;Node.js course&#x27;</span>,<br><span class="hljs-attr">author</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span>,<br><span class="hljs-attr">tags</span>:[<span class="hljs-string">&#x27;node&#x27;</span>,<span class="hljs-string">&#x27;backend&#x27;</span>],<br><span class="hljs-attr">isPublished</span>:<span class="hljs-literal">true</span><br>&#125;);<br><span class="hljs-comment">//将数据保存到数据库中</span><br>course.<span class="hljs-title function_">save</span>();<br></code></pre></div></td></tr></table></figure><p>插入数据的另外一种方法，直接调用构造函数身上的<code>create</code>方法而不是实例化构造函数。</p><p>值得注意的是，对数据库的操作都是异步的，因此我们既可以用回调函数的写法，也可以用<code>promise</code>的写法。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//回调函数解法</span><br><span class="hljs-title class_">Course</span>.<span class="hljs-title function_">create</span>(&#123;<br><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;javascript&#x27;</span>,<br><span class="hljs-attr">author</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span>,<br><span class="hljs-attr">isPublished</span>:<span class="hljs-literal">true</span><br>&#125;,<span class="hljs-function">(<span class="hljs-params">err,doc</span>) =&gt;</span> &#123;<br><span class="hljs-comment">//错误对象，没有错误的话会返回null</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);<br><span class="hljs-comment">//当前插入的文档</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doc);<br>&#125;)<br><br><span class="hljs-comment">//promise写法</span><br><span class="hljs-title class_">Course</span>.<span class="hljs-title function_">create</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;javascript&#x27;</span>,<span class="hljs-attr">author</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span><span class="hljs-attr">isPublished</span>:<span class="hljs-literal">true</span>&#125;)<br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">doc</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doc))<br>.<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err))<br></code></pre></div></td></tr></table></figure><h2 id="mongodb数据库导入数据">mongodb数据库导入数据</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">mongoimport -d 数据库名称 -c 集合名称 -file 要导入的数据文件<br></code></pre></div></td></tr></table></figure><p>注：在<code>arch linux</code>中安装的是<code>mongodb-bin</code>，<code>z-shell</code>中我并未发现有<code>mongoimport</code>的命令，但我找到了导入数据的解决办法，就是在<code>mongodb compass</code>中进行操作。</p><h2 id="增删改查">增删改查</h2><h3 id="查询文档">查询文档</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//根据条件查询文档，如果输入条件见上方mongo shell中的操作</span><br><span class="hljs-title class_">Course</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result));<br></code></pre></div></td></tr></table></figure><h3 id="删除文档">删除文档</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//删除单个，若有多个符合条件则删除第一个。</span><br><span class="hljs-title class_">Course</span>.<span class="hljs-title function_">findOneAndDelete</span>(&#123;&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result))；<br><span class="hljs-comment">//返回值为删除的具体数据</span><br><br><span class="hljs-comment">//删除多个，不加条件（传空对象）则删全部数据。</span><br><span class="hljs-title class_">Course</span>.<span class="hljs-title function_">deleteMany</span>(&#123;&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result));<br><span class="hljs-comment">//返回一个对象&#123;n: ,ok:1&#125;  n后面接的是删除的数据的数目，ok代表状态</span><br></code></pre></div></td></tr></table></figure><h3 id="更新文档">更新文档</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//更新单个,若有多个符合条件则更改第一个。</span><br><span class="hljs-title class_">Course</span>.<span class="hljs-title function_">updateOne</span>(&#123;查询条件&#125;,&#123;要修改的值&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result));<br><span class="hljs-comment">//返回一个对象&#123;n: ,nModified: ,ok:1&#125; 其实个mongo shell中差不多</span><br><br><span class="hljs-comment">//更新多个，不加条件（传空对象）则更新全部数据。</span><br><span class="hljs-title class_">Course</span>.<span class="hljs-title function_">updateOne</span>(&#123;查询条件&#125;,&#123;要修改的值&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result));<br></code></pre></div></td></tr></table></figure><h3 id="错误信息处理">错误信息处理</h3><p>如果我们在插入数据的时候，多个字段都不符合验证规则，会返回一系列的<code>error</code>，即此时的形参<code>error</code>已经是一个对象，我们要可以分别读取所有的错误信息，如下列代码。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Course</span>.<span class="hljs-title function_">create</span>(&#123;<span class="hljs-attr">category</span>:<span class="hljs-string">&#x27;java&#x27;</span>,<span class="hljs-attr">author</span>:<span class="hljs-string">&#x27;d&#x27;</span>&#125;)<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(resuly))<br>.<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br><span class="hljs-keyword">let</span> err = error.<span class="hljs-property">errors</span>;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> attr <span class="hljs-keyword">in</span> err)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err[attr][<span class="hljs-string">&#x27;message&#x27;</span>]);<br>&#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h2 id="集合关联">集合关联</h2><blockquote><p>通常不同集合的数据之间是有关系的，例如文章信息和用户信息存储在不同集合中，但文章是某个用户发表的，要查询文章的所有信息包括发表用户，就需要用到集合关联。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//用户集合</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">User</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">&#x27;User&#x27;</span>,<span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>(&#123;<br><span class="hljs-attr">name</span>:&#123;<span class="hljs-attr">type</span>:<span class="hljs-title class_">String</span>&#125;<br>&#125;));<br><span class="hljs-comment">//文章集合</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Post</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">&#x27;Post&#x27;</span>,<span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>(&#123;<br><span class="hljs-attr">title</span>:&#123;<span class="hljs-attr">type</span>:<span class="hljs-title class_">String</span>&#125;,<br><span class="hljs-comment">//使用ID将文章集合和作者集合进行关联</span><br><span class="hljs-attr">author</span>:&#123;<span class="hljs-attr">type</span>:mongoose.<span class="hljs-property">Schema</span>.<span class="hljs-property">Types</span>.<span class="hljs-property">ObjectId</span>,<span class="hljs-attr">ref</span>:<span class="hljs-string">&#x27;User&#x27;</span>&#125;<br>&#125;))<br><span class="hljs-comment">//联合查询，populate方法的作用即是查询关联集合的具体信息。</span><br><span class="hljs-title class_">Post</span>.<span class="hljs-title function_">find</span>()<br>.<span class="hljs-title function_">populate</span>(<span class="hljs-string">&#x27;author&#x27;</span>)<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result));<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Node.js</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue-router</title>
    <link href="/2022/07/11/Vue-router/"/>
    <url>/2022/07/11/Vue-router/</url>
    
    <content type="html"><![CDATA[<h1>Vue-router</h1><ol><li>理解： 一个路由（route）就是一组映射关系（key - value），多个路由需要路由器（router）进行管理。</li><li>前端路由：key是路径，value是组件。</li></ol><h2 id="基本使用">基本使用</h2><ol><li><p>安装vue-router，命令：<code>npm i vue-router</code></p></li><li><p>应用插件：<code>Vue.use(VueRouter)</code></p></li><li><p>编写router配置项:</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//引入VueRouter</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">VueRouter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br><span class="hljs-comment">//引入Luyou 组件</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../components/About&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../components/Home&#x27;</span><br><br><span class="hljs-comment">//创建router实例对象，去管理一组一组的路由规则</span><br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>(&#123;<br><span class="hljs-attr">routes</span>:[<br>&#123;<br><span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/about&#x27;</span>,<br><span class="hljs-attr">component</span>:<span class="hljs-title class_">About</span><br>&#125;,<br>&#123;<br><span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/home&#x27;</span>,<br><span class="hljs-attr">component</span>:<span class="hljs-title class_">Home</span><br>&#125;<br>]<br>&#125;)<br><br><span class="hljs-comment">//暴露router</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router<br></code></pre></div></td></tr></table></figure></li><li><p>实现切换（active-class可配置高亮样式）</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">&lt;router-link <span class="hljs-attribute">active-class</span>=<span class="hljs-string">&quot;active&quot;</span> <span class="hljs-attribute">to</span>=<span class="hljs-string">&quot;/about&quot;</span>&gt;About&lt;/router-link&gt;<br></code></pre></div></td></tr></table></figure></li><li><p>指定展示位置</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-section">&lt;router-view&gt;</span><span class="hljs-section">&lt;/router-view&gt;</span><br></code></pre></div></td></tr></table></figure></li></ol><h3 id="几个注意点">几个注意点</h3><ol><li>路由组件通常存放在<code>pages</code>文件夹，一般组件通常存放在<code>components</code>文件夹。</li><li>通过切换，“隐藏”了的路由组件，默认是被销毁掉的，需要的时候再去挂载。</li><li>每个组件都有自己的<code>$route</code>属性，里面存储着自己的路由信息。</li><li>整个应用只有一个router，可以通过组件的<code>$router</code>属性获取到。</li></ol><h2 id="多级（嵌套）路由">多级（嵌套）路由</h2><ol><li><p>配置路由规则，使用children配置项：</p><figure class="highlight xl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xl">routes:[<br>&#123;<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;/about&#x27;</span>,<br>component:About,<br>&#125;,<br>&#123;<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;/home&#x27;</span>,<br>component:Home,<br>children:[ <span class="hljs-comment">//通过children配置子级路由</span><br>&#123;<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;news&#x27;</span>, <span class="hljs-comment">//此处一定不要写：/news</span><br>component:News<br>&#125;,<br>&#123;<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;message&#x27;</span>,<span class="hljs-comment">//此处一定不要写：/message</span><br>component:Message<br>&#125;<br>]<br>&#125;<br>]<br></code></pre></div></td></tr></table></figure></li><li><p>跳转（要写完整路径）：</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/home/news&quot;</span>&gt;</span>News<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><br></code></pre></div></td></tr></table></figure></li></ol><h2 id="路由的query参数">路由的query参数</h2><ol><li><p>传递参数</p><figure class="highlight dust"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-comment">&lt;!-- 跳转并携带query参数，to的字符串写法 --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;/home/message/detail?id=666&amp;title=你好&quot;</span>&gt;</span>跳转<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-comment">&lt;!-- 跳转并携带query参数，to的对象写法 --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> </span></span><br><span class="hljs-tag"><span class="language-xml"><span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123;</span><br><span class="hljs-template-variable">path:&#x27;/home/message/detail&#x27;,</span><br><span class="hljs-template-variable">query:&#123;</span><br><span class="hljs-template-variable">   id:666,</span><br><span class="hljs-template-variable">           title:&#x27;你好&#x27;</span><br><span class="hljs-template-variable">&#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string"></span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">&#125;&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">&gt;</span></span><br><span class="language-xml">跳转</span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure><p>如果需要传参则需使用模板字符串的写法。</p></li><li><p>接收参数：</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus"><span class="hljs-variable">$route</span><span class="hljs-selector-class">.query</span><span class="hljs-selector-class">.id</span><br><span class="hljs-variable">$route</span><span class="hljs-selector-class">.query</span>.title<br></code></pre></div></td></tr></table></figure></li></ol><h2 id="命名路由">命名路由</h2><ol><li><p>作用：可以简化路由的跳转。</p></li><li><p>如何使用</p><ol><li><p>给路由命名：</p><figure class="highlight xl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xl">&#123;<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;/demo&#x27;</span>,<br>component:Demo,<br>children:[<br>&#123;<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;test&#x27;</span>,<br>component:Test,<br>children:[<br>&#123;<br>                      <span class="hljs-keyword">name</span>:<span class="hljs-string">&#x27;hello&#x27;</span> <span class="hljs-comment">//给路由命名</span><br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;welcome&#x27;</span>,<br>component:Hello,<br>&#125;<br>]<br>&#125;<br>]<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><p>简化跳转：</p><figure class="highlight dust"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-comment">&lt;!--简化前，需要写完整的路径 --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/demo/test/welcome&quot;</span>&gt;</span>跳转<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-comment">&lt;!--简化后，直接通过名字跳转 --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123;name:&#x27;hello&#x27;&#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span>跳转<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-comment">&lt;!--简化写法配合传递参数 --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> </span></span><br><span class="hljs-tag"><span class="language-xml"><span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123;</span><br><span class="hljs-template-variable">name:&#x27;hello&#x27;,</span><br><span class="hljs-template-variable">query:&#123;</span><br><span class="hljs-template-variable">   id:666,</span><br><span class="hljs-template-variable">            title:&#x27;你好&#x27;</span><br><span class="hljs-template-variable">&#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string"></span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">&#125;&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">&gt;</span>跳转<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure></li></ol></li></ol><h2 id="路由的params参数">路由的params参数</h2><ol><li><p>配置路由，声明接收params参数</p><figure class="highlight xl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xl">&#123;<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;/home&#x27;</span>,<br>component:Home,<br>children:[<br>&#123;<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;news&#x27;</span>,<br>component:News<br>&#125;,<br>&#123;<br>component:Message,<br>children:[<br>&#123;<br><span class="hljs-keyword">name</span>:<span class="hljs-string">&#x27;xiangqing&#x27;</span>,<br><span class="hljs-built_in">path</span>:<span class="hljs-string">&#x27;detail/:id/:title&#x27;</span>, <span class="hljs-comment">//使用占位符声明接收params参数</span><br>component:Detail<br>&#125;<br>]<br>&#125;<br>]<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><p>传递参数</p><figure class="highlight dust"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-comment">&lt;!-- 跳转并携带params参数，to的字符串写法 --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;/home/message/detail/666/你好&quot;</span>&gt;</span>跳转<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-comment">&lt;!-- 跳转并携带params参数，to的对象写法 --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> </span></span><br><span class="hljs-tag"><span class="language-xml"><span class="hljs-attr">:to</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123;</span><br><span class="hljs-template-variable">name:&#x27;xiangqing&#x27;,</span><br><span class="hljs-template-variable">params:&#123;</span><br><span class="hljs-template-variable">   id:666,</span><br><span class="hljs-template-variable">            title:&#x27;你好&#x27;</span><br><span class="hljs-template-variable">&#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string"></span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">&#125;&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">&gt;</span>跳转<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure><blockquote><p>特别注意：路由携带params参数时，若使用to的对象写法，则不能使用path配置项，必须使用name配置！</p></blockquote></li><li><p>接收参数：</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus"><span class="hljs-variable">$route</span><span class="hljs-selector-class">.params</span><span class="hljs-selector-class">.id</span><br><span class="hljs-variable">$route</span><span class="hljs-selector-class">.params</span>.title<br></code></pre></div></td></tr></table></figure></li></ol><h2 id="路由的props配置">路由的props配置</h2><p>作用：让路由组件更方便的收到参数</p><figure class="highlight maxima"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs maxima">&#123;<br>name:&#x27;xiangqing&#x27;,<br>path:&#x27;detail/:id&#x27;,<br>component:Detail,<br><br>//第一种写法：<span class="hljs-built_in">props</span>值为对象，该对象中所有的<span class="hljs-built_in">key</span>-value的组合最终都会通过<span class="hljs-built_in">props</span>传给Detail组件<br>// <span class="hljs-built_in">props</span>:&#123;a:<span class="hljs-number">900</span>&#125;<br><br>//第二种写法：<span class="hljs-built_in">props</span>值为布尔值，布尔值为<span class="hljs-literal">true</span>，则把路由收到的所有params参数通过<span class="hljs-built_in">props</span>传给Detail组件<br>// <span class="hljs-built_in">props</span>:<span class="hljs-literal">true</span><br><br>//第三种写法：<span class="hljs-built_in">props</span>值为函数，该函数返回的对象中每一组<span class="hljs-built_in">key</span>-value都会通过<span class="hljs-built_in">props</span>传给Detail组件<br><span class="hljs-built_in">props</span>(route)&#123;<br><span class="hljs-built_in">return</span> &#123;<br>id:route.query.id,<br><span class="hljs-built_in">title</span>:route.query.<span class="hljs-built_in">title</span><br>&#125;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="router-link-的replace属性"><code>&lt;router-link&gt;</code>的replace属性</h2><ol><li>作用：控制路由跳转时操作浏览器历史记录的模式</li><li>浏览器的历史记录有两种写入方式：分别为<code>push</code>和<code>replace</code>，<code>push</code>是追加历史记录，<code>replace</code>是替换当前记录。路由跳转时候默认为<code>push</code></li><li>如何开启<code>replace</code>模式：<code>&lt;router-link replace .......&gt;News&lt;/router-link&gt;</code></li></ol><h2 id="编程式路由导航">编程式路由导航</h2><ol><li><p>作用：不借助<code>&lt;router-link&gt; </code>实现路由跳转，让路由跳转更加灵活</p></li><li><p>具体编码：</p><figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-comment">//$router的两个API</span><br>this.<span class="hljs-variable">$router</span>.<span class="hljs-title function_ invoke__">push</span>(&#123;<br><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;xiangqing&#x27;</span>,<br><span class="hljs-attr">params</span>:&#123;<br><span class="hljs-attr">id</span>:xxx,<br><span class="hljs-attr">title</span>:xxx<br>&#125;<br>&#125;)<br><br>this.<span class="hljs-variable">$router</span>.<span class="hljs-title function_ invoke__">replace</span>(&#123;<br><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;xiangqing&#x27;</span>,<br><span class="hljs-attr">params</span>:&#123;<br><span class="hljs-attr">id</span>:xxx,<br><span class="hljs-attr">title</span>:xxx<br>&#125;<br>&#125;)<br>this.<span class="hljs-variable">$router</span>.<span class="hljs-title function_ invoke__">forward</span>() <span class="hljs-comment">//前进</span><br>this.<span class="hljs-variable">$router</span>.<span class="hljs-title function_ invoke__">back</span>() <span class="hljs-comment">//后退</span><br>this.<span class="hljs-variable">$router</span>.<span class="hljs-title function_ invoke__">go</span>() <span class="hljs-comment">//可前进也可后退 参数是number类型(正数为前进的步数,负数为后退的部署)</span><br></code></pre></div></td></tr></table></figure></li></ol><h2 id="缓存路由组件">缓存路由组件</h2><ol><li><p>作用：让不展示的路由组件保持挂载，不被销毁。</p></li><li><p>具体编码：</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">&lt;<span class="hljs-keyword">keep</span>-alive <span class="hljs-keyword">include</span>=<span class="hljs-string">&quot;News&quot;</span>&gt; <br>    &lt;router-<span class="hljs-keyword">view</span>&gt;&lt;/router-<span class="hljs-keyword">view</span>&gt;<br>&lt;/<span class="hljs-keyword">keep</span>-alive&gt;<br></code></pre></div></td></tr></table></figure></li></ol><h2 id="两个新的生命周期钩子">两个新的生命周期钩子</h2><ol><li>作用：路由组件所独有的两个钩子，用于捕获路由组件的激活状态。</li><li>具体名字：<ol><li><code>activated</code>路由组件被激活时触发。</li><li><code>deactivated</code>路由组件失活时触发。</li></ol></li></ol><h2 id="路由守卫">路由守卫</h2><ol><li><p>作用：对路由进行权限控制</p></li><li><p>分类：全局守卫、独享守卫、组件内守卫</p></li><li><p>全局守卫:</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>全局前置守卫：初始化时执行、每次路由切换前执行<br>router.beforeEach((to,from,<span class="hljs-keyword">next</span>)=&gt;&#123;<br>console.log(<span class="hljs-string">&#x27;beforeEach&#x27;</span>,to,from)<br><span class="hljs-keyword">if</span>(to.meta.isAuth)&#123; <span class="hljs-regexp">//</span>判断当前路由是否需要进行权限控制<br><span class="hljs-keyword">if</span>(localStorage.getItem(<span class="hljs-string">&#x27;school&#x27;</span>) === <span class="hljs-string">&#x27;atguigu&#x27;</span>)&#123; <span class="hljs-regexp">//</span>权限控制的具体规则<br><span class="hljs-keyword">next</span>() <span class="hljs-regexp">//</span>放行<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>alert(<span class="hljs-string">&#x27;暂无权限查看&#x27;</span>)<br><span class="hljs-regexp">//</span> <span class="hljs-keyword">next</span>(&#123;name:<span class="hljs-string">&#x27;guanyu&#x27;</span>&#125;)<br>&#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">next</span>() <span class="hljs-regexp">//</span>放行<br>&#125;<br>&#125;)<br><br><span class="hljs-regexp">//</span>全局后置守卫：初始化时执行、每次路由切换后执行<br>router.afterEach((to,from)=&gt;&#123;<br>console.log(<span class="hljs-string">&#x27;afterEach&#x27;</span>,to,from)<br><span class="hljs-keyword">if</span>(to.meta.title)&#123; <br>document.title = to.meta.title <span class="hljs-regexp">//</span>修改网页的title<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>document.title = <span class="hljs-string">&#x27;vue_test&#x27;</span><br>&#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure></li><li><p>独享守卫:</p><figure class="highlight autoit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs autoit">beforeEnter(<span class="hljs-keyword">to</span>,from,<span class="hljs-keyword">next</span>)&#123;<br>console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;beforeEnter&#x27;</span>,<span class="hljs-keyword">to</span>,from)<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">to</span>.meta.isAuth)&#123; //判断当前路由是否需要进行权限控制<br><span class="hljs-keyword">if</span>(localStorage.getItem(<span class="hljs-string">&#x27;school&#x27;</span>) === <span class="hljs-string">&#x27;atguigu&#x27;</span>)&#123;<br><span class="hljs-keyword">next</span>()<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>alert(<span class="hljs-string">&#x27;暂无权限查看&#x27;</span>)<br>// <span class="hljs-keyword">next</span>(&#123;name:<span class="hljs-string">&#x27;guanyu&#x27;</span>&#125;)<br>&#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">next</span>()<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><p>组件内守卫：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>进入守卫：通过路由规则，进入该组件时被调用<br>beforeRouteEnter (to, from, <span class="hljs-keyword">next</span>) &#123;<br>&#125;,<br><span class="hljs-regexp">//</span>离开守卫：通过路由规则，离开该组件时被调用<br>beforeRouteLeave (to, from, <span class="hljs-keyword">next</span>) &#123;<br>&#125;<br></code></pre></div></td></tr></table></figure></li></ol><h2 id="路由器的两种工作模式">路由器的两种工作模式</h2><ol><li>对于一个url来说，什么是hash值？—— #及其后面的内容就是hash值。</li><li>hash值不会包含在 HTTP 请求中，即：hash值不会带给服务器。</li><li>hash模式：<ol><li>地址中永远带着#号，不美观 。</li><li>若以后将地址通过第三方手机app分享，若app校验严格，则地址会被标记为不合法。</li><li>兼容性较好。</li></ol></li><li>history模式：<ol><li>地址干净，美观 。</li><li>兼容性和hash模式相比略差。</li><li>应用部署上线时需要后端人员支持，解决刷新页面服务端404的问题。</li></ol></li></ol>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vuex</title>
    <link href="/2022/07/10/Vuex/"/>
    <url>/2022/07/10/Vuex/</url>
    
    <content type="html"><![CDATA[<h1>Vuex</h1><blockquote><p>Vuex是在Vue中实现集中式状态（数据）管理的一个Vue插件，对Vue应用中的多个组件的共享状态进行集中式的管理（读/写），也是一种组件间通信的方式，且适用与任意组件间通信。</p><p>适用情景：</p><p>1.多个组件依赖于同一状态</p><p>2.来自不同组件的行为需要变更同一状态</p></blockquote><h2 id="搭建Vuex的环境">搭建Vuex的环境</h2><p>在<code>src</code>目录下创建<code>store</code>目录并在其中新建<code>index.js</code>文件。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//引入Vuex</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vuex</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><br><span class="hljs-comment">//引入Vue</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-comment">//Vue.use(Vuex)需要在new Vuex.Store()之前</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Vuex</span>)<br><br><br><span class="hljs-comment">//准备actions——用于响应组件中的动作</span><br><span class="hljs-keyword">const</span> actions = &#123;&#125;;<br><span class="hljs-comment">//准备mutations——用于操作数据（state）</span><br><span class="hljs-keyword">const</span> mutations = &#123;&#125;;<br><span class="hljs-comment">//准备state——用于存储数据</span><br><span class="hljs-keyword">const</span> state = &#123;&#125;;<br><span class="hljs-comment">//准备getters——用于处理state中的数据（非必需的配置）</span><br><span class="hljs-keyword">const</span> getters =&#123;&#125;；<br><br><br><span class="hljs-comment">//state和getters 类似于 data和methods</span><br><br><br><span class="hljs-comment">//创建Store</span><br><span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>(&#123;<br><span class="hljs-comment">// actions:actions,</span><br><span class="hljs-comment">// mutations:mutations,</span><br><span class="hljs-comment">// state:state,</span><br><span class="hljs-comment">// key 和 value 重名可以触发简写形式</span><br>actions,<br>mutations,<br>state,<br>    getters<br>&#125;);<br><br><span class="hljs-comment">//暴露store</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store;<br></code></pre></div></td></tr></table></figure><p>值得注意的一点是：</p><p>需要在<code>index.js</code>中引入<code>Vuex</code>并执行<code>Vue.use(Vuex)</code>，因为在<code>new Vuex.store()</code>之前需要<code>Vuex</code>，如果在<code>main.js</code>中引入<code>Vuex</code>无论<code>import Vuex</code>的位置在哪，都会在<code>Vue.use(Vuex)</code>之前<code>import store</code>。</p><h2 id="四个map方法的使用">四个map方法的使用</h2><p><strong>mapState方法</strong>：用于帮助我们映射<code>state</code>中的数据为计算属性</p><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">computed: &#123;<br>    <span class="hljs-comment">//借助mapState生成计算属性：sum、school、subject（对象写法）</span><br>     ...map<span class="hljs-constructor">State(&#123;<span class="hljs-params">sum</span>:&#x27;<span class="hljs-params">sum</span>&#x27;,<span class="hljs-params">school</span>:&#x27;<span class="hljs-params">school</span>&#x27;,<span class="hljs-params">subject</span>:&#x27;<span class="hljs-params">subject</span>&#x27;&#125;)</span>,<br>         <br>    <span class="hljs-comment">//借助mapState生成计算属性：sum、school、subject（数组写法）</span><br>    ...map<span class="hljs-constructor">State([&#x27;<span class="hljs-params">sum</span>&#x27;,&#x27;<span class="hljs-params">school</span>&#x27;,&#x27;<span class="hljs-params">subject</span>&#x27;])</span>,<br>&#125;,<br></code></pre></div></td></tr></table></figure><p><strong>mapGetters方法</strong>：用于帮助我们映射<code>getters</code>中的数据为计算属性</p><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">computed: &#123;<br>    <span class="hljs-comment">//借助mapGetters生成计算属性：bigSum（对象写法）</span><br>    ...map<span class="hljs-constructor">Getters(&#123;<span class="hljs-params">bigSum</span>:&#x27;<span class="hljs-params">bigSum</span>&#x27;&#125;)</span>,<br><br>    <span class="hljs-comment">//借助mapGetters生成计算属性：bigSum（数组写法）</span><br>    ...map<span class="hljs-constructor">Getters([&#x27;<span class="hljs-params">bigSum</span>&#x27;])</span><br>&#125;,<br></code></pre></div></td></tr></table></figure><p><strong>mapMutations方法</strong>：用于帮助我们生成与<code>mutations</code>对话的方法，即：包含<code>$store.commit(xxx)</code>的函数</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">methods:&#123;<br>    <span class="hljs-comment">//靠mapActions生成：increment、decrement（对象形式）</span><br>    ..<span class="hljs-selector-class">.mapMutations</span>(&#123;increment:<span class="hljs-string">&#x27;JIA&#x27;</span>,decrement:<span class="hljs-string">&#x27;JIAN&#x27;</span>&#125;),<br>    <br>    <span class="hljs-comment">//靠mapMutations生成：JIA、JIAN（对象形式）</span><br>    ..<span class="hljs-selector-class">.mapMutations</span>(<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;JIA&#x27;</span>,<span class="hljs-string">&#x27;JIAN&#x27;</span>]</span>),<br>&#125;<br></code></pre></div></td></tr></table></figure><blockquote><p>备注：mapActions与mapMutations使用时，若需要传递参数需要：在模板中绑定事件时传递好参数，否则参数是事件对象。</p></blockquote><h2 id="模块化-命名空间">模块化+命名空间</h2><ol><li><p>目的：让代码更好维护，让多种数据分类更加明确。</p></li><li><p>修改<code>store.js</code></p><figure class="highlight pf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pf"><span class="hljs-keyword">const</span> countAbout = &#123;<br>  namespaced:true,//开启命名空间<br>  <span class="hljs-keyword">state</span>:&#123;x:<span class="hljs-number">1</span>&#125;,<br>  mutations: &#123; ... &#125;,<br>  actions: &#123; ... &#125;,<br>  getters: &#123;<br>    bigSum(<span class="hljs-keyword">state</span>)&#123;<br>       return <span class="hljs-keyword">state</span>.sum * <span class="hljs-number">10</span><br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> personAbout = &#123;<br>  namespaced:true,//开启命名空间<br>  <span class="hljs-keyword">state</span>:&#123; ... &#125;,<br>  mutations: &#123; ... &#125;,<br>  actions: &#123; ... &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> store = new Vuex.Store(&#123;<br>  modules: &#123;<br>    countAbout,<br>    personAbout<br>  &#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure></li><li><p>开启命名空间后，组件中读取state数据：</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus"><span class="hljs-comment">//方式一：自己直接读取</span><br>this.<span class="hljs-variable">$store</span><span class="hljs-selector-class">.state</span><span class="hljs-selector-class">.personAbout</span><span class="hljs-selector-class">.list</span><br><span class="hljs-comment">//方式二：借助mapState读取：</span><br>..<span class="hljs-selector-class">.mapState</span>(<span class="hljs-string">&#x27;countAbout&#x27;</span>,<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;sum&#x27;</span>,<span class="hljs-string">&#x27;school&#x27;</span>,<span class="hljs-string">&#x27;subject&#x27;</span>]</span>),<br></code></pre></div></td></tr></table></figure></li><li><p>开启命名空间后，组件中读取getters数据：</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus"><span class="hljs-comment">//方式一：自己直接读取</span><br>this.<span class="hljs-variable">$store</span><span class="hljs-selector-class">.getters</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;personAbout/firstPersonName&#x27;</span>]</span><br><span class="hljs-comment">//方式二：借助mapGetters读取：</span><br>..<span class="hljs-selector-class">.mapGetters</span>(<span class="hljs-string">&#x27;countAbout&#x27;</span>,<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;bigSum&#x27;</span>]</span>)<br></code></pre></div></td></tr></table></figure></li><li><p>开启命名空间后，组件中调用dispatch</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>方式一：自己直接dispatch<br>this.<span class="hljs-variable">$store</span>.dispatch(<span class="hljs-string">&#x27;personAbout/addPersonWang&#x27;</span>,person)<br><span class="hljs-regexp">//</span>方式二：借助mapActions：<br>...mapActions(<span class="hljs-string">&#x27;countAbout&#x27;</span>,&#123;incrementOdd:<span class="hljs-string">&#x27;jiaOdd&#x27;</span>,incrementWait:<span class="hljs-string">&#x27;jiaWait&#x27;</span>&#125;)<br></code></pre></div></td></tr></table></figure></li><li><p>开启命名空间后，组件中调用commit</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>方式一：自己直接commit<br>this.<span class="hljs-variable">$store</span>.commit(<span class="hljs-string">&#x27;personAbout/ADD_PERSON&#x27;</span>,person)<br><span class="hljs-regexp">//</span>方式二：借助mapMutations：<br>...mapMutations(<span class="hljs-string">&#x27;countAbout&#x27;</span>&#123;increment:<span class="hljs-string">&#x27;JIA&#x27;</span>,decrement:<span class="hljs-string">&#x27;JIAN&#x27;</span>&#125;),<br></code></pre></div></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue组件间通讯</title>
    <link href="/2022/07/08/Vue%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E8%AE%AF/"/>
    <url>/2022/07/08/Vue%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E8%AE%AF/</url>
    
    <content type="html"><![CDATA[<h1>Vue 组件间通讯</h1><h2 id="vue组件间通讯的各种情况">vue组件间通讯的各种情况</h2><h2 id="子传父">子传父</h2><h3 id="自定义事件和-emit-2">自定义事件和$emit</h3><blockquote><p>通过<code>$emit</code>和父组件给子组件绑定一个自定义事件实现：子给父传递数据</p><p>如下列代码中，父给子绑定的自定义事件为<code>PostName</code></p></blockquote><figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss"><span class="hljs-comment">//在父组件中：</span><br>&lt;Son <span class="hljs-keyword">@PostName</span>=<span class="hljs-string">&quot;getSonName&quot;</span>/&gt; <br>//&lt;Son <span class="hljs-attribute">v-on</span>:PostName=<span class="hljs-string">&quot;getSonName&quot;</span>&gt;<br><span class="hljs-attribute">methods</span>:&#123;<br><span class="hljs-built_in">getSonName</span>(name)&#123;<br>console<span class="hljs-selector-class">.log</span>(name)<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//在子组件中</span><br>methods:&#123;<br><span class="hljs-built_in">sendSonName</span>()&#123;<br>this.<span class="hljs-variable">$emit</span>(&#x27;PostName&#x27;,this.name,...params)<br>&#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><p>同时利用<code>ref</code>也可以实现 子组件传递数据给父组件 的过程</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//在父组件中</span><br>&lt;<span class="hljs-title class_">Son</span> ref=<span class="hljs-string">&quot;son&quot;</span>/&gt;<br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">getSonName</span>(<span class="hljs-params">name</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name)<br>&#125;<br>&#125;<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">son</span>.$on(<span class="hljs-string">&#x27;PostName&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">getSonName</span>)<br>&#125;<br><br><span class="hljs-comment">//在子组件中</span><br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">sendSonName</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;PostName&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,...params)<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>如果只想要传递一次数据</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//在父组件中：</span><br>&lt;<span class="hljs-title class_">Son</span> <span class="hljs-meta">@PostName</span>.<span class="hljs-property">once</span>=<span class="hljs-string">&quot;getSonName&quot;</span>/&gt; <br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">getSonName</span>(<span class="hljs-params">name</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name)<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//在父组件中</span><br>&lt;<span class="hljs-title class_">Son</span> ref=<span class="hljs-string">&quot;son&quot;</span>/&gt;<br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">getSonName</span>(<span class="hljs-params">name</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name)<br>&#125;<br>&#125;<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">son</span>.$once(<span class="hljs-string">&#x27;PostName&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">getSonName</span>)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>给子组件绑定原生事件的时候需要加上<code>.native</code></p><figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss">&lt;Son <span class="hljs-keyword">@PostName</span>.once=<span class="hljs-string">&quot;getSonName&quot;</span> <span class="hljs-keyword">@click</span>=<span class="hljs-string">&#x27;showInfo&#x27;</span>/&gt;<br><span class="hljs-attribute">methods</span>:&#123;<br><span class="hljs-built_in">getSonName</span>(name)&#123;<br>console<span class="hljs-selector-class">.log</span>(name)<br>&#125;,<br><span class="hljs-built_in">showInfo</span>()&#123;&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>在上述情况中，<code>click</code>属于是自定义事件</p><p>如果想要使它成为原生事件，可以使用<code>@click.native</code></p><h3 id="自定义事件的解绑-2">自定义事件的解绑</h3><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//在父组件中：</span><br>&lt;<span class="hljs-title class_">Son</span> <span class="hljs-meta">@PostName</span>=<span class="hljs-string">&quot;getSonName&quot;</span> <span class="hljs-meta">@PostAge</span>=<span class="hljs-string">&quot;getSonAge&quot;</span>/&gt; <br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">getSonName</span>(<span class="hljs-params">name</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name);<br>&#125;,<br><span class="hljs-title function_">getSonAge</span>(<span class="hljs-params">age</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(age);<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//在子组件中</span><br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">sendSonName</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;PostName&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,...params)<br>&#125;,<br><span class="hljs-title function_">unbind</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.$off(<span class="hljs-string">&#x27;PostName&#x27;</span>); <br><span class="hljs-comment">//仅解绑一个自定义事件</span><br><span class="hljs-variable language_">this</span>.$off([<span class="hljs-string">&#x27;PostAge&#x27;</span>,<span class="hljs-string">&#x27;PostName&#x27;</span>]);<br><span class="hljs-comment">//解绑多个自定义事件,用数组的形式</span><br><span class="hljs-variable language_">this</span>.$off();<br><span class="hljs-comment">//不传参，即解绑所有的自定义事件</span><br>&#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h2 id="全局事件总线（Global-EventBus）">全局事件总线（Global EventBus）</h2><blockquote><p>能利用全局事件总线实现任意组件间通讯</p><p>但由于父传子可以使用<code>props</code>，因此EventBus主要用于爷孙和兄弟之间</p></blockquote><ol><li>需要一个 特殊的对象，特点如下<ul><li>所有的组件都能访问到</li><li>具有<code>$on</code>  <code>$emit</code>  <code>$off</code>  方法</li></ul></li><li>目前已知<code>VueComponent.prototype</code>的<code>__proto__</code>指向<code>Vue.prototype</code>，而所有<code>VueComponent</code>的实例对象的<code>__proto__</code>指向<code>VueComponent.prototype</code>，因此只要在<code>Vue.prototype</code>中添加这个对象，并且让这个对象具有相应的方法。</li><li>并且我们知道<code>Vue</code>的实例对象上，具有这些方法。但是我们也知道需要在正确的时间点将这个对象创建出来，并放在<code>Vue.prototype</code>上，不然会出现已经别的组件上的代码已经执行完毕，这个对象还没有创建出来进行事件传递的尴尬。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//main.js中</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br><span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#app&#x27;</span>,<br><span class="hljs-attr">render</span>:<span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">App</span>),<br><span class="hljs-title function_">beforeCreate</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$bus</span> = <span class="hljs-variable language_">this</span>;<br><span class="hljs-comment">//this就是Vue的实例对象也就是vm</span><br>&#125;<br>&#125;)<br><br><span class="hljs-comment">// 实现B向A传递数据</span><br><span class="hljs-comment">// 兄弟组件A中</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.$on(<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">data</span>)=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;A收到了数据&#x27;</span>，data)；<br>&#125;)<br>&#125;,<br><span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.$off(<span class="hljs-string">&#x27;hello&#x27;</span>);<br><span class="hljs-comment">//在组件销毁之前解除对 &#x27;hello&#x27;事件的绑定,即解绑当前组件所用到的事件</span><br>&#125;<br>&#125;<br><br><span class="hljs-comment">//兄弟组件B中</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">sendData</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.$emit(<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="pubsub-js">pubsub-js</h2><blockquote><p>消息的订阅与发布，也可以实现任意组件间通讯，而且不局限于Vue</p></blockquote><p>下面我们继续实现组件B向组件A传递数据</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//组件A中</span><br><span class="hljs-keyword">import</span> pubsub <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pubsub-js&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-comment">//pubsub是一个对象，subscribe方法第一个参数是消息名称</span><br>        <span class="hljs-comment">//回调函数会收到传来的n+1个参数</span><br>        <span class="hljs-comment">//第一个参数是消息名（参数都以形参的形式接收到）</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">pubID</span> = pubsub.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;B has received data! And function&#x27;</span>);<br>&#125;)<br>        <span class="hljs-comment">//这里的回调函数最好写成箭头函数的形式，因为this的指向问题</span><br>        <span class="hljs-comment">//更好的做法是把回调函数直接写到methods中</span><br>&#125;,<br>    <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-comment">//取消订阅的不是消息本身，而是整个订阅。</span><br>        <span class="hljs-comment">//但是两个不同的钩子中访问不到，因此需要在this身上添加方法</span><br>        pubsub.<span class="hljs-title function_">unsubscribe</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pubID</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//组件B中</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>methods：&#123;<br><span class="hljs-title function_">sendDataToA</span>(<span class="hljs-params"></span>)&#123;<br>pubsub.<span class="hljs-title function_">publish</span>(<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-number">666</span>);<br><span class="hljs-comment">//B向发布&#x27;hello&#x27;消息并传递参数666</span><br>&#125;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>archlinux副屏设置</title>
    <link href="/2022/07/07/archlinux%E5%89%AF%E5%B1%8F%E8%AE%BE%E7%BD%AE/"/>
    <url>/2022/07/07/archlinux%E5%89%AF%E5%B1%8F%E8%AE%BE%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h1>ArchLinux副屏设置</h1><h2 id="命令行">命令行</h2><h3 id="查看准备就绪的显示屏">查看准备就绪的显示屏</h3><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">xrandr</span><br></code></pre></div></td></tr></table></figure><p>找到主屏幕和副屏幕</p><p>Bitter-Gourd的主屏幕和副屏幕分别是：<code>eDP-1</code>和<code>DP-2</code></p><h3 id="设置电脑屏幕为主屏幕">设置电脑屏幕为主屏幕</h3><figure class="highlight brainfuck"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs brainfuck"><span class="hljs-comment">xrandr</span> <span class="hljs-literal">--</span><span class="hljs-comment">output eDP</span><span class="hljs-literal">-</span><span class="hljs-comment">1</span> <span class="hljs-literal">--</span><span class="hljs-comment">auto</span> <span class="hljs-literal">--</span><span class="hljs-comment">primary</span><br></code></pre></div></td></tr></table></figure><h3 id="设置副屏幕显示">设置副屏幕显示</h3><figure class="highlight brainfuck"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs brainfuck"><span class="hljs-comment">xrandr</span> <span class="hljs-literal">--</span><span class="hljs-comment">output DP</span><span class="hljs-literal">-</span><span class="hljs-comment">2</span> <span class="hljs-literal">--</span><span class="hljs-comment">auto</span><br></code></pre></div></td></tr></table></figure><p>此时两个屏幕是同步的</p><h3 id="设置屏幕拓展">设置屏幕拓展</h3><figure class="highlight brainfuck"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs brainfuck"><span class="hljs-comment">xrandr</span> <span class="hljs-literal">--</span><span class="hljs-comment">output DP</span><span class="hljs-literal">-</span><span class="hljs-comment">2</span> <span class="hljs-literal">--</span><span class="hljs-comment">auto</span> <span class="hljs-literal">--</span><span class="hljs-comment">output eDP</span><span class="hljs-literal">-</span><span class="hljs-comment">1</span> <span class="hljs-literal">--</span><span class="hljs-comment">auto</span> <span class="hljs-literal">--</span><span class="hljs-comment">right</span><span class="hljs-literal">-</span><span class="hljs-comment">of DP</span><span class="hljs-literal">-</span><span class="hljs-comment">2</span> <br></code></pre></div></td></tr></table></figure><p>设置<code>DP-2</code>为主屏幕且<code>eDP-1</code>在<code>DP-2</code>的右侧，此时终端模拟器在<code>DP-2</code>上</p><figure class="highlight brainfuck"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs brainfuck"><span class="hljs-comment">xrandr</span> <span class="hljs-literal">--</span><span class="hljs-comment">output DP</span><span class="hljs-literal">-</span><span class="hljs-comment">2</span> <span class="hljs-literal">--</span><span class="hljs-comment">auto</span> <span class="hljs-literal">--</span><span class="hljs-comment">output eDP</span><span class="hljs-literal">-</span><span class="hljs-comment">1</span> <span class="hljs-literal">--</span><span class="hljs-comment">auto</span> <span class="hljs-literal">--</span><span class="hljs-comment">left</span><span class="hljs-literal">-</span><span class="hljs-comment">of DP</span><span class="hljs-literal">-</span><span class="hljs-comment">2</span> <br></code></pre></div></td></tr></table></figure><p>设置<code>DP-2</code>为主屏幕且<code>eDP-1</code>在<code>DP-2</code>的左侧，此时终端模拟器在<code>eDP-1</code>上</p><h3 id="关闭某个屏幕">关闭某个屏幕</h3><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">xrandr</span> --output eDP-<span class="hljs-number">1</span> --<span class="hljs-literal">off</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>开发环境配置</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>枚举类</title>
    <link href="/2022/07/06/%E6%9E%9A%E4%B8%BE%E7%B1%BB/"/>
    <url>/2022/07/06/%E6%9E%9A%E4%B8%BE%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h1>枚举类</h1><blockquote><p>TypeScript 在 ES 原有类型基础上加入枚举类型，使得在 TypeScript 中也可以给一组数值赋予名字，这样对开发者比较友好，可以理解枚举就是一个字典。枚举类型使用enum来定义。</p></blockquote><p>例如，定义一个<code>enum Week</code></p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Week</span> &#123;<br>  <span class="hljs-variable constant_">SUNDAY</span>,<br>  <span class="hljs-variable constant_">MONDAY</span>,<br>  <span class="hljs-variable constant_">TUESDAY</span>,<br>  <span class="hljs-variable constant_">WEDNESDAY</span>,<br>  <span class="hljs-variable constant_">THURSDAY</span>,<br>  <span class="hljs-variable constant_">FRIDAY</span>,<br>  <span class="hljs-variable constant_">SATURDAY</span><br> &#125;<br></code></pre></div></td></tr></table></figure><h2 id="value支持数字和字符串"><code>value</code>支持数字和字符串</h2><h3 id="数字枚举">数字枚举</h3><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">enum</span> Week &#123;<br>  <span class="hljs-attribute">SUNDAY</span> = <span class="hljs-number">0</span>,<br>  MONDAY = <span class="hljs-number">1</span>,<br>  TUESDAY = <span class="hljs-number">2</span>,<br>  WEDNESDAY = <span class="hljs-number">3</span>,<br>  THURSDAY = <span class="hljs-number">4</span>,<br>  FRIDAY = <span class="hljs-number">5</span>,<br>  SATURDAY = <span class="hljs-number">6</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>一个特殊的用法： 指定部分字段，其他使用默认递增索引</p><figure class="highlight fortran"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fortran">// 指定部分字段，其他使用默认递增索引<br><span class="hljs-keyword">enum</span> <span class="hljs-keyword">Status</span> &#123;<br>  Ok = <span class="hljs-number">200</span>,<br>  Created,<br>  Accepted,<br>  BadRequest = <span class="hljs-number">400</span>,<br>  Unauthorized<br>&#125;<br>console.<span class="hljs-built_in">log</span>(<span class="hljs-keyword">Status</span>.Created, <span class="hljs-keyword">Status</span>.Accepted, <span class="hljs-keyword">Status</span>.Unauthorized); // <span class="hljs-number">201</span> <span class="hljs-number">202</span> <span class="hljs-number">401</span><br></code></pre></div></td></tr></table></figure><h3 id="字符串枚举">字符串枚举</h3><figure class="highlight fsharp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs fsharp"><span class="hljs-built_in">enum</span> Message &#123;<br>  <span class="hljs-literal">Error</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Sorry, error&quot;</span>,<br>  Success <span class="hljs-operator">=</span> <span class="hljs-string">&quot;congratulations,success&quot;</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="支持双向映射">支持双向映射</h2><figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade">enum Status &#123;<br>  Success = <span class="hljs-number">200</span>,<br>  NotFound = <span class="hljs-number">404</span>,<br>  Error = <span class="hljs-number">500</span><br>&#125;<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(Status[<span class="hljs-string">&quot;Success&quot;</span>]); <span class="hljs-comment">// 200</span><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(Status[<span class="hljs-number">200</span>]); <span class="hljs-comment">// &#x27;Success&#x27;</span><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(Status[Status[<span class="hljs-string">&quot;Success&quot;</span>]]); <span class="hljs-comment">// &#x27;Success&#x27;</span><br></code></pre></div></td></tr></table></figure><h2 id="异构枚举">异构枚举</h2><blockquote><p>异构枚举就是枚举值中成员值<strong>既有数字类型又有字符串类型</strong></p></blockquote><figure class="highlight autoit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs autoit"><span class="hljs-keyword">enum</span> status &#123;<br>Failed:<span class="hljs-number">0</span>,<br>Success:<span class="hljs-string">&#x27;success!&#x27;</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="枚举合并">枚举合并</h2><blockquote><p>对同一个枚举类可以拆分成若干次定义，与一次性定义等价</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Day</span> &#123;<br>  <span class="hljs-variable constant_">SUNDAY</span>,<br>  <span class="hljs-variable constant_">MONDAY</span>,<br>  <span class="hljs-variable constant_">TUESDAY</span><br> &#125;<br><br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Day</span> &#123;<br>  <span class="hljs-variable constant_">WEDNESDAY</span>,<br>  <span class="hljs-variable constant_">THURSDAY</span>,<br>  <span class="hljs-variable constant_">FRIDAY</span>,<br>  <span class="hljs-variable constant_">SATURDAY</span><br> &#125;<br></code></pre></div></td></tr></table></figure><h2 id="常量枚举">常量枚举</h2><blockquote><p>在仅指定常量命名的情况下，定义的就是一个默认从 0 开始递增的数字集合</p></blockquote><figure class="highlight cmake"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cmake">enum Status &#123;<br>  <span class="hljs-keyword">Off</span>,<br>  <span class="hljs-keyword">On</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>相当于<code>Off</code>的<code>value</code>为0，<code>On</code>的<code>value</code>为1</p><h2 id="枚举成员类型和联合枚举类型">枚举成员类型和联合枚举类型</h2><blockquote><p>当所有枚举成员都拥有字面量枚举值时，枚举成员就成为了类型</p><p>枚举值符合条件时，这个枚举值就可以看做是一个包含所有成员的联合类型</p></blockquote><p>如果枚举值里所有成员都是字面量类型的值，那么枚举的每个成员和枚举值本身都可以作为类型来使用，我们称这样的枚举成员为字面量枚举成员。满足条件的枚举成员的值有以下三种：</p><ul><li>没有初始值的枚举成员，例如：<code>enum E &#123; A &#125;</code></li><li>值为字符串字面量，例如：<code>enum E &#123; A = 'a' &#125;</code></li><li>值为数值字面量，或者带有<code>-</code>符号的数值字面量，例如：<code>enum E &#123; A = 1 &#125;</code>、<code>enum E &#123; A = -1 &#125;</code></li></ul><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Status</span> &#123;<br>  <span class="hljs-title class_">Off</span>,<br>  <span class="hljs-title class_">On</span><br>&#125;<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Light</span> &#123;<br>  <span class="hljs-attr">status</span>: <span class="hljs-title class_">Status</span>;<br>&#125;<br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Animal</span> &#123;<br>  <span class="hljs-title class_">Dog</span> = <span class="hljs-number">1</span>,<br>  <span class="hljs-title class_">Cat</span> = <span class="hljs-number">2</span><br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-attr">light1</span>: <span class="hljs-title class_">Light</span> = &#123;<br>  <span class="hljs-attr">status</span>: <span class="hljs-title class_">Animal</span>.<span class="hljs-property">Dog</span> <span class="hljs-comment">// error 不能将类型“Animal.Dog”分配给类型“Status”</span><br>&#125;;<br><span class="hljs-keyword">const</span> <span class="hljs-attr">light2</span>: <span class="hljs-title class_">Light</span> = &#123;<br>  <span class="hljs-attr">status</span>: <span class="hljs-title class_">Status</span>.<span class="hljs-property">Off</span><br>&#125;;<br><span class="hljs-keyword">const</span> <span class="hljs-attr">light3</span>: <span class="hljs-title class_">Light</span> = &#123;<br>  <span class="hljs-attr">status</span>: <span class="hljs-title class_">Status</span>.<span class="hljs-property">On</span><br>&#125;;<br></code></pre></div></td></tr></table></figure><p>上面例子定义接口 Light 的 status 字段的类型为枚举值 Status，那么此时 status 的属性值必须为 <code>Status.Off</code> 和 <code>Status.On</code> 中的一个，也就是相当于<code>status: Status.Off | Status.On</code>。</p>]]></content>
    
    
    <categories>
      
      <category>Typescript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Typescript</title>
    <link href="/2022/06/20/Typescript/"/>
    <url>/2022/06/20/Typescript/</url>
    
    <content type="html"><![CDATA[<h1>Typescript</h1><h2 id="介绍">介绍</h2><ol><li>TypeScript简称TS。</li><li>TS和JS之间的关系其实就是Less/Sass和CSS之间的关系。</li><li>就像Less/Sass是对CSS进行扩展一样, TS也是对JS进行扩展。</li><li>就像Less/Sass最终会转换成CSS一样, 我们编写好的TS代码最终也会换成JS。</li><li>TypeScript是JavaScript的超集，因为它扩展了JavaScript，有JavaScript没有的东西。</li></ol><h2 id="类型声明">类型声明</h2><h3 id="字面量">字面量</h3><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> a = <span class="hljs-literal">false</span>;<br><span class="hljs-comment">//如果变量的声明与赋值是同时进行的，ts可以自动对变量进行类型检测</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">a:<span class="hljs-built_in">number</span>,b:<span class="hljs-built_in">number</span></span>):<span class="hljs-built_in">number</span>&#123;<br><span class="hljs-keyword">return</span> a + b;<br>&#125;<br><span class="hljs-comment">//返回值的类型声明</span><br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>:<span class="hljs-built_in">boolean</span> | <span class="hljs-built_in">string</span>;<br><span class="hljs-comment">//联合类型，b可以是boolean或者string</span><br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>:<span class="hljs-built_in">any</span>;<br><span class="hljs-comment">//any表示的是任意类型，一个变量设置类型为any后相当于对该变量关闭了TS的类型检测</span><br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">d</span>:<span class="hljs-built_in">unknown</span>;<br><span class="hljs-comment">//unknown表示未知类型的值</span><br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">s</span>:<span class="hljs-built_in">string</span>;<br>c = <span class="hljs-literal">false</span>;<br>d = <span class="hljs-literal">false</span>;<br>s = c; <span class="hljs-comment">//不会报错</span><br>s = d; <span class="hljs-comment">//会报错</span><br><br><span class="hljs-comment">//类型断言</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">*语法：</span><br><span class="hljs-comment">*变量 as 类型</span><br><span class="hljs-comment">* &lt;类型&gt;变量</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>):<span class="hljs-built_in">void</span>&#123;<br>    <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><span class="hljs-comment">//void 用来表示空，没有返回值的函数</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn2</span>(<span class="hljs-params"></span>):<span class="hljs-built_in">never</span>&#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;error&#x27;</span>);<br>&#125;<br><span class="hljs-comment">//return undefined也不行</span><br></code></pre></div></td></tr></table></figure><h3 id="对象">对象</h3><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> b：&#123;<span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span>,<span class="hljs-attr">age</span>:<span class="hljs-built_in">number</span>&#125;;<br><span class="hljs-comment">//&#123;&#125;用来指定对象中可以包含哪些属性</span><br><span class="hljs-comment">//语法：&#123;属性名：属性值，属性名：属性值&#125;</span><br><br><span class="hljs-keyword">let</span> c：&#123;<span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span>,age?:<span class="hljs-built_in">number</span>&#125;;<br><span class="hljs-comment">//在属性名后加上?，表示属性是可选的</span><br>       <br><span class="hljs-keyword">let</span> <span class="hljs-attr">d</span>:&#123;<span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span>,[<span class="hljs-attr">propName</span>:srting]:<span class="hljs-built_in">any</span>&#125;;<br><span class="hljs-comment">//写上任意类型的属性，这样写代表了有name的基础上可以有其他任意属性。</span><br>       <br><span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>:<span class="hljs-function">(<span class="hljs-params">x:<span class="hljs-built_in">number</span>,y:<span class="hljs-built_in">number</span></span>)=&gt;</span><span class="hljs-built_in">number</span>;<br><span class="hljs-comment">//设置函数结构的类型声明：</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">*语法：</span><br><span class="hljs-comment">*  (形参：类型，形参：类型...) =&gt; 返回值</span><br><span class="hljs-comment">*/</span><br>       <br><span class="hljs-keyword">let</span> <span class="hljs-attr">f</span>:<span class="hljs-built_in">number</span>[];<br><span class="hljs-keyword">let</span> <span class="hljs-attr">g</span>:<span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;;<br><span class="hljs-comment">//表示数值类型数组</span><br>       <br><span class="hljs-keyword">let</span> <span class="hljs-attr">h</span>:[<span class="hljs-built_in">string</span>,<span class="hljs-built_in">number</span>];<br><span class="hljs-comment">//元组，固定长度的数组。</span><br>       <br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Gender</span>&#123;<br>    <span class="hljs-title class_">Male</span> = <span class="hljs-number">0</span>,<br>    <span class="hljs-title class_">Female</span> = <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-comment">//枚举类（ts独有）</span><br>       <br><span class="hljs-keyword">type</span> myType = <span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">3</span> | <span class="hljs-number">4</span> | <span class="hljs-number">5</span>；<br><span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>:myType;<br><span class="hljs-comment">//类型别名</span><br></code></pre></div></td></tr></table></figure><h2 id="编译选项">编译选项</h2><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">&quot;include&quot;用来表示哪些些ts文件需要被编译</span><br><span class="hljs-comment">路径：**表示任意目录，*表示任意文件</span><br><span class="hljs-comment">&quot;exclude&quot;用来表示哪些ts文件不需要被编译</span><br><span class="hljs-comment">该配置项有默认值：[&quot;node_modules&quot;,&quot;bower_components&quot;,&quot;jspm_packages&quot;]</span><br><span class="hljs-comment">*/</span><br><span class="hljs-attr">&quot;include&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br><span class="hljs-string">&quot;./src/**/*&quot;</span><br><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">// &quot;exclude&quot;:[</span><br><br><span class="hljs-comment">// ]</span><br><span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ES2015&quot;</span><span class="hljs-punctuation">,</span> <br><span class="hljs-comment">//用来指定转换后ES版本</span><br><span class="hljs-comment">// &quot;module&quot;:&quot;ES2015&quot;, </span><br><span class="hljs-comment">//用来指定使用的模块化的规范</span><br><span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;AMD&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;lib&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">&quot;ES2015&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ES2015.Symbol&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;ES2015.Promise&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br><span class="hljs-comment">//用来指定项目中需要使用的库，有默认值(浏览器运行环境），一般不需要改</span><br><span class="hljs-attr">&quot;outDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./dist&quot;</span><span class="hljs-punctuation">,</span> <br><span class="hljs-comment">//用来指定编译后文件所在的目录</span><br><span class="hljs-attr">&quot;outFile&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./dist/app.js&quot;</span><span class="hljs-punctuation">,</span>  <br><span class="hljs-comment">//使编译后的代码合并成一个文件 </span><br><span class="hljs-comment">// Only &#x27;amd&#x27; and &#x27;system&#x27; modules are supported alongside --outFile.</span><br><br><span class="hljs-attr">&quot;allowJs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span> <br><span class="hljs-comment">//默认值：false；是否允许src目录下的JS代码同时编译到dist中</span><br><span class="hljs-attr">&quot;checkJs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">//默认值：false；JS代码语法检查</span><br><span class="hljs-attr">&quot;removeComments&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">//默认值：false；编译的时候是否移除注释</span><br><span class="hljs-attr">&quot;noEmit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">//默认值：false；编译后不生成文件，一般用来只想检查语法的情况。</span><br><span class="hljs-attr">&quot;noEmitOnError&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">//默认值：false；当有错误的时候不生成编译后的文件。</span><br>        <br>        <br><span class="hljs-comment">// &quot;strict&quot;:true,</span><br><span class="hljs-comment">// 严格检查的总开关</span><br>        <br>        <span class="hljs-attr">&quot;alwaysStrict&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">//编译后的JS代码开启严格模式，如果有export等会省略“use strict”</span><br><span class="hljs-attr">&quot;noImplicitAny&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">//不允许隐式的any类型</span><br><span class="hljs-attr">&quot;noImplicitThis&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">//不允许不明确类型的this</span><br><span class="hljs-attr">&quot;strictNullChecks&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span><br><span class="hljs-comment">//严格的检查空值，比如dom元素，如果不存在这个dom元素就会报错</span><br><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></div></td></tr></table></figure><h2 id="TypeScript打包">TypeScript打包</h2><h3 id="webpack整合">webpack整合</h3><p>通常情况下，实际开发中我们都需要使用构建工具对代码进行打包；</p><p>TS同样也可以结合构建工具一起使用，下边以webpack为例介绍一下如何结合构建工具使用TS；</p><p>步骤如下：</p><h4 id="初始化项目">初始化项目</h4><p>进入项目根目录，执行命令 <code>npm init -y</code>，创建package.json文件</p><h4 id="下载构建工具">下载构建工具</h4><p>命令如下：</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">npm i -D webpack webpack-cli webpack-dev-server typescript ts-loader clean-webpack-plugin<br></code></pre></div></td></tr></table></figure><p>共安装了7个包:</p><ul><li><code>webpack</code>：构建工具webpack</li><li><code>webpack-cli</code>：webpack的命令行工具</li><li><code>webpack-dev-server</code>：webpack的开发服务器</li><li><code>typescript</code>：ts编译器</li><li><code>ts-loader</code>：ts加载器，用于在webpack中编译ts文件</li><li><code>html-webpack-plugin</code>：webpack中html插件，用来自动创建html文件</li><li><code>clean-webpack-plugin</code>：webpack中的清除插件，每次编译都会先清除dist目录。</li></ul><h4 id="配置webpack">配置webpack</h4><p>根目录下创建webpack的配置文件<code>webpack.config.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">CleanWebpackPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;clean-webpack-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>   <span class="hljs-attr">optimization</span>:&#123;<br>       <span class="hljs-attr">minimize</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 关闭代码压缩，可选</span><br>   &#125;,<br><br>   <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/index.ts&quot;</span>,<br><br>   <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;inline-source-map&quot;</span>,<br><br>   <span class="hljs-attr">devServer</span>: &#123;<br>       <span class="hljs-attr">contentBase</span>: <span class="hljs-string">&#x27;./dist&#x27;</span><br>   &#125;,<br><br>   <span class="hljs-attr">output</span>: &#123;<br>       <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;dist&quot;</span>),<br>       <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;bundle.js&quot;</span>,<br>       <span class="hljs-attr">environment</span>: &#123;<br>           <span class="hljs-attr">arrowFunction</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 关闭webpack的箭头函数，可选</span><br>       &#125;<br>   &#125;,<br><br>   <span class="hljs-attr">resolve</span>: &#123;<br>       <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&quot;.ts&quot;</span>, <span class="hljs-string">&quot;.js&quot;</span>]<br>   &#125;,<br><br>   <span class="hljs-attr">module</span>: &#123;<br>       <span class="hljs-attr">rules</span>: [<br>           &#123;<br>               <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.ts$/</span>,<br>               <span class="hljs-attr">use</span>: &#123;<br>                   <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;ts-loader&quot;</span>     <br>               &#125;,<br>               <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span><br>           &#125;<br>       ]<br>   &#125;,<br>   <span class="hljs-comment">//添加webpack插件</span><br>   <span class="hljs-attr">plugins</span>: [<br>       <span class="hljs-keyword">new</span> <span class="hljs-title class_">CleanWebpackPlugin</span>(),<br>       <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>           <span class="hljs-attr">title</span>:<span class="hljs-string">&#x27;TS测试&#x27;</span><br>       &#125;),<br>   ],<br>   <span class="hljs-comment">//用来设置引用模块,告诉webpack哪些文件可以被当做模块引用。</span><br>   <span class="hljs-attr">resolve</span>:&#123;<br><span class="hljs-attr">extensions</span>:[<span class="hljs-string">&#x27;.ts&#x27;</span>,<span class="hljs-string">&#x27;.js&#x27;</span>]<br>   &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="配置TS编译选项">配置TS编译选项</h4><p>根目录下创建tsconfig.json，配置可以根据自己需要</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>   <span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>       <span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ES2015&quot;</span><span class="hljs-punctuation">,</span><br>       <span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ES2015&quot;</span><span class="hljs-punctuation">,</span><br>       <span class="hljs-attr">&quot;strict&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><br>   <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></div></td></tr></table></figure><h4 id="修改package-json配置">修改package.json配置</h4><p>修改package.json添加如下配置</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>   <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>       <span class="hljs-attr">&quot;test&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="hljs-punctuation">,</span><br>       <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack&quot;</span><span class="hljs-punctuation">,</span><br>       <span class="hljs-comment">//编译</span><br>       <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack serve --open --mode production&quot;</span><br>       <span class="hljs-comment">//webpack-dev-server：webpack的开发服务器(启动)</span><br>   <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></div></td></tr></table></figure><h4 id="项目使用">项目使用</h4><p>在src下创建ts文件，并在并命令行执行<code>npm run build</code>对代码进行编译；</p><p>或者执行<code>npm start</code>来启动开发服务器；</p><h3 id="Babel">Babel</h3><p>除了webpack，开发中还经常需要结合babel来对代码进行转换；</p><p>以使其可以兼容到更多的浏览器，在上述步骤的基础上，通过以下步骤再将babel引入到项目中；</p><blockquote><p>虽然TS在编译时也支持代码转换，但是只支持简单的代码转换；</p><p>对于例如：Promise等ES6特性，TS无法直接转换，这时还要用到babel来做转换；</p></blockquote><p>安装依赖包：</p><figure class="highlight coffeescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> i -D @babel/core @babel/preset-env babel-loader core-js<br></code></pre></div></td></tr></table></figure><p>共安装了4个包，分别是：</p><ul><li><code>@babel/core</code>：babel的核心工具</li><li><code>@babel/preset-env</code>：babel的预定义环境</li><li><code>@babel-loader</code>：babel在webpack中的加载器</li><li><code>core-js</code>：core-js用来使老版本的浏览器支持新版ES语法</li></ul><p>修改webpack.config.js配置文件</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">//引入路径包</span><br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-comment">//引入html插件</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HTMLWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><span class="hljs-comment">//引入clean插件</span><br><span class="hljs-keyword">const</span> &#123;<span class="hljs-title class_">CleanWebpackPlugin</span>&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;clean-webpack-plugin&#x27;</span>);<br><br><span class="hljs-comment">//webpack中的所有配置信息都应该卸载module.exports中</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br><span class="hljs-comment">//入口文件</span><br><span class="hljs-attr">entry</span>:<span class="hljs-string">&quot;./src/index.ts&quot;</span>,<br><span class="hljs-comment">//指定打包文件所在目录</span><br><span class="hljs-attr">output</span>:&#123;<br><span class="hljs-comment">//指定打包文件的目录</span><br><span class="hljs-attr">path</span>:path.<span class="hljs-title function_">resolve</span>(__dirname,<span class="hljs-string">&#x27;dist&#x27;</span>),<br><span class="hljs-comment">//打包后文件的名字</span><br><span class="hljs-attr">filename</span>:<span class="hljs-string">&quot;bundle.js&quot;</span>,<br>        <span class="hljs-comment">//告诉webpack不使用箭头函数</span><br><span class="hljs-attr">environment</span>:&#123;<br><span class="hljs-attr">arrowFunction</span>:<span class="hljs-literal">false</span><br>&#125;<br>&#125;,<br><span class="hljs-comment">//webpack打包时使用的模块</span><br><span class="hljs-attr">module</span>:&#123;<br> <span class="hljs-comment">//指定要加载的规则</span><br> <span class="hljs-attr">rules</span>:[<br> &#123;<br><span class="hljs-comment">//test指定的是规则生成的文件</span><br><span class="hljs-comment">//以.ts结尾的结尾的文件用ts-loader去处理</span><br><span class="hljs-attr">test</span>:<span class="hljs-regexp">/\.ts$/</span>,<br><span class="hljs-comment">//loader的执行顺序是从后往前执行</span><br><span class="hljs-comment">//我们的需求：先把ts的代码转换为js代码，然后在用babel处理js代码</span><br><span class="hljs-attr">use</span>: [<br> &#123;<br>  <span class="hljs-comment">//指定加载器</span><br>  <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>  <span class="hljs-comment">//设置babel</span><br>  <span class="hljs-attr">options</span>:&#123;<br>  <span class="hljs-comment">//设置预定义的环境</span><br><span class="hljs-attr">presets</span>: [<br>[<br>  <span class="hljs-comment">//指定环境的插件</span><br>  <span class="hljs-string">&quot;@babel/preset-env&quot;</span>,<br>  <span class="hljs-comment">//配置信息</span><br>  &#123;<br><span class="hljs-comment">//兼容的目标浏览器版本</span><br><span class="hljs-string">&quot;targets&quot;</span>:&#123;<br>                    <span class="hljs-comment">//最新的chrome是102(2022.6.21)</span><br><span class="hljs-string">&quot;chrome&quot;</span>: <span class="hljs-string">&quot;58&quot;</span>,<br><span class="hljs-string">&quot;ie&quot;</span>: <span class="hljs-string">&quot;11&quot;</span><br>&#125;,<br><span class="hljs-comment">//corejs的版本</span><br><span class="hljs-string">&quot;corejs&quot;</span>:<span class="hljs-string">&quot;3&quot;</span>,<br><span class="hljs-comment">//使用corejs的方式，“usage”表示按需加载</span><br><span class="hljs-string">&quot;useBuiltIns&quot;</span>: <span class="hljs-string">&quot;usage&quot;</span><br>  &#125;<br>]<br>]<br> &#125;,<br> &#123;<br><span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;ts-loader&quot;</span>,<br> &#125;<br>],<br><span class="hljs-comment">//要排除的文件</span><br><span class="hljs-attr">exclude</span>:<span class="hljs-regexp">/node-modules/</span><br>  &#125;<br>  ]<br>&#125;,<br><span class="hljs-comment">//配置Webpack插件</span><br><span class="hljs-attr">plugins</span>:[<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">CleanWebpackPlugin</span>(),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">HTMLWebpackPlugin</span>(&#123;<br><span class="hljs-comment">// title:&#x27;TS测试&#x27;,</span><br><span class="hljs-comment">//html模板，用了这个模板后，title设置的东西就不能起作用了</span><br><span class="hljs-attr">template</span>:<span class="hljs-string">&quot;./src/index.html&quot;</span>,<br><br>&#125;),<br>],<br><br><span class="hljs-comment">//用来设置引用模块,告诉webpack哪些文件可以被当做模块引用。</span><br><span class="hljs-attr">resolve</span>:&#123;<br><span class="hljs-attr">extensions</span>:[<span class="hljs-string">&#x27;.ts&#x27;</span>,<span class="hljs-string">&#x27;.js&#x27;</span>]<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>如此一来，使用ts编译后的文件将会再次被<code>babel</code>处理，使得代码可以在大部分浏览器中直接使用，同时可以在配置选项的targets中指定要兼容的浏览器版本。</p><h2 id="面向对象">面向对象</h2><p>要想面向对象，操作对象，首先便要拥有对象；</p><p>要创建对象，必须要先定义类，所谓的类可以理解为对象的模型；</p><p>程序中可以根据类创建指定类型的对象；</p><p>举例来说：</p><p>可以通过Person类来创建人的对象，通过Dog类创建狗的对象，不同的类可以用来创建不同的对象；</p><h3 id="定义类">定义类</h3><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> 类名 &#123;<br>    属性名: 类型;<br>    <br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">参数: 类型</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.属性名 = 参数;<br>    &#125;<br>    <br>    方法名()&#123;<br>        ....<br>    &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><p>示例：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>使用类：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-number">18</span>);<br>p.<span class="hljs-title function_">sayHello</span>();<br></code></pre></div></td></tr></table></figure><h3 id="构造函数">构造函数</h3><p>可以使用<code>constructor</code>定义一个构造器方法；</p><blockquote><p><strong>注1：在TS中只能有一个构造器方法！</strong></p></blockquote><p>例如：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span><br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>同时也可以直接将属性定义在构造函数中：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> name: <span class="hljs-built_in">string</span>, <span class="hljs-keyword">public</span> age: <span class="hljs-built_in">number</span></span>) &#123;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>上面两种定义方法是完全相同的！</p><blockquote><p><strong>注2：子类继承父类时，必须调用父类的构造方法（如果子类中也定义了构造方法）！</strong></p></blockquote><p>例如：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span>;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">num: <span class="hljs-built_in">number</span></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span> = num;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">X</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> &#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">num: <span class="hljs-built_in">number</span>, name: <span class="hljs-built_in">string</span></span>) &#123;<br>        <span class="hljs-variable language_">super</span>(num);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>如果在X类中不调用<code>super</code>将会报错！</p><h3 id="封装">封装</h3><p>对象实质上就是属性和方法的容器，它的主要作用就是存储属性和方法，这就是所谓的封装</p><p>默认情况下，对象的属性是可以任意的修改的，为了确保数据的安全性，在TS中可以对属性的权限进行设置</p><ul><li>静态属性（<code>static</code>）：<ul><li>声明为<code>static</code>的属性或方法不再属于实例，而是属于类的属性；</li></ul></li><li>只读属性（<code>readonly</code>）：<ul><li>如果在声明属性时添加一个<code>readonly</code>，则属性便成了只读属性无法修改</li></ul></li><li>TS中属性具有三种修饰符：<ul><li><code>public</code>（默认值），可以在类、子类和实例对象中修改</li><li><code>protected</code> ，可以在类、子类中修改</li><li><code>private</code> ，可以在类中修改</li></ul></li></ul><p>示例：</p><p><code>public</code>：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 默认public</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// 可以在类中修改</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">super</span>(name, age);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">//子类中可以修改</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-number">18</span>);<br>p.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;猪八戒&#x27;</span>;<span class="hljs-comment">// 可以通过实例对象修改</span><br></code></pre></div></td></tr></table></figure><p><code>protected</code>：</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    protected <span class="hljs-attr">name</span>: string;<br>    protected <span class="hljs-attr">age</span>: number;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: string, age: number</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// 可以修改</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span>&#123;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: string, age: number</span>)&#123;<br>        <span class="hljs-variable language_">super</span>(name, age);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">//子类中可以修改</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-number">18</span>);<br>p.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;猪八戒&#x27;</span>;<span class="hljs-comment">// 不能修改</span><br></code></pre></div></td></tr></table></figure><p>private：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// 可以修改</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span>&#123;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">super</span>(name, age);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">//子类中不能修改</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-number">18</span>);<br>p.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;猪八戒&#x27;</span>;<span class="hljs-comment">// 不能修改</span><br></code></pre></div></td></tr></table></figure><h3 id="属性存取器">属性存取器</h3><p>对于一些不希望被任意修改的属性，可以将其设置为<code>private</code></p><p>直接将其设置为<code>private</code>将导致无法再通过对象修改其中的属性</p><p>我们可以在类中定义一组读取、设置属性的方法，这种对属性读取或设置的属性被称为属性的存取器</p><p>读取属性的方法叫做<code>setter</code>方法，设置属性的方法叫做<code>getter</code>方法</p><p>示例：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-attr">_name</span>: <span class="hljs-built_in">string</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_name</span> = name;<br>    &#125;<br><br>    <span class="hljs-keyword">get</span> <span class="hljs-title function_">name</span>()&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_name</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">set</span> <span class="hljs-title function_">name</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_name</span> = name;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>);<br><span class="hljs-comment">// 实际通过调用getter方法读取name属性</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1.<span class="hljs-property">name</span>);<br><span class="hljs-comment">// 实际通过调用setter方法修改name属性 </span><br>p1.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;猪八戒&#x27;</span>; <br></code></pre></div></td></tr></table></figure><h3 id="静态属性">静态属性</h3><p>静态属性（方法），也称为类属性。使用静态属性无需创建实例，通过类即可直接使用</p><p>静态属性（方法）使用<code>static</code>开头</p><p>示例：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Tools</span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">PI</span> = <span class="hljs-number">3.1415926</span>;<br>    <br>    <span class="hljs-keyword">static</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">num1: <span class="hljs-built_in">number</span>, num2: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-keyword">return</span> num1 + num2<br>    &#125;<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Tools</span>.<span class="hljs-property">PI</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Tools</span>.<span class="hljs-title function_">sum</span>(<span class="hljs-number">123</span>, <span class="hljs-number">456</span>));<br></code></pre></div></td></tr></table></figure><h3 id="this">this</h3><p>在类中，使用this表示当前对象</p><h3 id="继承">继承</h3><p>继承时面向对象中的又一个特性</p><p>通过继承可以将其他类中的属性和方法引入到当前类中</p><p>示例：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span>&#123;<br><br>    <span class="hljs-title function_">bark</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>在汪汪叫！`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">&#x27;旺财&#x27;</span>, <span class="hljs-number">4</span>);<br>dog.<span class="hljs-title function_">bark</span>();<br></code></pre></div></td></tr></table></figure><p>通过继承可以在不修改类的情况下完成对类的扩展</p><h3 id="重写">重写</h3><p>发生继承时，如果子类中的方法会替换掉父类中的同名方法，这就称为方法的重写</p><p>示例：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">run</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`父类中的run方法！`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span>&#123;<br><br>    <span class="hljs-title function_">bark</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>在汪汪叫！`</span>);<br>    &#125;<br><br>    <span class="hljs-title function_">run</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`子类中的run方法，会重写父类中的run方法！`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">&#x27;旺财&#x27;</span>, <span class="hljs-number">4</span>);<br>dog.<span class="hljs-title function_">bark</span>();<br></code></pre></div></td></tr></table></figure><p><strong>在子类中可以使用super来完成对父类的引用</strong></p><h3 id="抽象类">抽象类</h3><p>抽象类是专门用来被其他类所继承的类，它<strong>只能被其他类所继承不能用来创建实例</strong></p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>&#123;<br>  <span class="hljs-keyword">abstract</span> <span class="hljs-title function_">run</span>(): <span class="hljs-built_in">void</span>;<br>  <span class="hljs-title function_">bark</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;动物在叫~&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animals</span>&#123;<br>  <span class="hljs-title function_">run</span>(<span class="hljs-params"></span>)&#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;狗在跑~&#x27;</span>);<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>使用abstract开头的方法叫做抽象方法，抽象方法<strong>没有方法体</strong>只能定义在抽象类中，继承抽象类时抽象方法必须要实现；在抽象类里有抽象方法也有一般的方法（与接口不同）。</p><h2 id="接口（Interface）">接口（Interface）</h2><p>接口的作用类似于抽象类，不同点在于：</p><ul><li><p>接口中的所有方法和属性都是没有实值的，换句话说接口中的所有方法都是抽象方法；</p></li><li><p>接口主要负责定义一个类的结构，接口可以去限制一个对象的接口：对象只有包含接口中定义的所有属性和方法时才能匹配接口；</p></li><li><p>同时，可以让一个类去实现接口，实现接口时类中要保护接口中的所有属性；</p></li></ul><p>示例（检查对象类型）：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-title function_">sayHello</span>():<span class="hljs-built_in">void</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">per: Person</span>)&#123;<br>    per.<span class="hljs-title function_">sayHello</span>();<br>&#125;<br><br><span class="hljs-title function_">fn</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, 我是 <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>)&#125;&#125;);<br></code></pre></div></td></tr></table></figure><p>示例（实现）：</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span>&#123;<br>   <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>   <span class="hljs-title function_">sayHello</span>():<span class="hljs-built_in">void</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Person</span>&#123;<br>   <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> name: <span class="hljs-built_in">string</span></span>) &#123;<br>   &#125;<br><br>   <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>) &#123;<br>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;大家好，我是&#x27;</span>+<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);<br>   &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="泛型">泛型</h2><blockquote><p>在定义函数或者类的时候，如果遇到类型不明确则可以使用泛型</p><p>与any相比好处是不会关闭TS的类型检查</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> fn&lt;T&gt;(<span class="hljs-attr">a</span>:T):T&#123;<br><span class="hljs-keyword">return</span> a;<br>&#125;<br><br><span class="hljs-comment">//可以直接调用具有泛型的函数</span><br><span class="hljs-title function_">fn</span>(a);  <span class="hljs-comment">//不指定泛型，但是TS会自动对类型进行推断</span><br>fn&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&#x27;hello&#x27;</span>); <span class="hljs-comment">//手动指定泛型</span><br><br><span class="hljs-comment">//泛型可以同时指定多个</span><br><span class="hljs-keyword">function</span> fn2&lt;T,K&gt;(<span class="hljs-attr">a</span>:T,<span class="hljs-attr">b</span>:K):T&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b);<br>    <span class="hljs-keyword">return</span> a;<br>&#125;<br>fn2&lt;<span class="hljs-built_in">number</span>,<span class="hljs-built_in">string</span>&gt;(<span class="hljs-attr">a</span>:<span class="hljs-number">123</span>,<span class="hljs-attr">b</span>:<span class="hljs-string">&#x27;hello&#x27;</span>);<br><br><span class="hljs-comment">//也可以限定泛型的范围</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Inter</span>&#123;<br>    <span class="hljs-attr">length</span>:<span class="hljs-built_in">number</span>;<br>&#125;<br><span class="hljs-comment">//T extends Inter 表示泛型T必须是Inter实现类（子类）</span><br><span class="hljs-keyword">function</span> fn3&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Inter</span>&gt;(<span class="hljs-attr">a</span>:T):<span class="hljs-built_in">number</span>&#123;<br>    <span class="hljs-keyword">return</span> a.<span class="hljs-property">length</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Myclass</span>&lt;T&gt;&#123;<br>    <span class="hljs-attr">name</span>:T;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name:T</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Typescript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>obs+FFmpeg制作gif</title>
    <link href="/2022/06/10/obs-FFmpeg%E5%88%B6%E4%BD%9Cgif/"/>
    <url>/2022/06/10/obs-FFmpeg%E5%88%B6%E4%BD%9Cgif/</url>
    
    <content type="html"><![CDATA[<h1>obs+FFmpeg制作gif</h1><h2 id="前言-2">前言</h2><blockquote><p>bitter-gourd发现在写demo的博客的时候需要用到一些gif</p><p>于是决定折腾一下怎么制作一张gif</p><p>用到的方法是：obs-studio录屏+FFmpeg制作</p></blockquote><h2 id="准备">准备</h2><h3 id="下载obs-studio">下载obs-studio</h3><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">yay -S obs-studio</span><br></code></pre></div></td></tr></table></figure><h2 id="具体步骤">具体步骤</h2><ol><li>先使用<code>obs-studio</code>录制视频，导出MP4格式的视频</li><li>再在视频中寻找需要制作成gif的那一段，记录时间。</li><li>再打开shell，直接使用<code>FFmpeg</code>，一行命令行即可。</li></ol><h2 id="FFmpeg命令行">FFmpeg命令行</h2><figure class="highlight inform7"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs inform7">ffmpeg -ss 30 -t 3 -i input.mp4 -vf <span class="hljs-string">&quot;fps=10,scale=320:-1:flags=lanczos,split<span class="hljs-subst">[s0]</span><span class="hljs-subst">[s1]</span>;<span class="hljs-subst">[s0]</span>palettegen<span class="hljs-subst">[p]</span>;<span class="hljs-subst">[s1]</span><span class="hljs-subst">[p]</span>paletteuse&quot;</span> -loop 0 output.gif<br></code></pre></div></td></tr></table></figure><p><code>-ss 30</code>：跳过前30秒</p><p><code>-t 3</code>：剪一段3秒的视频作为gif的时长</p><p><code>fps=10</code>：过滤器设置帧速率，实例中使用每秒 10 帧的速率。</p><p><code>scale=320</code>：设置gif的大小，320px的宽度，并在保持纵横比的同时自动确定高度。</p><p><code>palettegen and paletteuse</code>：调色板生成和调色板使用过滤器将生成并使用输入生成的自定义调色板。</p><p><code>-loop 0</code>：使用 -loop 输出选项控制循环， 值 0 是无限循环，-1 是不循环，而 1 将循环一次意味着它将播放两次。 比如值为 10 将导致 GIF 播放 11 次。</p>]]></content>
    
    
    <categories>
      
      <category>开发环境配置</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSS实现打字机</title>
    <link href="/2022/06/10/CSS%E5%AE%9E%E7%8E%B0%E6%89%93%E5%AD%97%E6%9C%BA/"/>
    <url>/2022/06/10/CSS%E5%AE%9E%E7%8E%B0%E6%89%93%E5%AD%97%E6%9C%BA/</url>
    
    <content type="html"><![CDATA[<h1>CSS实现打字效果</h1><h2 id="前言">前言</h2><blockquote><p>bitter-gourd想写一些有趣的CSS动画</p><p>github仓库地址：<a href="https://github.com/gaoachao/CSS-animation">https://github.com/gaoachao/CSS-animation</a></p><p>这是第一篇：CSS+HTML写的打字效果</p></blockquote><h2 id="实现效果">实现效果</h2><p><img src="typing.gif" alt="打字效果"></p><h2 id="代码">代码</h2><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.typing</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">80vh</span>;</span><br><span class="language-css">            <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">            <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">            <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.typing-effect</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">22ch</span>;  <span class="hljs-comment">/*字母数量 用ch表示0的宽度 配合overflow:hidden可以让steps的每一帧展出一个字符*/</span></span><br><span class="language-css">            <span class="hljs-attribute">white-space</span>: nowrap;  <span class="hljs-comment">/*不换行*/</span></span><br><span class="language-css">            <span class="hljs-attribute">overflow</span>: hidden;   <span class="hljs-comment">/*把超出部分隐藏*/</span></span><br><span class="language-css">            <span class="hljs-attribute">border-right</span>: <span class="hljs-number">3px</span> solid; <span class="hljs-comment">/*不要对这个效果基本没影响*/</span></span><br><span class="language-css">            <span class="hljs-attribute">font-family</span>: monospace; <span class="hljs-comment">/*设置等宽字体*/</span></span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">2em</span>;  </span><br><span class="language-css">            <span class="hljs-attribute">animation</span>: typing <span class="hljs-number">2s</span> <span class="hljs-built_in">steps</span>(<span class="hljs-number">22</span>), effect .<span class="hljs-number">5s</span> step-end infinite alternate;</span><br><span class="language-css">            <span class="hljs-comment">/* typing表示打字类型 2s打完 总共22步 </span></span><br><span class="hljs-comment"><span class="language-css">             * effect让光标持续跳动 0.5秒出现0.5秒消失（每1秒跳一下）</span></span><br><span class="hljs-comment"><span class="language-css">             * step-end表示在每一帧的最后 infinite表示一直跳动下去</span></span><br><span class="hljs-comment"><span class="language-css">             * 如果真的要一一对应应该让effect为2/22秒，这样光标跳动一下打一个字</span></span><br><span class="hljs-comment"><span class="language-css">             * alternate动画交替反向运行，反向运行时，动画按步后退 */</span></span><br><span class="language-css">        &#125;   </span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-keyword">@keyframes</span> typing &#123;</span><br><span class="language-css">            <span class="hljs-selector-tag">from</span> &#123;</span><br><span class="language-css">                <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">            &#125;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-comment">/*使typing这个div从0宽到设定宽度(字母数+ch)*/</span></span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-keyword">@keyframes</span> effect &#123;</span><br><span class="language-css">            <span class="hljs-number">50%</span> &#123;</span><br><span class="language-css">                 <span class="hljs-attribute">border-color</span>: transparent; </span><br><span class="language-css">            &#125;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-comment">/*设置effect这个div中的动画*/</span></span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;typing&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;typing-effect&quot;</span>&gt;</span>Typing effect for text<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p><strong>CodeSnap版</strong></p><p><img src="%E6%89%93%E5%AD%97%E6%9C%BA.jpg" alt="CodeSnap（凑篇幅）"></p>]]></content>
    
    
    <categories>
      
      <category>CSS动画</category>
      
    </categories>
    
    
    <tags>
      
      <tag>demo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSS选择器和CSS权重</title>
    <link href="/2022/06/05/CSS%E6%9D%83%E9%87%8D/"/>
    <url>/2022/06/05/CSS%E6%9D%83%E9%87%8D/</url>
    
    <content type="html"><![CDATA[<h1>CSS选择器</h1><h1>CSS权重</h1><p>从0开始，一个行内样式+1000，一个id选择器+100，一个元素选择器class或者伪类+10，一个标签选择器或者伪元素+1，通配符+0。</p><p><code>!important</code>等于正无穷。</p>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>浏览器存储方式比较</title>
    <link href="/2022/06/04/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F%E6%AF%94%E8%BE%83/"/>
    <url>/2022/06/04/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F%E6%AF%94%E8%BE%83/</url>
    
    <content type="html"><![CDATA[<h1>浏览器存储方式比较</h1><table><thead><tr><th>存储方式</th><th>特点</th><th>容量</th></tr></thead><tbody><tr><td>cookie</td><td>1、需要与服务器连接。2、可设置过期时间。3、会影响网络速度</td><td>超过4k会被忽略除chrome/safari 外, 都限制了其数量。</td></tr><tr><td>localStorage</td><td>1、无需请求服务器永久有效(除非手动清缓存)。2、可以封装时间限制的方法。</td><td>一般都是 5Mb 不同浏览器不同</td></tr><tr><td>sessionStorage</td><td>1、无需请求服务器。2、刷新不丢失关闭界面丢失</td><td>5Mb</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCode之JS题解</title>
    <link href="/2022/06/03/LeetCode%E4%B9%8BJS%E9%A2%98%E8%A7%A3/"/>
    <url>/2022/06/03/LeetCode%E4%B9%8BJS%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1>bitter-gourd的LeetCode题解</h1><h2 id="滑动窗口">滑动窗口</h2><h3 id="序号">序号</h3><p>3.无重复字符的最长子串</p><p>30.串联所有单词的子串</p><p>76.最小覆盖子串</p><p>159.至多包含两个不同字符的最长子串</p><p>209.长度最小的子数组</p><p>239.滑动窗口最大值</p><p>567.字符串的排列</p><p>632.最小区间</p><p>727.最小窗口子序列</p><h3 id="题目">题目</h3><h4 id="3-无重复字符的最长子串-medium">3.无重复字符的最长子串(medium)</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">string</span>&#125; <span class="hljs-variable">s</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">number</span>&#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">var</span> lengthOfLongestSubstring = <span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) &#123;<br>    <span class="hljs-keyword">let</span> res=<span class="hljs-number">0</span>,temp=[];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;i &lt; s.<span class="hljs-property">length</span>;i++)&#123;<br>        <span class="hljs-keyword">if</span>(!temp.<span class="hljs-title function_">includes</span>(s[i]))&#123;<br>            temp.<span class="hljs-title function_">push</span>(s[i]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            temp.<span class="hljs-title function_">shift</span>();<br>            i--;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br>        res = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(res,temp.<span class="hljs-property">length</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h4 id="30-串联所有单词的子串-hard">30.串联所有单词的子串(hard)</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">string</span>&#125; <span class="hljs-variable">s</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">string[]</span>&#125; <span class="hljs-variable">words</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">number[]</span>&#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">var</span> findSubstring = <span class="hljs-keyword">function</span>(<span class="hljs-params">s, words</span>) &#123;<br>    <span class="hljs-keyword">const</span> wordSize = words[<span class="hljs-number">0</span>].<span class="hljs-property">length</span>;<br>    <span class="hljs-keyword">const</span> substringLen = wordSize * words.<span class="hljs-property">length</span>;<br>    <span class="hljs-keyword">const</span> wordsCount = &#123;&#125;;<br>    words.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> (wordsCount[w] = (wordsCount[w] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>));<br>    <span class="hljs-keyword">const</span> res = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= s.<span class="hljs-property">length</span> - substringLen; i++) &#123;<br>        <span class="hljs-keyword">const</span> tempCount = &#123;...wordsCount&#125;;<br>        <span class="hljs-keyword">let</span> count = words.<span class="hljs-property">length</span>;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = i; j &lt; i + substringLen; j += wordSize) &#123;<br>            <span class="hljs-keyword">const</span> word = s.<span class="hljs-title function_">slice</span>(j, j + wordSize);<br>            <span class="hljs-keyword">if</span> (!(word <span class="hljs-keyword">in</span> tempCount) || tempCount[word] &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>            tempCount[word]--;<br>            count--;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (count === <span class="hljs-number">0</span>) res.<span class="hljs-title function_">push</span>(i);<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h4 id="209-长度最小的子数组-medium">209.长度最小的子数组(medium)</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">number</span>&#125; <span class="hljs-variable">target</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">number[]</span>&#125; <span class="hljs-variable">nums</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">number</span>&#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">var</span> minSubArrayLen = <span class="hljs-keyword">function</span>(<span class="hljs-params">target, nums</span>) &#123;<br>    <span class="hljs-keyword">let</span> length = nums.<span class="hljs-property">length</span>;<br>    <span class="hljs-keyword">if</span>(length == <span class="hljs-number">0</span> ) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">let</span> start = <span class="hljs-number">0</span>,end = <span class="hljs-number">0</span>,sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">let</span> ans = length+<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span>(end &lt; length)&#123;<br>        sum += nums[end];<br>        <span class="hljs-keyword">while</span>(sum &gt;= target)&#123;<br>            sum -= nums[start];<br>            ans = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(ans,end-start+<span class="hljs-number">1</span>);<br>            start++<br>        &#125;<br>        end ++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ans == length+<span class="hljs-number">1</span> ? <span class="hljs-number">0</span>:ans;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h2 id="热门题解">热门题解</h2><h4 id="206-反转链表">206.反转链表</h4><p><strong>迭代</strong></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for singly-linked list.</span><br><span class="hljs-comment"> * function ListNode(val, next) &#123;</span><br><span class="hljs-comment"> *     this.val = (val===undefined ? 0 : val)</span><br><span class="hljs-comment"> *     this.next = (next===undefined ? null : next)</span><br><span class="hljs-comment"> * &#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">ListNode</span>&#125; <span class="hljs-variable">head</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">ListNode</span>&#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">var</span> reverseList = <span class="hljs-keyword">function</span>(<span class="hljs-params">head</span>) &#123;<br>    <span class="hljs-keyword">let</span> prev = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">let</span> curr = head;<br>    <span class="hljs-keyword">while</span> (curr) &#123;<br>        <span class="hljs-keyword">const</span> next = curr.<span class="hljs-property">next</span>;<br>        curr.<span class="hljs-property">next</span> = prev;<br>        prev = curr;<br>        curr = next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> prev;<br>&#125;;<br></code></pre></div></td></tr></table></figure><p><strong>递归</strong></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> reverseList = <span class="hljs-keyword">function</span>(<span class="hljs-params">head</span>) &#123;<br>    <span class="hljs-keyword">if</span> (head == <span class="hljs-literal">null</span> || head.<span class="hljs-property">next</span> == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> head;<br>    &#125;<br>    <span class="hljs-keyword">const</span> newHead = <span class="hljs-title function_">reverseList</span>(head.<span class="hljs-property">next</span>);<br>    head.<span class="hljs-property">next</span>.<span class="hljs-property">next</span> = head;<br>    head.<span class="hljs-property">next</span> = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">return</span> newHead;<br>&#125;;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>水平垂直居中</title>
    <link href="/2022/06/03/div%E5%B1%85%E4%B8%AD/"/>
    <url>/2022/06/03/div%E5%B1%85%E4%B8%AD/</url>
    
    <content type="html"><![CDATA[<h1>div水平垂直居中</h1><h2 id="方法汇总">方法汇总</h2><ul><li><code>flex</code>布局实现</li><li><code>positon</code>实现<ul><li>元素已知宽度高度</li><li>元素未知宽度高度</li><li>元素已知宽度高度且只设置<code>margin</code></li></ul></li><li><code>table-cell</code>布局实现</li></ul><h2 id="HTML结构">HTML结构</h2><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;father&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;son&quot;</span>&gt;</span>bitter-gourd<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="flex布局实现">flex布局实现</h2><ol><li>父元素开<code>flex</code>布局</li><li>子元素是否有宽度或者高度不影响居中。</li></ol><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.father</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">237</span>, <span class="hljs-number">245</span>, <span class="hljs-number">198</span>);<br>    <span class="hljs-attribute">display</span>:flex;<br>    <span class="hljs-attribute">justify-content</span>: center;<br>    <span class="hljs-attribute">align-items</span>:center;<br>&#125;<br><br><span class="hljs-selector-class">.son</span>&#123;<br>    <span class="hljs-attribute">width</span>:<span class="hljs-number">150px</span>;<br>    <span class="hljs-attribute">height</span>:<span class="hljs-number">80px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">198</span>, <span class="hljs-number">232</span>, <span class="hljs-number">247</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="1.png" alt="子元素设置宽度高度"></p><p><img src="2.png" alt="子元素不设置宽度高度"></p><h2 id="position实现">position实现</h2><h3 id="元素已知宽度高度">元素已知宽度高度</h3><ol><li>父元素设置<code>relative</code>（必要的）</li><li>子元素设置<code>absolute</code></li><li>子元素设置<code>top</code>和<code>left</code></li><li>子元素设置<code>margin-top =-1/2 height</code>和<code>margin-left =-1/2 width</code></li></ol><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.father</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>);<br>    <span class="hljs-attribute">position</span>:relative;<br>&#125;<br><span class="hljs-selector-class">.son</span>&#123;<br>    <span class="hljs-attribute">width</span>:<span class="hljs-number">150px</span>;<br>    <span class="hljs-attribute">height</span>:<span class="hljs-number">80px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">171</span>, <span class="hljs-number">224</span>, <span class="hljs-number">247</span>);<br>    <span class="hljs-attribute">position</span>:absolute;<br>    <span class="hljs-attribute">top</span>:<span class="hljs-number">50%</span>;<br>    <span class="hljs-attribute">left</span>:<span class="hljs-number">50%</span>;<br>    <span class="hljs-attribute">margin</span>:-<span class="hljs-number">40px</span> <span class="hljs-number">0</span>  <span class="hljs-number">0</span> -<span class="hljs-number">75px</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="1.png" alt="position实现之已知宽高"></p><h3 id="元素未知宽高">元素未知宽高</h3><ol><li>父元素设置<code>relative</code>（必要的）</li><li>子元素设置<code>absolute</code></li><li>子元素设置<code>top</code>和<code>left</code></li><li>子元素设置<code>transform: translate(-50%,-50%);</code></li></ol><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.father</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>);<br>    <span class="hljs-attribute">position</span>:relative;<br>&#125;<br><span class="hljs-selector-class">.son</span>&#123;<br>    <span class="hljs-comment">/* width:150px;</span><br><span class="hljs-comment">    height:80px; */</span><br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">171</span>, <span class="hljs-number">224</span>, <span class="hljs-number">247</span>);<br>    <span class="hljs-attribute">position</span>:absolute;<br>    <span class="hljs-attribute">top</span>:<span class="hljs-number">50%</span>;<br>    <span class="hljs-attribute">left</span>:<span class="hljs-number">50%</span>;<br>    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>,-<span class="hljs-number">50%</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="2.png" alt="position实现之未知宽高"></p><h3 id="元素已知宽高用margin实现">元素已知宽高用margin实现</h3><ol><li>父元素设置<code>relative</code>（必要的）</li><li>子元素设置<code>absolute</code></li><li>子元素设置<code>top</code>、<code>left</code>、<code>bottom</code>、<code>right</code> = 0</li><li>子元素设置<code>margin:auto</code></li></ol><p>注意：如果子元素不设置宽高，子元素会铺满父元素。</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.father</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>);<br>    <span class="hljs-attribute">position</span>: relative;<br>&#125;<br><br><span class="hljs-selector-class">.son</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">80px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">171</span>, <span class="hljs-number">224</span>, <span class="hljs-number">247</span>);<br>    <span class="hljs-attribute">position</span>: absolute;<br>    <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">margin</span>: auto;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="1.png" alt="元素已知宽高用margin实现"></p><h2 id="table-cell布局实现">table-cell布局实现</h2><ol><li>父元素设置<code>display:table-cell;vertical-align:middle;</code>实现子元素垂直居中。</li><li>子元素设置<code>margin:0 auto</code>实现子元素水平居中。</li></ol><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.father</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>);<br>    <span class="hljs-attribute">display</span>: table-cell;            <br>    <span class="hljs-attribute">vertical-align</span>: middle;   <br>&#125;<br><br><span class="hljs-selector-class">.son</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">80px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">171</span>, <span class="hljs-number">224</span>, <span class="hljs-number">247</span>);<br>    <span class="hljs-attribute">margin</span>:<span class="hljs-number">0</span> auto;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="1.png" alt="table-cell布局实现"></p><h1>文字图片水平垂直居中</h1><h2 id="文字水平垂直居中">文字水平垂直居中</h2><ol><li>设置文字所在div盒子<code>display:table-cell</code></li><li>设置文字所在div盒子<code>text-align:center;vertical-align:center;</code></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">.<span class="hljs-property">father</span> &#123;<br>    <span class="hljs-attr">width</span>: 400px;<br>    <span class="hljs-attr">height</span>: 200px;<br>    background-<span class="hljs-attr">color</span>: <span class="hljs-title function_">rgb</span>(<span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>);<br>&#125;<br><br>.<span class="hljs-property">son</span> &#123;<br>    <span class="hljs-attr">width</span>: 150px;<br>    <span class="hljs-attr">height</span>: 80px;<br>    background-<span class="hljs-attr">color</span>: <span class="hljs-title function_">rgb</span>(<span class="hljs-number">171</span>, <span class="hljs-number">224</span>, <span class="hljs-number">247</span>);<br>    <span class="hljs-attr">display</span>: table-cell; <br>    text-<span class="hljs-attr">align</span>: center;<br>    vertical-<span class="hljs-attr">align</span>: middle; <br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="3.png" alt="文字水平垂直居中"></p><h2 id="图片水平垂直居中">图片水平垂直居中</h2><ol><li>设置img所在div盒子<code>display:table-cell</code></li><li>设置img所在div盒子<code>text-align:center;vertical-align:center;</code></li></ol><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.father</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>);<br>    <span class="hljs-attribute">display</span>: table-cell; <br>    <span class="hljs-attribute">text-align</span>: center;<br>    <span class="hljs-attribute">vertical-align</span>: middle; <br>&#125;<br><br><span class="hljs-selector-tag">img</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">80px</span>; <br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="4.png" alt="图片水平垂直居中"></p><p>**注意：**如果把图片设置为块状元素，则会失去<code>text-align:center</code></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.father</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>);<br>    <span class="hljs-attribute">display</span>: table-cell; <br>    <span class="hljs-attribute">text-align</span>: center;<br>    <span class="hljs-attribute">vertical-align</span>: middle; <br>&#125;<br><br><span class="hljs-selector-tag">img</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">80px</span>; <br>    <span class="hljs-attribute">display</span>:block;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="5.png" alt="图片为块状元素"></p><p>但是可以通过<code>flex</code>布局实现垂直水平居中</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.father</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">131</span>);<br>    <span class="hljs-comment">/*display: table-cell; </span><br><span class="hljs-comment">    text-align: center;</span><br><span class="hljs-comment">    vertical-align: middle; */</span><br>    <span class="hljs-attribute">display</span>:flex;<br>    <span class="hljs-attribute">justify-content</span>:center;<br>    <span class="hljs-attribute">align-items</span>:center;<br>&#125;<br><br><span class="hljs-selector-tag">img</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">80px</span>; <br>    <span class="hljs-attribute">display</span>:block;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="4.png" alt="块状图片flex布局实现居中"></p>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>手写curry函数</title>
    <link href="/2022/06/03/%E6%89%8B%E5%86%99curry%E5%87%BD%E6%95%B0/"/>
    <url>/2022/06/03/%E6%89%8B%E5%86%99curry%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h1>柯里化</h1><h2 id="定义">定义</h2><p>维基百科中对柯里化 (Currying) 的定义为：</p><blockquote><p>In mathematics and computer science, currying is the technique of translating the evaluation of a function that takes multiple arguments (or a tuple of arguments) into evaluating a sequence of functions, each with a single argument.</p></blockquote><p>在数学和计算机科学中，柯里化是一种将使用多个参数的一个函数转换成一系列使用一个参数的函数的技术。</p><h2 id="用法-2">用法</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">//3</span><br><br><span class="hljs-keyword">var</span> addCurry = <span class="hljs-title function_">curry</span>(add);<br><span class="hljs-title function_">addCurry</span>(<span class="hljs-number">1</span>)(<span class="hljs-number">2</span>)  <span class="hljs-comment">//3</span><br></code></pre></div></td></tr></table></figure><h2 id="手写Curry">手写<code>Curry</code></h2><h3 id="破产版">破产版</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myCurry</span>(<span class="hljs-params">fn</span>)&#123;<br>    <span class="hljs-keyword">const</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>,<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">const</span> newArgs = args.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>));<br>        <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>,newArgs)<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="%E7%A0%B4%E4%BA%A7%E7%89%88.jpg" alt="破产版"></p><p>上述测试结果分别是：NAN  6   24    24</p><p>虽然还是做不到原生<code>curry(1)(2)(3)</code>这样传递参数，但也算是完成了curry函数的作用之一，<strong>参数复用</strong>。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">type, url, data</span>) &#123;<br>    <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>    xhr.<span class="hljs-title function_">open</span>(type, url, <span class="hljs-literal">true</span>);<br>    xhr.<span class="hljs-title function_">send</span>(data);<br>&#125;<br><br><span class="hljs-comment">// 虽然 ajax 这个函数非常通用，但在重复调用的时候参数冗余</span><br><span class="hljs-title function_">ajax</span>(<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;www.test.com&#x27;</span>, <span class="hljs-string">&quot;name=kevin&quot;</span>)<br><span class="hljs-title function_">ajax</span>(<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;www.test2.com&#x27;</span>, <span class="hljs-string">&quot;name=kevin&quot;</span>)<br><span class="hljs-title function_">ajax</span>(<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;www.test3.com&#x27;</span>, <span class="hljs-string">&quot;name=kevin&quot;</span>)<br><br><span class="hljs-comment">// 利用 curry</span><br><span class="hljs-keyword">var</span> ajaxCurry = <span class="hljs-title function_">curry</span>(ajax);<br><br><span class="hljs-comment">// 以 POST 类型请求数据</span><br><span class="hljs-keyword">var</span> post = <span class="hljs-title function_">ajaxCurry</span>(<span class="hljs-string">&#x27;POST&#x27;</span>);<br><span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;www.test.com&#x27;</span>, <span class="hljs-string">&quot;name=kevin&quot;</span>);<br><br><span class="hljs-comment">// 以 POST 类型请求来自于 www.test.com 的数据</span><br><span class="hljs-keyword">var</span> postFromTest = <span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;www.test.com&#x27;</span>);<br><span class="hljs-title function_">postFromTest</span>(<span class="hljs-string">&quot;name=kevin&quot;</span>);<br></code></pre></div></td></tr></table></figure><h3 id="优化版">优化版</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myCurry</span>(<span class="hljs-params">fn,args</span>)&#123;<br>    <span class="hljs-keyword">const</span> length = fn.<span class="hljs-property">length</span>;<br>    args = args || [];<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">const</span> _args = args.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">let</span> arg; <span class="hljs-comment">//const定义需要赋初值</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>;i++)&#123;<br>            arg = <span class="hljs-variable language_">arguments</span>[i];<br>            _args.<span class="hljs-title function_">push</span>(arg);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(_args.<span class="hljs-property">length</span> &lt; length)&#123;<br>            <span class="hljs-keyword">return</span> myCurry.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>,fn,_args);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>,_args);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> fn = <span class="hljs-title function_">myCurry</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([a, b, c]);<br>&#125;);<br><br><span class="hljs-title function_">fn</span>(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>) <span class="hljs-comment">// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span><br><span class="hljs-title function_">fn</span>(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>)(<span class="hljs-string">&quot;c&quot;</span>) <span class="hljs-comment">// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span><br><span class="hljs-title function_">fn</span>(<span class="hljs-string">&quot;a&quot;</span>)(<span class="hljs-string">&quot;b&quot;</span>)(<span class="hljs-string">&quot;c&quot;</span>) <span class="hljs-comment">// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span><br><span class="hljs-title function_">fn</span>(<span class="hljs-string">&quot;a&quot;</span>)(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>) <span class="hljs-comment">// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span><br><br><span class="hljs-keyword">const</span> fn2 = <span class="hljs-title function_">myCurry</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([a,b,c]);<br>&#125;,<span class="hljs-string">&quot;a&quot;</span>);<br><span class="hljs-title function_">fn2</span>(<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;c&quot;</span>);  <span class="hljs-comment">//这样的结果错误的</span><br><br><span class="hljs-comment">//原因是 在fn2定义的时候 传入参数需要是数组形式[&quot;a&quot;]; args在递归的时候默认是数组</span><br><span class="hljs-keyword">const</span> fn2 = <span class="hljs-title function_">myCurry</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a,b,c</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([a,b,c]);<br>&#125;,[<span class="hljs-string">&quot;a&quot;</span>]); <br></code></pre></div></td></tr></table></figure><h3 id="Q：为什么要在return-myCurry-call-this-fn-args-；这行代码里面写this？">Q：为什么要在<code>return myCurry.call(this,fn,_args)；</code>这行代码里面写this？</h3><p>A：写成<code> this</code> 是因为希望根据环境的不同而设置不同的 <code>this</code> 值，如果写成<code>null</code>的话那么<code>fn</code>函数在调用的时候<code>this</code>始终指向<code>globalThis</code>，而如果<code>fn</code>是<code>obj</code>中的一个方法，则需要将<code>this</code>指向<code>obj</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> fn = <span class="hljs-title function_">curry</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([a, b, c]);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);<br>&#125;);<br><span class="hljs-keyword">const</span> obj =&#123;<br><span class="hljs-attr">value</span>:<span class="hljs-number">1</span>,<br><span class="hljs-attr">fn</span>:fn<br>&#125;<br>obj.<span class="hljs-title function_">fn</span>(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>)(<span class="hljs-string">&quot;c&quot;</span>) <br><br><span class="hljs-comment">// &#123; value: 2, fn: [Function (anonymous)] &#125;</span><br><span class="hljs-comment">// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span><br><br>如果改成<br><span class="hljs-keyword">return</span> myCurry.<span class="hljs-title function_">call</span>(<span class="hljs-literal">null</span>,fn,_args)；<br><span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>,_args);<br>或者不改变<span class="hljs-variable language_">this</span>的指向，直接将_args传入并调用fn，就会违背<span class="hljs-variable language_">this</span>的规则，函数存在缺陷。<br><br><span class="hljs-comment">// globalThis</span><br><span class="hljs-comment">// [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span><br></code></pre></div></td></tr></table></figure><h3 id="终极版">终极版</h3><p><strong>支持占位符</strong></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">curry</span>(<span class="hljs-params">fn, args, holes</span>) &#123;<br>    length = fn.<span class="hljs-property">length</span>;<br>    args = args || [];<br>    holes = holes || [];<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> _args = args.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>),<br>            _holes = holes.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>),<br>            argsLen = args.<span class="hljs-property">length</span>,<br>            holesLen = holes.<span class="hljs-property">length</span>,<br>            arg, i, index = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) &#123;<br>            arg = <span class="hljs-variable language_">arguments</span>[i];<br>            <span class="hljs-comment">// 处理类似 fn(1, _, _, 4)(_, 3) 这种情况，index 需要指向 holes 正确的下标</span><br>            <span class="hljs-keyword">if</span> (arg === _ &amp;&amp; holesLen) &#123;<br>                index++<br>                <span class="hljs-keyword">if</span> (index &gt; holesLen) &#123;<br>                    _args.<span class="hljs-title function_">push</span>(arg);<br>                    _holes.<span class="hljs-title function_">push</span>(argsLen - <span class="hljs-number">1</span> + index - holesLen)<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">// 处理类似 fn(1)(_) 这种情况</span><br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === _) &#123;<br>                _args.<span class="hljs-title function_">push</span>(arg);<br>                _holes.<span class="hljs-title function_">push</span>(argsLen + i);<br>            &#125;<br>            <span class="hljs-comment">// 处理类似 fn(_, 2)(1) 这种情况</span><br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (holesLen) &#123;<br>                <span class="hljs-comment">// fn(_, 2)(_, 3)</span><br>                <span class="hljs-keyword">if</span> (index &gt;= holesLen) &#123;<br>                    _args.<span class="hljs-title function_">push</span>(arg);<br>                &#125;<br>                <span class="hljs-comment">// fn(_, 2)(1) 用参数 1 替换占位符</span><br>                <span class="hljs-keyword">else</span> &#123;<br>                    _args.<span class="hljs-title function_">splice</span>(_holes[index], <span class="hljs-number">1</span>, arg);<br>                    _holes.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                _args.<span class="hljs-title function_">push</span>(arg);<br>            &#125;<br><br>        &#125;<br>        <span class="hljs-keyword">if</span> (_holes.<span class="hljs-property">length</span> || _args.<span class="hljs-property">length</span> &lt; length) &#123;<br>            <span class="hljs-keyword">return</span> curry.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, fn, _args, _holes);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, _args);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> _ = &#123;&#125;;<br><br><span class="hljs-keyword">var</span> fn = <span class="hljs-title function_">curry</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c, d, e</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([a, b, c, d, e]);<br>&#125;);<br><br><span class="hljs-comment">// 验证 输出全部都是 [1, 2, 3, 4, 5]</span><br><span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>);<br><span class="hljs-title function_">fn</span>(_, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)(<span class="hljs-number">1</span>);<br><span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, _, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)(<span class="hljs-number">2</span>);<br><span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, _, <span class="hljs-number">3</span>)(_, <span class="hljs-number">4</span>)(<span class="hljs-number">2</span>)(<span class="hljs-number">5</span>);<br><span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, _, _, <span class="hljs-number">4</span>)(_, <span class="hljs-number">3</span>)(<span class="hljs-number">2</span>)(<span class="hljs-number">5</span>);<br><span class="hljs-title function_">fn</span>(_, <span class="hljs-number">2</span>)(_, _, <span class="hljs-number">4</span>)(<span class="hljs-number">1</span>)(<span class="hljs-number">3</span>)(<span class="hljs-number">5</span>)<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>手写各类数组方法</title>
    <link href="/2022/06/03/%E6%89%8B%E5%86%99%E5%90%84%E7%B1%BB%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95/"/>
    <url>/2022/06/03/%E6%89%8B%E5%86%99%E5%90%84%E7%B1%BB%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="Array-prototype-mySlice"><code>Array.prototype.mySlice()</code></h2><p><strong>手写切片方法</strong></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mySlice</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">start,end</span>)&#123;<br><span class="hljs-keyword">if</span>(start == <span class="hljs-literal">undefined</span>)  start = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>(end == <span class="hljs-literal">undefined</span>) end = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;<br><span class="hljs-keyword">const</span> retArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(end - start);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span> ; i &lt; retArray.<span class="hljs-property">length</span>;i++)&#123;<br><span class="hljs-comment">//为了保证不存在的索引保持为empty值</span><br><span class="hljs-comment">//in在数组中可以来检验是否存在该索引&#x27;1 in arr&#x27;：arr数组是否存在索引为1的元素</span><br><span class="hljs-keyword">if</span>(i <span class="hljs-keyword">in</span> <span class="hljs-variable language_">this</span>)&#123;<br>retArray[i] = <span class="hljs-variable language_">this</span>[start + i];<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> retArray;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>类数组对象如何转化为数组？</title>
    <link href="/2022/06/03/%E7%B1%BB%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E5%A6%82%E4%BD%95%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%95%B0%E7%BB%84/"/>
    <url>/2022/06/03/%E7%B1%BB%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E5%A6%82%E4%BD%95%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%95%B0%E7%BB%84/</url>
    
    <content type="html"><![CDATA[<h1>类数组对象</h1><h2 id="定义-2">定义</h2><p>类数组对象就是含有<code>length</code>属性的对象，但不是数组。通常来可以用<code>index</code>下标来引用元素。</p><p><strong>常见的类数组：</strong></p><ul><li><strong>普通函数中的 argument 对象</strong>。需要注意的是，箭头函数中不存在这个对象。</li><li><strong>一些获取 Dom 集合的方法</strong>，如 <code>document.querySelectorAll()</code>、 <code>document.getElementsByClassName</code>、<code>document.getElementsByTagName() </code>也会返回类数组对象</li></ul><h1>类数组对象如何转化为数组？</h1><h2 id="Array-prototyle-slice-call">Array.prototyle.slice.call()</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(arrlike);<br>[].<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(arrlike);<br></code></pre></div></td></tr></table></figure><p><code>[]</code> 空数组效果同 <code>Array.prototype</code>，因为空数组本身没有 slice 方法，会走原型链拿到 <code>Array.prototype</code> 的方法。</p><p>因为<code>slice</code>方法会返回一个数组，且<code>silce</code>只需要类数组有<code>length</code>属性即可，如果不传入参数，则默认<code>start</code>为0，<code>end</code>为<code>length</code>。</p><h2 id="Array-from">Array.from()</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">arr = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(arrlike);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arrlike);<br></code></pre></div></td></tr></table></figure><p>ES6 新出的方法，可以将类数组对象或者是可迭代对象转换为数组。</p><p>但与<code>Array.prototype.slice</code>不同的是，该方法会将不存在的索引对应的值设置为<code>undefined</code>，而<code>Array.prototype.slice</code>则会设置为<code>empty</code></p>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>手写call、apply和bind</title>
    <link href="/2022/06/01/call%E3%80%81apply%E5%92%8Cbind%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/06/01/call%E3%80%81apply%E5%92%8Cbind%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1>手写call、apply和bind</h1><h2 id="call与apply的特点">call与apply的特点</h2><ul><li>调用 <code>call</code> 和 <code>apply</code> 的函数会立即执行。</li><li><code>call</code> 和 <code>apply</code> 的返回值就是函数的返回值。</li><li>调用 <code>call</code> 和 <code>apply</code> 指向 <code>undefined</code> 或者 <code>null</code> ，会将 <code>this</code> 指向 <code>window</code>。</li><li>调用 <code>call</code> 和 <code>apply</code> 指向一个值类型， 会将 <code>this</code> 指向由它们的构造函数创建的实例。这也就是为什么可以用<code>Object.prototype.toString.call()</code>来判断类型。</li></ul><h2 id="call-和-apply的区别">call 和 apply的区别</h2><blockquote><p>除了传参的形式不同没什么区别。</p></blockquote><p>传给<code>fn</code>的参数写法不同：</p><ul><li><code>call</code> 接收多个参数，第一个为函数上下文也就是 <code>this</code> ，后边参数为函数本身的参数。</li><li><code>apply</code> 接收两个参数，第一个参数为函数上下文 <code>this</code>，第二个参数为函数参数只不过是通过一个 <strong>数组</strong> 的形式传入的。</li></ul><p>只要记住 <code>apply</code> 是以 <code>a</code> 开头，它传给 <code>fun </code>的参数是 <code>Array</code>，也是以 <code>a</code> 开头的，就可以很好的分别这两个函数了。</p><h2 id="手写call">手写call</h2><blockquote><p>我们将模拟的步骤分为：</p><ol><li>将函数设为对象的属性</li><li>执行该函数</li><li>删除该函数</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myCall</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">target, ...args</span>) &#123;<br>  <span class="hljs-keyword">if</span>(target == <span class="hljs-literal">null</span>) target = globalThis;<br>  <span class="hljs-comment">//undefined == null   =&gt; true</span><br>  <span class="hljs-comment">//使用globalThis可以兼容node环境</span><br>  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">&#x27;object&#x27;</span>) target = <span class="hljs-title class_">Object</span>(target);<br>  <span class="hljs-keyword">const</span> key = <span class="hljs-title class_">Symbol</span>();<br>  target[key] = <span class="hljs-variable language_">this</span>;<br>  <span class="hljs-keyword">const</span> result = target[key](...args);<br>  <span class="hljs-keyword">delete</span> target[key];<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>在测试的时候的一点小发现：</strong></p><p>在node.js的环境下无法通过<code>var value = 2</code>这种方法引入全局变量。</p><p>而是直接<code>value = 2</code>或者<code>global.value = 2</code>引入全局变量。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> value1 = <span class="hljs-number">2</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);  <span class="hljs-comment">//undefined</span><br>value2 = <span class="hljs-number">2</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value2);  <span class="hljs-comment">//2</span><br></code></pre></div></td></tr></table></figure><h2 id="手写apply">手写apply</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myApply</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">target, arr</span>) &#123;<br>  <span class="hljs-keyword">if</span> (target == <span class="hljs-literal">null</span>) target = globalThis;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">&#x27;object&#x27;</span>) target = <span class="hljs-title class_">Object</span>(target);<br>  <span class="hljs-keyword">if</span> (!arr) &#123;<br>     <span class="hljs-keyword">const</span> key = <span class="hljs-title class_">Symbol</span>();<br>     target[key] = <span class="hljs-variable language_">this</span>;<br>     <span class="hljs-keyword">const</span> result = target[key]();<br>     <span class="hljs-keyword">delete</span> target[key];<br>     <span class="hljs-keyword">return</span> result;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr)) &#123;<br>     <span class="hljs-keyword">throw</span> <span class="hljs-string">&#x27;Uncaught TypeError: CreateListFromArrayLike called on non-object&#x27;</span>;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>     <span class="hljs-keyword">const</span> args = [];<br>     <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>        args.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;arr[&#x27;</span> + i + <span class="hljs-string">&#x27;]&#x27;</span>);<br>     &#125;<br>     <span class="hljs-keyword">const</span> key = <span class="hljs-title class_">Symbol</span>();<br>     target[key] = <span class="hljs-variable language_">this</span>;<br>     <span class="hljs-keyword">const</span> result = <span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;target[key](&#x27;</span> + args + <span class="hljs-string">&#x27;)&#x27;</span>);<br>     <span class="hljs-keyword">delete</span> target[key];<br>     <span class="hljs-keyword">return</span> result;<br>   &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>在网上寻找了一下自己实现的<code>apply</code>，发现很多人都没有考虑到传入的参数不是数组该如何处理。我先用了<code>Function.prototype.apply</code>尝试了一下，看看如果传入的参数不是数组会发生什么。</p><p><img src="apply%E4%BC%A0%E5%85%A5%E5%8F%82%E6%95%B0%E4%B8%8D%E6%98%AF%E6%95%B0%E7%BB%84.png" alt="apply传入参数不是数组"></p><p>于是我在实现<code>myApply</code>的时候加了一个判断。导致代码量比较大…不知道有没有优化的方案。</p><p><strong>测试代码</strong></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> value = <span class="hljs-number">2</span>;<br><span class="hljs-keyword">var</span> obj = &#123;<br>    <span class="hljs-attr">value</span>: <span class="hljs-number">1</span><br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params">name, age</span>) &#123;<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);<br>   <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,<br>      <span class="hljs-attr">name</span>: name,<br>      <span class="hljs-attr">age</span>: age<br>   &#125;<br>&#125;<br>bar.<span class="hljs-title function_">myApply</span>(<span class="hljs-literal">null</span>); <br>bar.<span class="hljs-title function_">myApply</span>(<span class="hljs-literal">undefined</span>);<br>bar.<span class="hljs-title function_">myApply</span>(obj);<br><br><span class="hljs-comment">// console.log(bar.apply(obj, [&#x27;kevin&#x27;, 18]))</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bar.<span class="hljs-title function_">myApply</span>(obj, [<span class="hljs-string">&#x27;kevin&#x27;</span>, <span class="hljs-number">18</span>]))<br></code></pre></div></td></tr></table></figure><p><strong>测试结果</strong></p><p><img src="%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="测试结果"></p><h2 id="bind的特点">bind的特点</h2><ol><li>传递的第一个参数做为调用它的函数的this指向（bind可传递若干参数）。</li><li>若第一个参数传递基础数据类型，则调用他的函数的this指向该基础数据类型的包装类实例化对象。</li><li>若第一个参数为null或undefined，则调用他的函数的this指向window。</li><li>bind的第二个之后的参数为调用它的函数的参数列表。</li><li>bind方法会返回一个新的方法，并且该方法满足柯里化，仍可以传递参数，但这个方法的this不可被call、apply、bind改变。</li><li>bind方法返回的新方法，如果使用new实例化，那么原本通过bind绑定的this指向的对象会失效，this将指向到新实例化的对象上，且可以使用原方法原型链上的属性或方法。</li></ol><h2 id="bind-和-call-apply-的区别">bind 和 call/apply 的区别</h2><p><strong>是否立刻执行</strong>：</p><ul><li><code>call/apply</code> 改变了函数的 <code>this</code> 上下文后 <strong>马上</strong> 执行该函数。</li><li><code>bind</code> 则是返回改变了上下文后的函数, <strong>不执行该函数</strong> 。</li></ul><p><strong>返回值的区别</strong>:</p><ul><li><code>call/apply</code> 返回 <code>fun</code> 的执行结果。</li><li><code>bind</code> 返回 <code>fun</code> 的拷贝，并指定了 <code>fun</code> 的 <code>this</code> 指向，保存了 <code>fun</code> 的参数。</li></ul><h2 id="手写bind">手写bind</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myBind</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">objThis, ...params</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span> !== <span class="hljs-string">&quot;function&quot;</span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Function.prototype.bind - what is trying to be bound is not callable&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">const</span> self = <span class="hljs-variable language_">this</span>; <br>    <span class="hljs-comment">// 存储源函数以及上方的params(函数参数)</span><br>    <span class="hljs-comment">// 对返回的函数 secondParams 二次传参</span><br>    <span class="hljs-keyword">let</span> fToBind = <span class="hljs-keyword">function</span> (<span class="hljs-params">...secondParams</span>) &#123;<br>    <span class="hljs-keyword">const</span> isNew = <span class="hljs-variable language_">this</span> <span class="hljs-keyword">instanceof</span> fToBind <br>    <span class="hljs-comment">// this是否是fToBind的实例 也就是返回的fToBind是否通过new调用（可以通过new调用也可以直接调用）</span><br>    <span class="hljs-keyword">const</span> context = isNew ? <span class="hljs-variable language_">this</span> : <span class="hljs-title class_">Object</span>(objThis) <br>    <span class="hljs-comment">// new调用就绑定到this上,否则就绑定到传入的objThis上</span><br>    <span class="hljs-keyword">return</span> self.<span class="hljs-title function_">call</span>(context, ...params, ...secondParams); <br>     <span class="hljs-comment">// 用call调用源函数绑定this的指向并传递参数,返回执行结果</span><br>    &#125;;<br>    <span class="hljs-keyword">if</span> (self.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) &#123;<br>    <span class="hljs-comment">// 复制源函数的prototype给fToBind 一些情况下函数没有prototype，比如箭头函数</span><br>        fToBind.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(self.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> fToBind; <span class="hljs-comment">// 返回拷贝的函数</span><br>&#125;;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name, color</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;<br>&#125;<br><br><span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">say</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">`I&#x27;m a <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.color&#125;</span> <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>;<br>&#125;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Cat</span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">myBind</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">&quot;cat&quot;</span>);<br><span class="hljs-comment">//在直接调用的时候this指向null即window</span><br><span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">&quot;white&quot;</span>);<br><span class="hljs-comment">//new一个实例化对象，this指向实例化对象，也就是自己cat</span><br><span class="hljs-keyword">if</span> (<br>  cat.<span class="hljs-title function_">say</span>() === <span class="hljs-string">&quot;I&#x27;m a white cat&quot;</span> &amp;&amp;<br>  cat <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Cat</span> &amp;&amp;<br>  cat <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span><br>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;success&quot;</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>手写new</title>
    <link href="/2022/06/01/new%E6%93%8D%E4%BD%9C%E7%AC%A6/"/>
    <url>/2022/06/01/new%E6%93%8D%E4%BD%9C%E7%AC%A6/</url>
    
    <content type="html"><![CDATA[<h1>new操作符</h1><h2 id="new构造函数时发生了什么？">new构造函数时发生了什么？</h2><ul><li>首先会创建一个空对象，这个新对象的<code>__proto__</code>属性指向构造函数的<code>prototype</code>属性</li><li>此时构造函数执行环境的<code>this</code>指向这个新对象</li><li>执行构造函数中的代码，一般是通过<code>this</code>给新对象添加新的成员属性或方法。</li><li>最后判断这个构造函数是否有返回值，如果有返回值且该返回值为对象的话就等于该返回值，如果没有就返回新对象。</li></ul><h2 id="手写new">手写new</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">func,...args</span>)&#123;<br><span class="hljs-comment">//创建一个新对象，并且指定原型为func.prototype</span><br><span class="hljs-keyword">var</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(func.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);<br><span class="hljs-comment">//让这一次func在执行的时候this指向obj</span><br><span class="hljs-keyword">var</span> ret = func.<span class="hljs-title function_">call</span>(obj,...args);<br><span class="hljs-comment">//看看这个构造函数是否有返回值，如果有返回值且该返回值为对象的话就等于该返回值</span><br><span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> ret === <span class="hljs-string">&#x27;object&#x27;</span> ? ret : obj;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何实现深拷贝与浅拷贝？</title>
    <link href="/2022/05/31/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E4%B8%8E%E6%B5%85%E6%8B%B7%E8%B4%9D/"/>
    <url>/2022/05/31/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E4%B8%8E%E6%B5%85%E6%8B%B7%E8%B4%9D/</url>
    
    <content type="html"><![CDATA[<h1>深拷贝与浅拷贝</h1><h2 id="浅拷贝">浅拷贝</h2><p><img src="%E6%B5%85%E6%8B%B7%E8%B4%9D.png" alt="浅拷贝"></p><blockquote><p>创建一个新对象，这个对象有着原始对象属性值的一份精确拷贝。如果属性是基本类型，拷贝的就是基本类型的值，如果属性是引用类型，拷贝的就是内存地址 ，所以如果其中一个对象改变了这个地址，就会影响到另一个对象。</p></blockquote><h3 id="代码实现">代码实现</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">clone</span>(<span class="hljs-params">target</span>)&#123;<br>    <span class="hljs-keyword">let</span> cloneTarget = &#123;&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> item <span class="hljs-keyword">in</span> target)&#123;<br>        cloneTarget[item] = target[item];<br>    &#125;<br>    <span class="hljs-keyword">return</span> cloneTarget;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="浅拷贝的特点">浅拷贝的特点</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> obj = &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;andy&#x27;</span>,<br><span class="hljs-attr">msg</span>: &#123;<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>    &#125;<br>&#125;<br><span class="hljs-keyword">const</span> o = <span class="hljs-title function_">clone</span>(obj);<br>o.<span class="hljs-property">id</span> =<span class="hljs-number">2</span> ;<br>o.<span class="hljs-property">msg</span>.<span class="hljs-property">age</span> = <span class="hljs-number">19</span>;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">id</span>);                 <span class="hljs-comment">//1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o.<span class="hljs-property">id</span>); <span class="hljs-comment">//2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o.<span class="hljs-property">id</span> === obj.<span class="hljs-property">id</span>); <span class="hljs-comment">//false</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o.<span class="hljs-property">msg</span>.<span class="hljs-property">age</span>); <span class="hljs-comment">//19</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">msg</span>.<span class="hljs-property">age</span>); <span class="hljs-comment">//19</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o.<span class="hljs-property">msg</span> === obj.<span class="hljs-property">msg</span>); <span class="hljs-comment">//true</span><br><br>obj.<span class="hljs-property">msg</span>.<span class="hljs-property">age</span> = <span class="hljs-number">20</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o.<span class="hljs-property">msg</span>.<span class="hljs-property">age</span>); <span class="hljs-comment">//20</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">msg</span>.<span class="hljs-property">age</span>); <span class="hljs-comment">//20</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o.<span class="hljs-property">msg</span> === obj.<span class="hljs-property">msg</span>); <span class="hljs-comment">//true</span><br></code></pre></div></td></tr></table></figure><p>不难发现，如果是基本数据类型，浅拷贝拷贝的是值，如果进行修改不会影响原有对象。如果是引用类型，拷贝的就是内存地址 ，所以如果其中一个对象改变了这个地址，就会影响到另一个对象。</p><h2 id="对象赋值">对象赋值</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> obj = &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;andy&#x27;</span>,<br><span class="hljs-attr">msg</span>: &#123;<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>    &#125;<br>&#125;<br><span class="hljs-keyword">let</span> obj2 = obj;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj2.<span class="hljs-property">id</span>);<span class="hljs-comment">//1</span><br><br>obj2.<span class="hljs-property">id</span> = <span class="hljs-number">3</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj2.<span class="hljs-property">id</span>);<span class="hljs-comment">//3</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">id</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj2.<span class="hljs-property">id</span> === obj.<span class="hljs-property">id</span>);<span class="hljs-comment">//ture</span><br></code></pre></div></td></tr></table></figure><p>当我们把一个对象赋值给一个新的变量时，<strong>赋的其实是该对象的在栈中的地址，而不是堆中的数据</strong>。也就是两个对象指向的是同一个存储空间，无论哪个对象发生改变，其实都是改变的存储空间的内容，因此，两个对象是联动的。因此无论是基础数据类型还是引用数据类型，当其中一个对象的某个属性发生改变时，另一个对象的该属性都会发生改变。</p><h2 id="深拷贝">深拷贝</h2><p><img src="%E6%B7%B1%E6%8B%B7%E8%B4%9D.png" alt="深拷贝"></p><blockquote><p>将一个对象从内存中完整的拷贝一份出来,从堆内存中开辟一个新的区域存放新对象,且修改新对象不会影响原对象</p></blockquote><h3 id="代码实现-2">代码实现</h3><h4 id="破产版（递归实现）">破产版（递归实现）</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">target</span>)&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> target === <span class="hljs-string">&#x27;object&#x27;</span>)&#123;<br><span class="hljs-keyword">let</span> cloneTarget = &#123;&#125;;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> target)&#123;<br>cloneTarget[key] = <span class="hljs-title function_">clone</span>(target[key]);<br>&#125;<br><span class="hljs-keyword">return</span> cloneTarget;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">return</span> target;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>但破产版存在许多问题比如</p><h4 id="1-没有考虑引用对象中的数组的解决方案">1.没有考虑引用对象中的数组的解决方案</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">target</span>)&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> target === <span class="hljs-string">&#x27;object&#x27;</span>)&#123;<br><span class="hljs-keyword">let</span> cloneTarget = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target)? [] : &#123;&#125;;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> target)&#123;<br>cloneTarget[key] = <span class="hljs-title function_">clone</span>(target[key]);<br>&#125;<br><span class="hljs-keyword">return</span> cloneTarget;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">return</span> target;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="2-循环引用的解决方案">2.循环引用的解决方案</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> target = &#123;<br>    <span class="hljs-attr">field1</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">field2</span>: <span class="hljs-literal">undefined</span>,<br>    <span class="hljs-attr">field3</span>: &#123;<br>        <span class="hljs-attr">child</span>: <span class="hljs-string">&#x27;child&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">field4</span>: [<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>]<br>&#125;;<br>target.<span class="hljs-property">target</span> = target;<br></code></pre></div></td></tr></table></figure><p>直接使用1中给出的<code>deepClone</code>函数会导致栈溢出。</p><p>这是因为上面的对象存在循环引用的情况，即对象的属性直接或间接引用了自身。</p><p>Q：<strong>如何解决这个问题？</strong></p><p>A：我们可以额外开辟一个存储空间，来存储当前对象和拷贝对象的对应关系，当需要拷贝当前对象时，先去存储空间中找，有没有拷贝过这个对象，如果有的话直接返回，如果没有的话继续拷贝。</p><p>因为这个存储空间需要存储key-value的形式，且key需要是一个引用对象，而Object只能使用数值、字符串或者symbol作为key，而Map可以使用任何Javascript数据类型作为key值。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">target,map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> target === <span class="hljs-string">&#x27;object&#x27;</span>)&#123;<br>        <span class="hljs-keyword">let</span> cloneTarget = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target)? [] : &#123;&#125;;<br>        <span class="hljs-keyword">if</span>(map.<span class="hljs-title function_">get</span>(target))&#123;<br>            <span class="hljs-keyword">return</span> map.<span class="hljs-title function_">get</span>(target);<br>            <span class="hljs-comment">//看看map中有没有被克隆过的对象，如果有就直接返回。</span><br>            <span class="hljs-comment">//因为第一次克隆target.target的时候就已经把整个target放进map中</span><br>        &#125;<br>        map.<span class="hljs-title function_">set</span>(target,cloneTarget);<br>        <span class="hljs-comment">//如果没有clone过就把当前对象作为key，克隆对象作为value进行存储</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> target)&#123;<br>            cloneTarget[key] = <span class="hljs-title function_">deepClone</span>(target[key],map);<br>        &#125;<br>        <span class="hljs-keyword">return</span> cloneTarget;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> target;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="3-拷贝对象比较大解决方案">3.拷贝对象比较大解决方案</h4><p>使用<code>weakMap</code></p><blockquote><p>WeakMap 对象是一组键/值对的集合，其中的key是弱映射的。其键必须是Object或者继承自Object的类型，而值可以是任意的。如果尝试使用非对象设置key会抛出TypeError。</p></blockquote><p>如果我们要拷贝的对象非常庞大时，使用<code>Map</code>会对内存造成非常大的额外消耗，而且我们需要手动清除<code>Map</code>的属性才能释放这块内存，而<code>WeakMap</code>会帮我们巧妙化解这个问题。</p><h3 id="破产版优化结果">破产版优化结果</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">target,map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>()</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> target === <span class="hljs-string">&#x27;object&#x27;</span>)&#123;<br>        <span class="hljs-keyword">let</span> cloneTarget = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target)? [] : &#123;&#125;;<br>        <span class="hljs-keyword">if</span>(map.<span class="hljs-title function_">get</span>(target))&#123;<br>            <span class="hljs-keyword">return</span> map.<span class="hljs-title function_">get</span>(target);<br>            <span class="hljs-comment">//看看map中有没有被克隆过的对象，如果有就直接返回。</span><br>            <span class="hljs-comment">//因为第一次克隆target.target的时候就已经把整个target放进map中</span><br>        &#125;<br>        map.<span class="hljs-title function_">set</span>(target,cloneTarget);<br>        <span class="hljs-comment">//如果没有clone过就把当前对象作为key，克隆对象作为value进行存储</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> target)&#123;<br>            cloneTarget[key] = <span class="hljs-title function_">deepClone</span>(target[key],map);<br>        &#125;<br>        <span class="hljs-keyword">return</span> cloneTarget;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> target;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="终极版（处理各种数据结果）">终极版（处理各种数据结果）</h3><h4 id="合理的判断引用类型">合理的判断引用类型</h4><p>需要我们合理的判断是否为引用类型需要考虑到<code>function</code>和<code>null</code>，因为typeof判断类型存在缺陷。</p><p>我们需要自己封装一个函数。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isObject</span>(<span class="hljs-params">target</span>)&#123;<br><span class="hljs-keyword">const</span> type = <span class="hljs-keyword">typeof</span> target;<br><span class="hljs-keyword">return</span> target !== <span class="hljs-literal">null</span> &amp;&amp; (type === <span class="hljs-string">&#x27;object&#x27;</span> || type === <span class="hljs-string">&#x27;function&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// if(typeof target === &#x27;object&#x27;)  改成  if(isObject(target))</span><br></code></pre></div></td></tr></table></figure><h4 id="获取可继续遍历对象的具体数据类型">获取可继续遍历对象的具体数据类型</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getType</span>(<span class="hljs-params">target</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(target);<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="抽离出具体数据类型">抽离出具体数据类型</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> mapTag = <span class="hljs-string">&#x27;[object Map]&#x27;</span>;<br><span class="hljs-keyword">const</span> setTag = <span class="hljs-string">&#x27;[object Set]&#x27;</span>;<br><span class="hljs-keyword">const</span> arrayTag = <span class="hljs-string">&#x27;[object Array]&#x27;</span>;<br><span class="hljs-keyword">const</span> objectTag = <span class="hljs-string">&#x27;[object Object]&#x27;</span>;<br><span class="hljs-keyword">const</span> argsTag = <span class="hljs-string">&#x27;[object Arguments]&#x27;</span>;<br><br><span class="hljs-keyword">const</span> boolTag = <span class="hljs-string">&#x27;[object Boolean]&#x27;</span>;<br><span class="hljs-keyword">const</span> dateTag = <span class="hljs-string">&#x27;[object Date]&#x27;</span>;<br><span class="hljs-keyword">const</span> errorTag = <span class="hljs-string">&#x27;[object Error]&#x27;</span>;<br><span class="hljs-keyword">const</span> numberTag = <span class="hljs-string">&#x27;[object Number]&#x27;</span>;<br><span class="hljs-keyword">const</span> regexpTag = <span class="hljs-string">&#x27;[object RegExp]&#x27;</span>;<br><span class="hljs-keyword">const</span> stringTag = <span class="hljs-string">&#x27;[object String]&#x27;</span>;<br><span class="hljs-keyword">const</span> symbolTag = <span class="hljs-string">&#x27;[object Symbol]&#x27;</span>;<br><br><span class="hljs-keyword">const</span> deepTag = [mapTag,setTag,arrayTag,objectTag,argsTag];<br><span class="hljs-comment">//把可继续遍历的数据类型放入数组</span><br></code></pre></div></td></tr></table></figure><h4 id="考虑symbol">考虑<code>symbol()</code></h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">cloneSymbol</span>(<span class="hljs-params">target</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>(<span class="hljs-title class_">Symbol</span>(target.<span class="hljs-property">description</span>));<br>&#125;<br><span class="hljs-comment">//return Object(Symbol.prototype.valueOf.call(target)); </span><br><span class="hljs-comment">//也有人这样写，不是很明白，先留个坑</span><br></code></pre></div></td></tr></table></figure><h4 id="考虑function">考虑<code>function</code></h4><p>实际上克隆函数是没有实际应用场景的，两个对象使用一个在内存中处于同一个地址的函数也是没有任何问题的。</p><p>首先，我们可以通过<code>prototype</code>来区分下箭头函数和普通函数，箭头函数是没有<code>prototype</code>的。</p><p>我们可以直接使用<code>eval</code>和函数字符串来重新生成一个箭头函数，注意这种方法是不适用于普通函数的。</p><p>我们可以使用正则来处理普通函数：</p><p>分别使用正则取出函数体和函数参数，然后使用<code>new Function ([arg1[, arg2[, ...argN]],] functionBody)</code>构造函数重新构造一个新的函数：</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">cloneFunction</span>(<span class="hljs-params">func</span>) &#123;<br>    <span class="hljs-keyword">const</span> bodyReg = <span class="hljs-regexp">/(?&lt;=&#123;)(.|\n)+(?=&#125;)/m</span>;<br>    <span class="hljs-keyword">const</span> paramReg = <span class="hljs-regexp">/(?&lt;=\().+(?=\)\s+&#123;)/</span>;<br>    <span class="hljs-keyword">const</span> funcString = func.<span class="hljs-title function_">toString</span>();<br>    <span class="hljs-keyword">if</span> (func.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) &#123;<br>        <span class="hljs-keyword">const</span> param = paramReg.<span class="hljs-title function_">exec</span>(funcString);<br>        <span class="hljs-keyword">const</span> body = bodyReg.<span class="hljs-title function_">exec</span>(funcString);<br>        <span class="hljs-keyword">if</span> (body) &#123;<br>            <span class="hljs-keyword">if</span> (param) &#123;<br>                <span class="hljs-keyword">const</span> paramArr = param[<span class="hljs-number">0</span>].<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(...paramArr, body[<span class="hljs-number">0</span>]);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(body[<span class="hljs-number">0</span>]);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>(funcString);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="终极版优化结果">终极版优化结果</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> mapTag = <span class="hljs-string">&#x27;[object Map]&#x27;</span>;<br><span class="hljs-keyword">const</span> setTag = <span class="hljs-string">&#x27;[object Set]&#x27;</span>;<br><span class="hljs-keyword">const</span> arrayTag = <span class="hljs-string">&#x27;[object Array]&#x27;</span>;<br><span class="hljs-keyword">const</span> objectTag = <span class="hljs-string">&#x27;[object Object]&#x27;</span>;<br><span class="hljs-keyword">const</span> argsTag = <span class="hljs-string">&#x27;[object Arguments]&#x27;</span>;<br><br><span class="hljs-keyword">const</span> boolTag = <span class="hljs-string">&#x27;[object Boolean]&#x27;</span>;<br><span class="hljs-keyword">const</span> dateTag = <span class="hljs-string">&#x27;[object Date]&#x27;</span>;<br><span class="hljs-keyword">const</span> errorTag = <span class="hljs-string">&#x27;[object Error]&#x27;</span>;<br><span class="hljs-keyword">const</span> numberTag = <span class="hljs-string">&#x27;[object Number]&#x27;</span>;<br><span class="hljs-keyword">const</span> regexpTag = <span class="hljs-string">&#x27;[object RegExp]&#x27;</span>;<br><span class="hljs-keyword">const</span> stringTag = <span class="hljs-string">&#x27;[object String]&#x27;</span>;<br><span class="hljs-keyword">const</span> symbolTag = <span class="hljs-string">&#x27;[object Symbol]&#x27;</span>;<br><br><span class="hljs-keyword">const</span> deepTag = [mapTag,setTag,arrayTag,objectTag,argsTag];<br><span class="hljs-comment">//把可继续遍历的数据类型放入数组</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">forEach</span>(<span class="hljs-params">array,iteratee</span>)&#123;<br>    <span class="hljs-keyword">let</span> index = -<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">const</span> length = array.<span class="hljs-property">length</span>;<br>    <span class="hljs-keyword">while</span>(++index &lt; length)&#123;<br>        <span class="hljs-title function_">iteratee</span>(array[index],index);<br>    &#125;<br>    <span class="hljs-keyword">return</span> array;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">isObject</span>(<span class="hljs-params">target</span>)&#123;<br>    <span class="hljs-keyword">const</span> type = typeop target;<br>    <span class="hljs-keyword">return</span> target !== <span class="hljs-literal">null</span> &amp;&amp;(type === <span class="hljs-string">&#x27;object&#x27;</span> || type === <span class="hljs-string">&#x27;function&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getType</span>(<span class="hljs-params">target</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(target);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getInit</span>(<span class="hljs-params">target</span>)&#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Ctor</span> = target.<span class="hljs-property">constructor</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Ctor</span>();<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">cloneSymbol</span>(<span class="hljs-params">target</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>(<span class="hljs-title class_">Symbol</span>(target.<span class="hljs-property">description</span>));<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">cloneFunction</span>(<span class="hljs-params">func</span>) &#123;<br>    <span class="hljs-keyword">const</span> bodyReg = <span class="hljs-regexp">/(?&lt;=&#123;)(.|\n)+(?=&#125;)/m</span>;<br>    <span class="hljs-keyword">const</span> paramReg = <span class="hljs-regexp">/(?&lt;=\().+(?=\)\s+&#123;)/</span>;<br>    <span class="hljs-keyword">const</span> funcString = func.<span class="hljs-title function_">toString</span>();<br>    <span class="hljs-keyword">if</span> (func.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) &#123;<br>        <span class="hljs-keyword">const</span> param = paramReg.<span class="hljs-title function_">exec</span>(funcString);<br>        <span class="hljs-keyword">const</span> body = bodyReg.<span class="hljs-title function_">exec</span>(funcString);<br>        <span class="hljs-keyword">if</span> (body) &#123;<br>            <span class="hljs-keyword">if</span> (param) &#123;<br>                <span class="hljs-keyword">const</span> paramArr = param[<span class="hljs-number">0</span>].<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(...paramArr, body[<span class="hljs-number">0</span>]);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(body[<span class="hljs-number">0</span>]);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">eval</span>(funcString);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">cloneReg</span>(<span class="hljs-params">target</span>)&#123;<br>    <span class="hljs-keyword">const</span> reFlags = <span class="hljs-regexp">/\w*$/</span>;<br>    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">new</span> target.<span class="hljs-title function_">constructor</span>(<span class="hljs-params">target.source,reFalgs.exec(target)</span>);<br>    result.<span class="hljs-property">lastIndex</span> = target.<span class="hljs-property">lastIndex</span>;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">cloneOtherType</span>(<span class="hljs-params">target,type</span>)&#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Ctor</span> = target.<span class="hljs-property">constructor</span>;<br>    <span class="hljs-keyword">switch</span>(type)&#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-attr">boolTag</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-attr">numberTag</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-attr">stringTag</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-attr">errorTag</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-attr">dateTag</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Ctor</span>(target);<br>        <span class="hljs-keyword">case</span> <span class="hljs-title function_">regexpTag</span>(target):<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">cloneReg</span>(target);<br>        <span class="hljs-keyword">case</span> <span class="hljs-attr">symbolTag</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">cloneSymbol</span>(target);<br>        <span class="hljs-keyword">case</span> <span class="hljs-attr">funcTag</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">cloneFunction</span>(target);<br>        <span class="hljs-attr">default</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">clone</span>(<span class="hljs-params">target,map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>()</span>)&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_">isObject</span>(target))&#123;<br>        <span class="hljs-keyword">return</span> target;<br>    &#125;<br>    <br>    <span class="hljs-keyword">const</span> type = <span class="hljs-title function_">getType</span>(target);<br>    <span class="hljs-keyword">let</span> cloneTarget;<br>    <span class="hljs-keyword">if</span>(deepTag.<span class="hljs-title function_">includes</span>(type))&#123;<br>        cloneTarget = <span class="hljs-title function_">getInit</span>(target,type);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">cloneOtherTpye</span>(target,type);<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span>(map.<span class="hljs-title function_">get</span>(target))&#123;<br>        <span class="hljs-keyword">return</span> target;<br>    &#125;<br>    map.<span class="hljs-title function_">set</span>(target,cloneTarget);<br>    <br>    <span class="hljs-keyword">if</span>(type === setTag)&#123;<br>        target.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span>&#123;<br>            cloneTarget.<span class="hljs-title function_">add</span>(<span class="hljs-title function_">clone</span>(value));<br>        &#125;);<br>        <span class="hljs-keyword">return</span> cloneTarget;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span>(type === setTag) &#123;<br>        target.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;<br>            cloneTarget.<span class="hljs-title function_">add</span>(<span class="hljs-title function_">clone</span>(value));<br>        &#125;);<br>        <span class="hljs-keyword">return</span> cloneTarget;<br> &#125;<br>    <br>    <span class="hljs-keyword">if</span>(type === mapTag)&#123;<br>        target.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value,key</span>)=&gt;</span>&#123;<br>            cloneTarget.<span class="hljs-title function_">set</span>(key,<span class="hljs-title function_">clone</span>(value));<br>        &#125;);<br>        <span class="hljs-keyword">return</span> cloneTarget;<br>    &#125;<br>    <br>    <span class="hljs-keyword">const</span> keys = type === arrTag ? <span class="hljs-literal">undefined</span> : <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(target);<br>    <span class="hljs-title function_">forEach</span>(keys || target,<span class="hljs-function">(<span class="hljs-params">value,key</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span>(keys) &#123;<br>            key = value;<br>        &#125;<br>        cloneTarget[key] = <span class="hljs-title function_">clone</span>(target[key],map);<br>    &#125;);<br>    <br>    <span class="hljs-keyword">return</span> cloneTarget;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>instanceof和typeof有什么区别？</title>
    <link href="/2022/05/31/instanceof%E5%92%8Ctypeof/"/>
    <url>/2022/05/31/instanceof%E5%92%8Ctypeof/</url>
    
    <content type="html"><![CDATA[<h1>探讨<code>instanceof</code>和<code>typeof</code></h1><h2 id="typeof"><code>typeof</code></h2><p>先来看看这些语句的结果</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-string">&#x27;bitter-gourd&#x27;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-number">123</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-number">123n</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> []);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> &#123;&#125;);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Symbol</span>());<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">true</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&#x27;xxx&#x27;</span>)); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">null</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">undefined</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">typeof</span>(<span class="hljs-function">()=&gt;</span>&#123;&#125;));<br></code></pre></div></td></tr></table></figure><p>结果如下：</p><p><img src="typeof%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="测试结果"></p><p>通过以上例子可以看出，<code>typeof</code>只能准确判断原始数据类型和函数（函数其实是对象，并不属于另一种数据类型，但也能够使用 <code>typeof </code>进行区分），但无法精确判断出引用数据类型。</p><p>有一点需要注意，调用<code>typeof null</code>返回的是<code>object</code>，这是因为特殊值<code>null</code>被认为是一个对空对象的引用（也叫空对象指针）。</p><h3 id="typeof的实现原理"><code>typeof</code>的实现原理</h3><p>其实，javascript在底层存储变量的时候，会在变量的机器码的低位1-3位存储其类型信息</p><ul><li>000：对象</li><li>010：浮点数</li><li>100：字符串</li><li>110：布尔</li><li>1：整数</li></ul><p>但对于 <code>undefined</code> 和 <code>null</code> 来说，这两个值的信息存储是有点特殊的。</p><p><code>null</code>：所有机器码均为0</p><p><code>undefined</code>：用 −2^30 整数来表示</p><p>由于 <code>null</code> 的所有机器码均为0，因此直接被当做了对象来看待。</p><h2 id="instanceof"><code>instanceof</code></h2><p><code>instanceof</code>运算符返回一个布尔值，可以用于检测构造函数的 <code>prototype</code> 属性是否出现在某个实例对象的原型链上，也就是用于判断某个实例是否属于某构造函数。更规范的说法是，<strong>只要右边变量的<code>prototype</code>在左边变量的原型链上就返回 true，否则返回 false。</strong></p><h4 id="instanceof的实现原理"><code>instanceof的实现原理</code></h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Myinstanceof</span>(<span class="hljs-params">leftVaule, rightVaule</span>) &#123; <br>    <span class="hljs-keyword">let</span> rightProto = rightVaule.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>; <span class="hljs-comment">// 取右表达式的 prototype 值</span><br>    leftVaule = leftVaule.<span class="hljs-property">__proto__</span>; <span class="hljs-comment">// 取左表达式的__proto__值</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>    <span class="hljs-keyword">if</span> (leftVaule === <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (leftVaule === rightProto) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125; <br>        leftVaule = leftVaule.<span class="hljs-property">__proto__</span> <br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="instanceof与typeof的区别"><code>instanceof</code>与<code>typeof</code>的区别</h2><ul><li><code>typeof</code>会返回一个运算数的基本类型，<code>instanceof</code>返回的是布尔值</li><li><code>instanceof</code>可以准确判断引用数据类型，但是不能正确判断原始数据类型</li><li><code>typeof</code>虽然可以判断原始数据类型（null 除外），但是无法判断引用数据类型（function 除外）。</li></ul><h2 id="Object-prototype-toString"><code>Object.prototype.toString</code></h2><p><code>instanceof</code> 也可能判断不准确，比如一个数组，他可以被 <code>instanceof</code> 判断为 Object。所以我们要想比较准确的判断对象实例的类型时，可以采取 <code>Object.prototype.toString.call</code> 方法。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-number">123</span>) <span class="hljs-comment">// &quot;[object Number]&quot;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-string">&#x27;bitter-gourd&#x27;</span>) <span class="hljs-comment">// &quot;[object String]&quot;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(&#123;<span class="hljs-attr">age</span>:<span class="hljs-string">&#x27;19&#x27;</span>&#125;) <span class="hljs-comment">// &quot;[object Object]&quot;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>([<span class="hljs-number">123</span>,<span class="hljs-string">&#x27;bitter-gourd&#x27;</span>]) <span class="hljs-comment">// &quot;[object Array]&quot;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-literal">true</span>) <span class="hljs-comment">// &quot;[object Boolean]&quot;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-function">() =&gt;</span> &#123;&#125;) <span class="hljs-comment">// &quot;[object Function]&quot;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-literal">null</span>) <span class="hljs-comment">// &quot;[object Null]&quot;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-literal">undefined</span>) <span class="hljs-comment">// &quot;[object Undefined]&quot;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-title class_">Symbol</span>(<span class="hljs-number">1</span>)) <span class="hljs-comment">// &quot;[object Symbol]&quot;</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>知识点清单</title>
    <link href="/2022/05/31/%E7%9F%A5%E8%AF%86%E7%82%B9%E6%B1%87%E6%80%BB/"/>
    <url>/2022/05/31/%E7%9F%A5%E8%AF%86%E7%82%B9%E6%B1%87%E6%80%BB/</url>
    
    <content type="html"><![CDATA[<h1>前端</h1><h2 id="JavaScript">JavaScript</h2><ul><li>[x] 原型链</li><li>[x] 继承（备注：没有笔记产出，因为红宝书上写的太赞了）</li><li>[ ] 作用域</li><li>[ ] 闭包</li><li>[ ] 变量提升</li><li>[ ] 上下文</li><li>[x] <code>this</code>指向（备注：this真是太难了！）</li><li>[ ] 立即执行函数</li><li>[x] <code>instanceof</code>和<code>typeof</code></li><li>[x] 手写<code>apply</code>、<code>call</code>和<code>bind</code>（备注：bind理解较差）</li><li>[ ] 事件循环机制</li><li>[x] <code>Ajax</code></li><li>[x] <code>promise</code></li><li>[x] 柯里化（备注：存在占位符情况理解较差）</li><li>[x] 手写<code>new</code>操作符</li><li>[x] 深拷贝、浅拷贝</li></ul><h3 id="数组方法">数组方法</h3><ul><li>[x] 手写<code>reduce</code></li><li>[x] 用<code>reduce</code>实现<code>map</code></li><li>[ ] 手写<code>concat</code></li><li>[x] 手写<code>slice</code></li><li>[ ] 手写<code>splice</code></li><li>[ ] 手写<code>indexOf</code>(字符串方法)</li><li>[x] 类数组转化为数组</li></ul><h3 id="TypeScript">TypeScript</h3><h2 id="CSS-3">CSS</h2><ul><li>[ ] <code>BFC</code></li><li>[ ] <code>position</code></li><li>[ ] <code>flex</code>布局</li><li>[x] <code>css</code>权重</li><li>[x] <code>CSS</code>选择器</li><li>[x] 盒子模型</li><li>[x] 双飞翼、圣杯布局</li><li>[ ] <code>CSS3</code>新特性</li><li>[x] <code>div</code>居中</li><li>[ ] 浮动</li><li>[x] CSS的长度单位</li><li>[x] CSS变量</li></ul><h3 id="一些效果">一些效果</h3><ul><li>[ ] CSS画三角形</li><li>[ ] 前端水印</li><li>[ ] 毛玻璃效果</li><li>[ ] 打字效果</li></ul><h2 id="HTML">HTML</h2><ul><li>[ ] 行内元素、块级元素</li><li>[ ] DOM树</li><li>[ ] 事件模型</li><li>[ ] 缓存策略</li></ul><h2 id="浏览器">浏览器</h2><ul><li>[x] 存储方式比较（cookie、localStorage、sessionStorage）</li><li>[ ] 浏览器渲染机制</li></ul><h2 id="前端安全">前端安全</h2><ul><li>[ ] XSS攻击</li></ul><h1>框架</h1><h2 id="vue">vue</h2><ul><li>[ ] 数据绑定原理</li><li>[ ] <code>computed</code>和<code>watch</code></li><li>[ ] <code>slot</code></li><li>[ ] <code>next tick</code>原理</li><li>[ ] <code>keep alive</code></li></ul><h2 id="react">react</h2><h2 id="Redux">Redux</h2><h1>算法</h1><h1>后端</h1><h2 id="Node">Node</h2><ul><li>[ ] 模块机制</li><li>[ ] require原理</li><li>[ ] 事件循环</li><li>[ ] cluster原理</li><li>[ ] 流机制</li><li>[ ] pipe原理</li><li>[ ] 守护进程</li><li>[ ] 进程通信</li><li>[ ] 异常处理</li></ul><h2 id="计算机网络">计算机网络</h2>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>圣杯布局和双飞翼布局</title>
    <link href="/2022/05/29/%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80%E5%92%8C%E5%8F%8C%E9%A3%9E%E7%BF%BC%E5%B8%83%E5%B1%80/"/>
    <url>/2022/05/29/%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80%E5%92%8C%E5%8F%8C%E9%A3%9E%E7%BF%BC%E5%B8%83%E5%B1%80/</url>
    
    <content type="html"><![CDATA[<h1>圣杯布局和双飞翼布局</h1><h3 id="圣杯布局">圣杯布局</h3><p><img src="%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80.png" alt="圣杯布局"></p><h4 id="html"><code>html</code></h4><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>头部<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>主区域<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;left&quot;</span>&gt;</span>左区域<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;right&quot;</span>&gt;</span>右区域<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span>底部<span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h4 id="CSS"><code>CSS</code></h4><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">footer</span>,<br>    <span class="hljs-selector-tag">header</span> &#123;<br>      <span class="hljs-attribute">background-color</span>: aliceblue;<br>      <span class="hljs-attribute">text-align</span>: center;<br>      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">30px</span>;<br>      <span class="hljs-attribute">font-weight</span>: bolder;<br>      <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;<br>      <span class="hljs-attribute">line-height</span>: <span class="hljs-number">100px</span>;<br>      <span class="hljs-comment">/*line-height设置成与height一样可以让文字垂直居中*/</span><br>    &#125;<br><br>    <span class="hljs-selector-tag">header</span> &#123;<br>      <span class="hljs-attribute">background-color</span>: antiquewhite;<br>    &#125;<br><br>    <span class="hljs-comment">/* 设置浮动 */</span><br>    <span class="hljs-selector-class">.center</span>,<br>    <span class="hljs-selector-class">.left</span>,<br>    <span class="hljs-selector-class">.right</span> &#123;<br>      <span class="hljs-attribute">float</span>: left;<br>    &#125;<br><br>    <span class="hljs-comment">/*伪类元素解决浮动带来的塌陷问题 */</span><br>    <span class="hljs-selector-class">.container</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>      <span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;&quot;</span>;<br>      <span class="hljs-attribute">display</span>: block;<br>      <span class="hljs-attribute">clear</span>: both;  <br>      <span class="hljs-comment">/*clear:both的作用是让伪类元素到container下面而不是右边*/</span><br>    &#125;<br><br>    <span class="hljs-comment">/*设置container的padding值以便放置左右盒子*/</span><br>    <span class="hljs-selector-class">.container</span> &#123;<br>      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">300px</span> <span class="hljs-number">0</span> <span class="hljs-number">200px</span>;<br>      <span class="hljs-comment">/*overflow: hidden; 这样也可以解决高度塌陷的问题*/</span><br>    &#125;<br><br>    <span class="hljs-selector-class">.right</span>,<br>    <span class="hljs-selector-class">.center</span>,<br>    <span class="hljs-selector-class">.left</span> &#123;<br>      <span class="hljs-attribute">height</span>: <span class="hljs-number">250px</span>;<br>      <span class="hljs-attribute">line-height</span>: <span class="hljs-number">250px</span>;<br>      <span class="hljs-attribute">text-align</span>:center;<br>      <span class="hljs-attribute">position</span>:relative;  <br>      <span class="hljs-comment">/*开启相对定位是为了让左右盒子到container的padding的位置*/</span><br>    &#125;<br><br>    <span class="hljs-comment">/* 设置左区域的左外边距为-100% */</span><br>    <span class="hljs-selector-class">.left</span> &#123;<br>      <span class="hljs-attribute">left</span>:-<span class="hljs-number">200px</span>;<br>      <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;<br>      <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">192</span>, <span class="hljs-number">149</span>, <span class="hljs-number">232</span>);<br>      <span class="hljs-attribute">margin-left</span>:-<span class="hljs-number">100%</span>;  <br>      <span class="hljs-comment">/*这里的100%对应的百分比是left左边的那个盒子即center的宽度*/</span><br>    &#125;<br>    <span class="hljs-selector-class">.right</span> &#123;<br>      <span class="hljs-attribute">right</span>:-<span class="hljs-number">300px</span>;<br>      <span class="hljs-attribute">margin-left</span>:-<span class="hljs-number">300px</span>;   <br>      <span class="hljs-comment">/*这里的-300px是right往左边移动自身宽度像素使自己刚刚放进center内*/</span><br>      <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;       <br>      <span class="hljs-attribute">background-color</span>:<span class="hljs-built_in">rgb</span>(<span class="hljs-number">82</span>, <span class="hljs-number">82</span>, <span class="hljs-number">152</span>);<br>    &#125;<br>    <span class="hljs-selector-class">.center</span>&#123;<br>      <span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;<br>      <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">165</span>, <span class="hljs-number">241</span>, <span class="hljs-number">216</span>);<br>    &#125;<br></code></pre></div></td></tr></table></figure><h3 id="双飞翼布局">双飞翼布局</h3><p><img src="%E5%8F%8C%E9%A3%9E%E7%BF%BC%E5%B8%83%E5%B1%80.png" alt="双飞翼布局"></p><h4 id="html-2"><code>html</code></h4><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>头部<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;center-inner&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;left&quot;</span>&gt;</span>左区域<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;right&quot;</span>&gt;</span>右区域<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span>底部<span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h4 id="CSS-2"><code>CSS</code></h4><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">footer</span>,<br><span class="hljs-selector-tag">header</span> &#123;<br>  <span class="hljs-attribute">background-color</span>: aliceblue;<br>  <span class="hljs-attribute">text-align</span>: center;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">30px</span>;<br>  <span class="hljs-attribute">font-weight</span>: bolder;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;<br>  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">100px</span>;<br>  <span class="hljs-comment">/*line-height设置成与height一样可以让文字垂直居中*/</span><br>&#125;<br><br><span class="hljs-selector-tag">header</span> &#123;<br>  <span class="hljs-attribute">background-color</span>: antiquewhite;<br>&#125;<br><br><span class="hljs-comment">/* 设置浮动 */</span><br><span class="hljs-selector-class">.center</span>,<br><span class="hljs-selector-class">.left</span>,<br><span class="hljs-selector-class">.right</span> &#123;<br>  <span class="hljs-attribute">float</span>: left;<br>&#125;<br><br><span class="hljs-comment">/* 伪类元素解决浮动带来的塌陷问题*/</span><br><span class="hljs-selector-class">.container</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>  <span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;&quot;</span>;<br>  <span class="hljs-attribute">display</span>: block;<br>  <span class="hljs-attribute">clear</span>: both;  <br>  <span class="hljs-comment">/*clear:both的作用是让伪类元素到container下面而不是右边*/</span><br>&#125; <br><br><span class="hljs-selector-class">.right</span>,<br><span class="hljs-selector-class">.center</span>,<br><span class="hljs-selector-class">.left</span> &#123;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">250px</span>;<br>  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">250px</span>;<br>  <span class="hljs-attribute">text-align</span>:center;<br>&#125;<br><br><span class="hljs-comment">/* 设置左区域的左外边距为-100% */</span><br><span class="hljs-selector-class">.left</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;<br>  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">192</span>, <span class="hljs-number">149</span>, <span class="hljs-number">232</span>);<br>  <span class="hljs-attribute">margin-left</span>:-<span class="hljs-number">100%</span>;  <br>  <span class="hljs-comment">/*这里的100%对应的百分比是left左边的那个盒子即center的宽度*/</span><br>&#125;<br><span class="hljs-selector-class">.right</span> &#123;<br>  <span class="hljs-attribute">margin-left</span>:-<span class="hljs-number">300px</span>;   <br>  <span class="hljs-comment">/*这里的-300px是right往左边移动自身宽度像素使自己刚刚放进center内*/</span><br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;       <br>  <span class="hljs-attribute">background-color</span>:<span class="hljs-built_in">rgb</span>(<span class="hljs-number">82</span>, <span class="hljs-number">82</span>, <span class="hljs-number">152</span>);<br>&#125;<br><span class="hljs-selector-class">.center</span>&#123;<br>  <span class="hljs-attribute">width</span>:<span class="hljs-number">100%</span>;<br>  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">165</span>, <span class="hljs-number">241</span>, <span class="hljs-number">216</span>);<br>&#125;<br><span class="hljs-selector-class">.center-inner</span> &#123;<br>  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">300px</span> <span class="hljs-number">0</span> <span class="hljs-number">200px</span>;<br>  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">237</span>, <span class="hljs-number">172</span>, <span class="hljs-number">87</span>);<br>  <span class="hljs-attribute">word-break</span>: break-all;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="两者区别">两者区别</h3><p><img src="%E4%B8%A4%E8%80%85%E5%8C%BA%E5%88%AB.png" alt="两者区别"></p><h4 id="解释">解释</h4><p>双飞翼布局相比较圣杯布局多了一个<code>center-inner</code>盒子，我们将圣杯布局center盒子的内容放在了inner盒子中，然后设置<code>center-inner</code>的margin值来取代<code>container</code>盒子的padding值，以及不需要设置left盒子和right盒子的相对定位来覆盖padding。</p><p>因此在CSS代码上双飞翼布局的更加精简，不过从上图我们可以知道(上图的middle就是center)，我们的center盒子具体的位置布置是不同的。</p><h3 id="相比flex布局，圣杯布局或者双飞翼布局的好处">相比flex布局，圣杯布局或者双飞翼布局的好处</h3><p>Q：为什么不用flex布局？</p><p>A：跟加载顺序有关，flex布局的<code>dom</code>结构是<code>left-center-right</code>如果左边加载很慢，页面就空了。而圣杯和双飞翼都是先加载中间内容，再加载左右。</p>]]></content>
    
    
    <categories>
      
      <category>CSS和HTML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>怎么用reduce实现map？</title>
    <link href="/2022/05/24/%E7%94%A8reduce%E5%AE%9E%E7%8E%B0map/"/>
    <url>/2022/05/24/%E7%94%A8reduce%E5%AE%9E%E7%8E%B0map/</url>
    
    <content type="html"><![CDATA[<h1>用reduce实现map</h1><h3 id="Array-map">Array.map</h3><h4 id="用法-3">用法</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> new_array = arr.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">currentValue[, index[, array]]</span>) &#123;<br> <span class="hljs-comment">// Return element for new_array </span><br>&#125;[, thisArg])<br></code></pre></div></td></tr></table></figure><p>如果 <code>thisArg</code> 参数提供给<code>map</code>，则会被用作回调函数的<code>this</code>值。否则 <code>undefined</code> 会被用作回调函数的<code>this</code>值。</p><h4 id="参数">参数</h4><ul><li><p><code>callback</code></p><p>生成新数组元素的函数，使用三个参数：<code>currentValue</code> 为<code>callback</code> 数组中正在处理的当前元素。<code>index</code>（可选）<code>callback</code> 数组中正在处理的当前元素的索引。<code>array</code>（可选）<code>map</code> 方法调用的数组。</p></li><li><p><code>thisArg</code>（可选）</p><p>执行 <code>callback</code> 函数时值被用作<code>this</code>。</p></li></ul><h3 id="Array-prototype-Mymap"><code>Array.prototype.Mymap()</code></h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">Mymap</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">fn,thisArg</span>)&#123;<br>    <span class="hljs-keyword">const</span> result = [];<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">previous,current,index,array</span>) =&gt;</span> &#123;<br>        result[index] = fn.<span class="hljs-title function_">call</span>(thisArg,array[index],index,array);<br>    &#125;,<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></div></td></tr></table></figure><h1>手写reduce</h1><h3 id="array-reduce">array.reduce()</h3><h4 id="用法-4">用法</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">previousValue, currentValue, currentIndex, array</span>) =&gt;</span> &#123; <span class="hljs-comment">/* ... */</span> &#125;, initialValue)<br></code></pre></div></td></tr></table></figure><h4 id="参数-2">参数</h4><ul><li><p><code>callbackFn</code></p><p>一个 “reducer” 函数，包含四个参数：</p><ol><li><p><code>previousValue</code>：上一次调用 <code>callbackFn</code> 时的返回值。在第一次调用时，若指定了初始值 <code>initialValue</code>，其值则为 <code>initialValue</code>，否则为数组索引为 0 的元素 <code>array[0]</code>。</p></li><li><p><code>currentValue</code>：数组中正在处理的元素。在第一次调用时，若指定了初始值 <code>initialValue</code>，其值则为数组索引为 0 的元素 <code>array[0]</code>，否则为 <code>array[1]</code></p></li><li><p><code>currentIndex</code>：数组中正在处理的元素的索引。若指定了初始值 <code>initialValue</code>，则起始索引号为 0，否则从索引 1 起始。</p></li><li><p><code>array</code>：用于遍历的数组。</p></li></ol></li><li><p><code>initialValue</code> （可选）</p><p>作为第一次调用 <code>callback</code> 函数时参数 <em>previousValue</em> 的值。若指定了初始值 <code>initialValue</code>，则 <code>currentValue</code> 则将使用数组第一个元素；否则 <code>previousValue</code> 将使用数组第一个元素，而 <code>currentValue</code> 将使用数组第二个元素。</p></li></ul><h3 id="Myreduce"><code>Myreduce()</code></h3><h4 id="代码-2">代码</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">Myreduce</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">fn,initialValue</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> fn !== <span class="hljs-string">&#x27;function&#x27;</span>)&#123;<br>         <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;第一个参数必须为一个函数&#x27;</span>);<br>         <span class="hljs-keyword">return</span> ;<br>    &#125;<br><span class="hljs-keyword">let</span> previousValue = initialValue || <span class="hljs-variable language_">this</span>[<span class="hljs-number">0</span>];<br><span class="hljs-keyword">const</span> currentIndex = initialValue ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = currentIndex;i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>;i++)&#123;<br>previousValue = <span class="hljs-title function_">fn</span>(previousValue,<span class="hljs-variable language_">this</span>[i],i,<span class="hljs-variable language_">this</span>);<br>&#125;<br><span class="hljs-keyword">return</span> previousInitial;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="测试结果">测试结果</h4><p><img src="test.jpg" alt="测试结果"></p>]]></content>
    
    
    <categories>
      
      <category>Q&amp;A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>面经</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSS用法杂记</title>
    <link href="/2022/05/24/CSS%E7%94%A8%E6%B3%95%E6%9D%82%E8%AE%B0/"/>
    <url>/2022/05/24/CSS%E7%94%A8%E6%B3%95%E6%9D%82%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1>CSS用法杂记</h1><h3 id="transition">transition</h3><p>语法：<strong>transition: property duration timing-function delay;</strong></p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>transition-property</td><td>规定设置过渡效果的 CSS 属性的名称</td></tr><tr><td>transition-duration</td><td>规定完成过渡效果需要多少秒或毫秒</td></tr><tr><td>transition-timing-function</td><td>规定速度效果的速度曲线</td></tr><tr><td>transition-delay</td><td>定义过渡效果何时开始</td></tr></tbody></table><h3 id="element-classList-toggle-属性名">element.classList.toggle(属性名)</h3><p>十分灵活的用法，如果某个DOM元素没有X属性添加X属性，如果存在X属性则删除X属性。</p>]]></content>
    
    
    <categories>
      
      <category>CSS和HTML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>flex属性</title>
    <link href="/2022/05/24/flex%E5%B1%9E%E6%80%A7/"/>
    <url>/2022/05/24/flex%E5%B1%9E%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<h1>flex属性</h1><p><code>flex</code>属性其实是一种简写，是<code>flex-grow</code>，<code>flex-shrink</code>和<code>flex-basis</code>的缩写形式。 默认值为<code>0 1 auto</code></p><h2 id="flex-grow">flex-grow</h2><p><code>flex-grow</code>属性定义项目的放大比例，默认为<code>0</code>，即如果存在剩余空间，也不放大。</p><p>如果所有项目的flex-grow属性都为1，则它们将等分剩余空间（如果有的话）。</p><p>如果一个项目的flex-grow属性为2，其他项目都为1，则前者占据的剩余空间将比其他项多一倍。</p><p><img src="flex-grow.png" alt="flex-grow"></p><h2 id="flex-shrink">flex-shrink</h2><p>flex-shrink属性定义了项目的缩小比例，默认为1，即如果空间不足，该项目将缩小。</p><p>如果所有项目的flex-shrink属性都为1，当空间不足时，都将等比例缩小。</p><p>如果一个项目的flex-shrink属性为0，其他项目都为1，则空间不足时，前者不缩小。</p><p><img src="flex-shrink.jpg" alt="flex-shrink"></p><h2 id="flex-basis">flex-basis</h2><p>flex-basis属性定义了在分配多余空间之前，项目占据的主轴空间（main size）。</p><p>浏览器根据这个属性，计算主轴是否有多余空间。它的默认值为auto，即项目的本来大小。</p><p>它可以设为跟width或height属性一样的值（比如450px），则项目将占据固定空间。</p><p>可以使用一个，两个或三个值来指定 <code>flex</code>属性。</p><h2 id="省略写法">省略写法</h2><p><strong>单值语法</strong>: 值必须为以下其中之一:</p><ul><li>一个无单位数<code>&lt;number&gt;</code>：它会被当作<code>flex:&lt;number&gt; 1 0 </code>；</li><li>一个有效的宽度<code>width</code>值: 它会被当作 <code>&lt;flex-basis&gt;</code>的值。</li><li>关键字<code>none</code>，<code>auto</code>或<code>initial</code></li></ul><p><strong>双值语法</strong>: 第一个值必须为一个无单位数，并且它会被当作 <code>&lt;flex-grow&gt;</code> 的值。第二个值必须为以下之一：</p><ul><li>一个无单位数：它会被当作 <code>&lt;flex-shrink&gt;</code> 的值。</li><li>一个有效的宽度值: 它会被当作 <code>&lt;flex-basis&gt;</code> 的值。</li></ul><p><strong>三值语法:</strong></p><ul><li>第一个值必须为一个无单位数，并且它会被当作 <code>&lt;flex-grow&gt;</code> 的值。</li><li>第二个值必须为一个无单位数，并且它会被当作 <code>&lt;flex-shrink&gt;</code> 的值。</li><li>第三个值必须为一个有效的宽度值， 并且它会被当作 <code>&lt;flex-basis&gt;</code> 的值。</li></ul><h3 id="关键字">关键字</h3><p><code>initial</code></p><p>元素会根据自身宽高设置尺寸。它会缩短自身以适应 flex 容器，但不会伸长并吸收 flex 容器中的额外自由空间来适应 flex 容器 。相当于将属性设置为&quot;<code>flex: 0 1 auto</code>&quot;。</p><p><code>auto</code></p><p>元素会根据自身的宽度与高度来确定尺寸，但是会伸长并吸收 flex 容器中额外的自由空间，也会缩短自身来适应 flex 容器。这相当于将属性设置为 “<code>flex: 1 1 auto</code>”.</p><p><code>none</code></p><p>元素会根据自身宽高来设置尺寸。它是完全非弹性的：既不会缩短，也不会伸长来适应 flex 容器。相当于将属性设置为&quot;<code>flex: 0 0 auto</code>&quot;。</p>]]></content>
    
    
    <categories>
      
      <category>CSS和HTML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSS中:var和env</title>
    <link href="/2022/05/22/CSS%E4%B8%AD-root%E5%92%8Cvar/"/>
    <url>/2022/05/22/CSS%E4%B8%AD-root%E5%92%8Cvar/</url>
    
    <content type="html"><![CDATA[<h1>CSS中<code>var()</code>和<code>env()</code></h1><h2 id="root">:root</h2><p>CSS <code>:root</code> 伪类选择器匹配文档树的根元素。在 HTML 文档中，<code>:root</code> 表示 <code>html</code> 选择器， 除了<code>CSS</code>权重比它高以外，其他都是一样的。</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-pseudo">:root</span> &#123;<br>  <span class="hljs-attribute">background-color</span>: blue;<br>&#125;<br><br><span class="hljs-selector-tag">html</span> &#123;<br>  <span class="hljs-attribute">background-color</span>: yellow;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>最终文档的背景色将会是 <code>blue</code>。</p><h2 id="自定义属性-CSS-变量）-及-var">自定义属性(CSS 变量） 及 var()</h2><h3 id="自定义属性-CSS-变量）">自定义属性(CSS 变量）</h3><p>带有前缀<code>--</code>的属性名，比如<code>--example--name</code>，表示的是带有值的<strong>自定义属性</strong>(很多时候也称之为 CSS 变量），其可以通过 <code>var()</code> 函数在其他声明中复用。</p><p>自定义属性的范围限定在声明它们的元素上，并参与级联：此类自定义属性的值来由级联算法声明决定。</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-attr">--somekeyword</span>: left;<br><span class="hljs-attr">--somecolor</span>: <span class="hljs-number">#0000ff</span>;<br><span class="hljs-attr">--somecomplexvalue</span>: <span class="hljs-number">3px</span> <span class="hljs-number">6px</span> <span class="hljs-built_in">rgb</span>(<span class="hljs-number">20</span>, <span class="hljs-number">32</span>, <span class="hljs-number">54</span>);<br></code></pre></div></td></tr></table></figure><blockquote><p>注意：IE 不支持此属性</p></blockquote><h3 id="var">var()</h3><p>CSS函数 <code>var()</code> 可以用<strong>自定义属性</strong>的值替换另外一个属性值的任何一部分。</p><blockquote><p>注意：IE 不支持此属性</p></blockquote><p>语法</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">var</span>( &lt;custom-property-name&gt; , &lt;declaration-value&gt;? )<br></code></pre></div></td></tr></table></figure><p>第一个属性不存在时，使用第二个兜底值。</p><h3 id="示例：var-CSS-变量-基本用法">示例：var() + CSS 变量 基本用法</h3><p>在 :root 上定义，然后使用它</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-pseudo">:root</span> &#123;<br>  <span class="hljs-attr">--main-bg-color</span>: pink;<br>&#125;<br><br><span class="hljs-selector-tag">body</span> &#123;<br>  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--main-bg-color);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>最终 body 的颜色会是 <code>pink</code> 的。</p><h3 id="示例：var-回退值">示例：var() 回退值</h3><p>当第一个值未定义，回退值生效。</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.component</span> &#123;<br>  <span class="hljs-attr">--text-color</span>: <span class="hljs-number">#080</span>;<br>&#125;<br><br><span class="hljs-comment">/* 在 component 的样式中使用它： */</span><br><span class="hljs-selector-class">.component</span> <span class="hljs-selector-class">.text</span> &#123;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--text-color, black); <span class="hljs-comment">/* 此处 color 正常取值 --text-color */</span><br>&#125;<br><span class="hljs-selector-class">.component</span> <span class="hljs-selector-class">.header</span> &#123;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--header-color, blue);<br>  <span class="hljs-comment">/* header-color 并没有被设定, 此处 color 被回退到 blue */</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="示例：CSS-变量的优先级">示例：CSS 变量的优先级</h3><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;outWrapper&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;innerWrapper&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-pseudo">:root</span> &#123;</span><br><span class="language-css">            <span class="hljs-attr">--bg-color</span>: blue;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">body</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">            <span class="hljs-attribute">overflow</span>: hidden;</span><br><span class="language-css">            <span class="hljs-attr">--bg-color</span>: yellow;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.outWrapper</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;</span><br><span class="language-css">            <span class="hljs-comment">/* 将会是 yellow */</span></span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--bg-color);</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.innerWrapper</span> &#123;</span><br><span class="language-css">            <span class="hljs-attr">--bg-color</span>: green;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;</span><br><span class="language-css">            <span class="hljs-comment">/* 将会是 green */</span></span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--bg-color);</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="env">env()</h2><p><code>env() </code>CSS 函数以类似于 var 函数和 custom properties 的方式将用户代理定义的环境变量值插入你的 CSS 中。</p><p><code>env()</code> 和 <code>var() </code>区别在于:</p><ul><li>定义方不同：环境变量由 <code>user-agent</code> 定义，自定义属性可以由用户定义外</li><li>作用域不同： 环境变量是全局作用在文档中， 自定义属性则限定在声明它们的元素</li></ul><p>为了告诉浏览器使用屏幕上所有的可用空间，并以此使用<code>env()</code>变量，我们需要添加一个新的视口元值：</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;viewport-fit=cover&quot;</span> /&gt;</span><br></code></pre></div></td></tr></table></figure><p>其语法和 <code>var() </code>一致</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">env( &lt;custom-ident&gt; , &lt;declaration-value&gt;? )<br></code></pre></div></td></tr></table></figure><h3 id="Values">Values</h3><p><code>safe-area-inset-top</code>, <code>safe-area-inset-right</code>, <code>safe-area-inset-bottom</code>, <code>safe-area-inset-left</code></p><p><code>safe-area-inset-*</code>由四个定义了视口边缘内矩形的 top, right, bottom 和 left 的环境变量组成，这样可以安全地放入内容，而不会有被非矩形的显示切断的风险。对于矩形视口，例如普通的笔记本电脑显示器，其值等于零。 对于非矩形显示器（如圆形表盘，iPhoneX屏幕），在用户代理设置的四个值形成的矩形内，所有内容均可见。</p><h3 id="注意">注意</h3><p>不同于其他的 CSS 属性，用户代理定义的属性名字对大小写敏感。</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">body</span> &#123;<br>  <span class="hljs-attribute">padding</span>:<br>    <span class="hljs-built_in">env</span>(safe-area-inset-top, <span class="hljs-number">50px</span>)<br>    <span class="hljs-built_in">env</span>(safe-area-inset-right, <span class="hljs-number">50px</span>)<br>    <span class="hljs-built_in">env</span>(safe-area-inset-bottom, <span class="hljs-number">50px</span>)<br>    <span class="hljs-built_in">env</span>(SAFE-AREA-INSET-LEFT, <span class="hljs-number">50px</span>);<br>&#125;<br><span class="hljs-comment">/*这种情况下 padding-left就是50px</span><br></code></pre></div></td></tr></table></figure><h3 id="示例">示例</h3><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">body</span> &#123;<br>  <span class="hljs-attribute">padding</span>:<br>    <span class="hljs-built_in">env</span>(safe-area-inset-top, <span class="hljs-number">20px</span>)<br>    <span class="hljs-built_in">env</span>(safe-area-inset-right, <span class="hljs-number">20px</span>)<br>    <span class="hljs-built_in">env</span>(safe-area-inset-bottom, <span class="hljs-number">20px</span>)<br>    <span class="hljs-built_in">env</span>(safe-area-inset-left, <span class="hljs-number">20px</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="%E5%AE%89%E5%85%A8%E8%B7%9D%E7%A6%BB.png" alt="安全距离"></p>]]></content>
    
    
    <categories>
      
      <category>CSS和HTML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue</title>
    <link href="/2022/05/21/Vue/"/>
    <url>/2022/05/21/Vue/</url>
    
    <content type="html"><![CDATA[<h1>Vue</h1><h2 id="Vue简介">Vue简介</h2><h3 id="什么是Vue？">什么是Vue？</h3><blockquote><p>Vue是一套用于构建用户界面的<strong>渐进式框架</strong>。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与现代化的工具链以及各种支持类库结合使用时，Vue 也完全能够为复杂的单页应用提供驱动。</p></blockquote><h3 id="Vue的特点">Vue的特点</h3><ol><li><p>采取组件化模式，提高代码复用率，且让代码更好维护。</p></li><li><p>声明式编码，让编码人员无需直接操作DOM，提高开发效率。</p></li><li><p>使用虚拟DOM+优秀的Diff算法，尽量复用DOM节点。</p></li></ol><h2 id="Vue基础语法">Vue基础语法</h2><h3 id="容器与vue实例之间的对应">容器与vue实例之间的对应</h3><p>只能一一对应。</p><h3 id="模板语法">模板语法</h3><p>Vue模板语法有两大类：插值语法和指令语法</p><ol><li><p>插值语法，用于解析标签体内容。</p></li><li><p>指令语法，用于解析标签（包括标签属性、标签体内容、绑定事件……）</p></li></ol><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs HTML"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">v-bind:href</span>=<span class="hljs-string">&quot;url&quot;</span>&gt;</span>博客地址<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">:href</span>=<span class="hljs-string">&quot;url&quot;</span>&gt;</span>博客地址<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>   <span class="hljs-comment">&lt;!-- v-bind:可以简写成:&gt;</span><br><span class="hljs-comment">&lt;/div&gt;</span><br><span class="hljs-comment">&lt;script&gt;</span><br><span class="hljs-comment">    Vue.config.productionTip = false;</span><br><span class="hljs-comment">    Vue.config.devtools = false;</span><br><span class="hljs-comment">    const vue = new Vue(&#123;</span><br><span class="hljs-comment">    el: &#x27;#root&#x27;,    </span><br><span class="hljs-comment">        data:&#123;</span><br><span class="hljs-comment">           name:&#x27;bitter-gourd&#x27;,</span><br><span class="hljs-comment">           url:&#x27;https://bittergourd.com&#x27; </span><br><span class="hljs-comment">             &#125;</span><br><span class="hljs-comment">        &#125;);</span><br><span class="hljs-comment">&lt;/script&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="数据绑定">数据绑定</h3><ol><li>单向绑定（<code>v-bind</code>）：数据只能从data流向页面。</li><li>双向绑定（<code>v-model</code>）：数据不仅能从data流向页面，还可以从页面流向data。</li></ol><p>备注：</p><ol><li>双向绑定一般都应用在表单类元素上（如<code>input</code>、<code>select</code>等）。</li><li><code>v-model:value</code>可以简写为<code>v-model</code>，因为<code>v-model</code>默认收集的就是value值。</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vue">&lt;input type=&quot;text&quot; v-bind:value=&quot;name&quot;&gt;<br>&lt;input type=&quot;text&quot; v-model:value=&quot;name&quot;&gt;<br><br>&lt;!--简写&gt;<br>&lt;input type=&quot;text&quot; :value=&quot;name&quot;&gt;<br>&lt;input type=&quot;text&quot; v-model=&quot;name&quot;&gt;<br></code></pre></div></td></tr></table></figure><h3 id="data与vue的两种写法">data与vue的两种写法</h3><ol><li><code>el</code>的两种写法：</li></ol><p>​(1).<code>new Vue</code>的时候直接配置<code>el</code></p><p>​(2).先创建<code>Vue</code>实例，再通过<code>vm.$mount('#root')</code>指定el的值</p><ol start="2"><li><p><code>data</code>的两种写法：</p><p>(1).对象式</p><p>(2).函数式（应该用这种）</p></li><li><p>由<code>Vue</code>管理的函数，不要写箭头函数的形式，因为在data里的函数的this需要指向Vue实例。</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> vue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br><span class="hljs-comment">//el:&#x27;#root&#x27;</span><br>    data：&#123;<br><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span><br>   &#125;<br>&#125;)<br>vue.$mount(<span class="hljs-string">&#x27;#root&#x27;</span>);<br><br><span class="hljs-keyword">const</span> vue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">data</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span>&#123;<br>            <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//或者简写形式</span><br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span>&#123;<br>            <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="MVVM模型">MVVM模型</h3><p>M：模型（<code>Model</code>）：对应data中的数据。</p><p>V：视图（<code>View</code>）：模板（在<code>&lt;html&gt;</code>中的DOM元素 ）</p><p>VM：视图模型（<code>ViewModel</code>）:<code>Vue</code>实例对象</p><p>因此我们都会用<code>vm</code>来接受<code>Vue</code>实例对象。</p><ol><li>data中所有的属性，最后都出现在了vm身上。</li><li>vm身上所有的属性及Vue原型上所有属性，在Vue模板中都可以直接使用。</li></ol><p><img src="MVVM.png" alt="MVVM模型"></p><h3 id="数据代理">数据代理</h3><p>vue中的数据代理：</p><p>​通过vm对象来代理data对象中属性的操作（读/写），通过<code>Object.defineProperty()</code>把data对象中所有属性添加到vm上，为给一个添加到vm上的属性都指定一个getter和setter，在getter/setter内部去操作（读/写）data中对应的数据。</p><h4 id="Object-defineProperty"><code>Object.defineProperty</code></h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> person = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span>,<br>    <span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span><br>&#125;<br><span class="hljs-keyword">let</span> number = <span class="hljs-number">18</span>;<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(person,<span class="hljs-string">&#x27;age&#x27;</span>,&#123;<br>    <span class="hljs-attr">value</span>:<span class="hljs-string">&#x27;18&#x27;</span>,<br>    <span class="hljs-attr">enumerable</span>:<span class="hljs-literal">true</span>,   <span class="hljs-comment">//控制属性是否可以枚举，默认值为false</span><br>    <span class="hljs-attr">writable</span>:<span class="hljs-literal">true</span>,     <span class="hljs-comment">//控制属性是否可以更改，默认值为false</span><br>    <span class="hljs-attr">configurable</span>:<span class="hljs-literal">true</span>  <span class="hljs-comment">//控制属性是否可以删除(delete person.sex),默认值为false</span><br>    <br>    <span class="hljs-comment">//当有人读取person.age时，get函数就会被调用，且返回值就是age的值。</span><br>    <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> number;<br>&#125;,<br>   <span class="hljs-comment">//当有人修改person.age时，set函数就会被调用，且返回值就是age的值。</span><br><span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>)&#123;<br>        number = value;<br>    &#125;<br>&#125;)<br><br><span class="hljs-comment">//因此如果只用defineProperty方法添加的属性，默认不可以被枚举，不可以更改，不可以删除。</span><br></code></pre></div></td></tr></table></figure><h4 id="数据代理-2">数据代理</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj = &#123;<span class="hljs-attr">x</span>:<span class="hljs-number">100</span>&#125;<br><span class="hljs-keyword">let</span> obj2 = &#123;<span class="hljs-attr">y</span>:<span class="hljs-number">200</span>&#125;<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-params">obj2,<span class="hljs-string">&#x27;x&#x27;</span></span>)&#123;<br>    <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> obj.<span class="hljs-property">x</span>;<br>    &#125;,<br>    <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>)&#123;<br>        obj.<span class="hljs-property">x</span> = value;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="事件处理-2">事件处理</h3><h4 id="事件的基本使用">事件的基本使用</h4><ol><li>使用 <code>v-on:xxx </code>或者 <code>@xxx</code> 绑定事件，其中<code>xxx</code>是事件名；</li><li>事件的回调函数需要配置在<code>methods</code>对象中，最终会在<code>vm</code>上；</li><li><code>methods</code>中配置的函数不能用箭头函数，否则this指向的就不是<code>vm</code>了；</li><li><code>methods</code>中配置的函数，都会是被<code>vue</code>所管理的函数，<code>this</code>的指向是<code>vm</code>或者组件实例对象；</li><li><code>@click=&quot;demo&quot;</code>和<code>@click=&quot;demo($event)&quot;</code>效果一致，但后者可以传参。</li></ol><h4 id="事件修饰符">事件修饰符</h4><ol><li><code>preventDefault</code>：阻止默认事件</li><li><code>stop</code>：阻止事件冒泡</li><li><code>once</code>：事件只触发一次</li><li><code>capture</code>：使用事件捕获模式</li><li><code>self</code>：只有<code>event.target</code>是当前操作的元素时才触发事件</li><li><code>passive</code>：事件的默认行为立即执行，无需等待事件回调执行完毕</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;a href=<span class="hljs-string">&quot;www.bitter-gourd.com&quot;</span> @click=<span class="hljs-string">&quot;showInfo&quot;</span>&gt;点我&lt;/a&gt;<br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>()&#123;<br>    <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">methods</span>:&#123;<br>        <span class="hljs-title function_">showInfo</span>(<span class="hljs-params">e</span>)&#123;<br>            e.<span class="hljs-property">preventDefault</span>;<br>            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;hell,I am bitter-gourd&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br>&lt;a href=<span class="hljs-string">&quot;www.bitter-gourd.com&quot;</span> @click.<span class="hljs-property">prevent</span>=<span class="hljs-string">&quot;showInfo&quot;</span>&gt;点我&lt;/a&gt;<br></code></pre></div></td></tr></table></figure><h4 id="键盘事件">键盘事件</h4><ol><li>回车 =&gt; enter</li><li>删除 =&gt; delete (捕获“删除”或者“退格’'键)</li><li>退出 =&gt; esc</li><li>空格 =&gt; space</li><li>换行 =&gt; tab (tab键有切换焦点的功能，必须用keydown，否则无法触发)</li><li>上 =&gt; up</li><li>下 =&gt; down</li><li>左 =&gt; left</li><li>右 =&gt; right</li></ol><p>注意点：</p><ol><li>如果Vue没有提供别名的按键，可以使用按键原始的key值去绑定，但要使用 kebab-case(短横线、小写命名)。</li><li>系统修饰键(ctrl、alt、shift、meta，还包括tab键）</li></ol><p>​(1). 配合keyup使用：按下修饰键的同时，再按下其他键，随后释放其他键，事件才会被触发。</p><p>​(2). 配合keydown使用：可以正常触发事件。</p><h3 id="计算属性">计算属性</h3><p><code>conputed</code></p><ol><li>计算属性将被混入到 Vue 实例中。所有 getter 和 setter 的 this 上下文自动地绑定为 Vue 实例。</li><li>计算属性最终会出现在vm上，直接读取使用就好.</li><li>如果计算属性要被修改，那必须写set函数去响应修改，且set中要引起计算的依赖的数据进行修改。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br><span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">firstName</span>:<span class="hljs-string">&#x27;bitter&#x27;</span>,<br>        <span class="hljs-attr">lastName</span>:<span class="hljs-string">&#x27;gourd&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">computed</span>:&#123;<br>        <span class="hljs-attr">fullName</span>:&#123;<br>            <span class="hljs-comment">//当有人读取fullName时，get就会被调用且返回值作为fullName的值</span><br>            <span class="hljs-comment">//在computed中 get()方法是必须的</span><br>            <span class="hljs-comment">//此处的this指向的是vm</span><br>            <span class="hljs-comment">//set调用的时机 1.初次读取fullName的时候 2.所依赖的数据发生变化时</span><br>            <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstName</span> + <span class="hljs-string">&#x27;-&#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastName</span>;<br>            &#125;<br>            <span class="hljs-comment">//get调用的时机 当fullName被修改时</span><br>            <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>)&#123;<br>        <span class="hljs-keyword">const</span> arr = value.<span class="hljs-title function_">spilt</span>(<span class="hljs-string">&#x27;-&#x27;</span>);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstName</span> = arr[<span class="hljs-number">0</span>];<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastName</span> = arr[<span class="hljs-number">1</span>];<br>    &#125;<br>        &#125;<br>        <span class="hljs-comment">/*简写形式，这种情况下只有get()，只考虑读取不考虑修改。</span><br><span class="hljs-comment">        *fullName()&#123;</span><br><span class="hljs-comment">        *return this.firstName + &#x27;-&#x27; + this.lastName;</span><br><span class="hljs-comment">        *&#125;</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">&#125;)</span><br></code></pre></div></td></tr></table></figure><h3 id="监视（侦听）属性">监视（侦听）属性</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br><span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br><span class="hljs-attr">data</span>:&#123;<br><span class="hljs-attr">isHot</span>:<span class="hljs-literal">true</span>;<br>&#125;,<br><span class="hljs-attr">computed</span>:&#123;<br><span class="hljs-title function_">info</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ihHot</span> ? <span class="hljs-string">&#x27;hot&#x27;</span>：<span class="hljs-string">&#x27;cool&#x27;</span>;<br>&#125;<br>&#125;,<br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">changeWeather</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">isHot</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isHot</span>;<br>&#125;<br>&#125;,<br>        <span class="hljs-comment">//在watch中即可以监视data中的值，也可以监视computed中的值</span><br>    <span class="hljs-attr">watch</span>:&#123;<br>        <span class="hljs-attr">isHot</span>:&#123;<br>            <span class="hljs-comment">//immediate初始化时让handler调用一下，默认值为false</span><br>            <span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span>,<br>            <span class="hljs-comment">//handler当isHot发生改变的时候调用</span><br>            <span class="hljs-title function_">handler</span>(<span class="hljs-params">newValue,oldValue</span>)&#123;<br>                <br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="深度监视">深度监视</h4><ol><li><p><code>Vue</code>中的<code>watch</code>默认不监视对象内部值的改变（一层）。配置<code>deep:true</code>可以监视对象内部值的改变（多层）。</p></li><li><p><code>Vue</code>自身可以监视对象内部值的改变，但<code>Vue</code>提供的watch默认不可以。</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br><span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br><span class="hljs-attr">data</span>:&#123;<br><span class="hljs-attr">numbers</span>:&#123;<br>            <span class="hljs-attr">a</span>:<span class="hljs-number">100</span>,<br>            <span class="hljs-attr">b</span>:<span class="hljs-number">200</span><br>        &#125;<br>&#125;,<br>    <span class="hljs-attr">watch</span>:&#123;<br><span class="hljs-comment">//&#x27;numbers.a&#x27;:&#123;&#125;  如果像这样监视data中的numbers属性的a需要用字符串的形式写key</span><br>        <span class="hljs-attr">numbers</span>:&#123;<br>        <span class="hljs-attr">deep</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-comment">//deep属性是深度监视的开关，默认值为false,如果不改为true的话</span><br>            <span class="hljs-comment">//单单改变a或者b的值watch是不会监视到numbers的变化的，如果把numbers整个对象替换</span><br>        <span class="hljs-title function_">handler</span>(<span class="hljs-params"></span>)&#123;&#125;<br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="简写形式">简写形式</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-attr">watch</span>:&#123;<br>        <span class="hljs-attr">isHot</span>:&#123;<br>            <span class="hljs-comment">//immediate初始化时让handler调用一下，默认值为false</span><br>            <span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span>,<br>            <span class="hljs-comment">//handler当isHot发生改变的时候调用</span><br>            <span class="hljs-title function_">handler</span>(<span class="hljs-params">newValue,oldValue</span>)&#123;&#125;<br>        &#125;<br>&#125;<br><span class="hljs-comment">//当不需要使用immediate属性和deep属性的时可以简写</span><br><span class="hljs-attr">watch</span>:&#123;<br>        <span class="hljs-title function_">isHot</span>(<span class="hljs-params">newValue,oldValue</span>)&#123;&#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h3 id="侦听属性与计算属性的区别">侦听属性与计算属性的区别</h3><ol><li><code>computed</code>能完成的功能，<code>watch</code>都能完成。</li><li><code>watch</code>能完成的功能，<code>computed</code>不一定能完成，比如：<code>watch</code>可以进行异步操作。</li></ol><p>注意点：（目标：让this指向vm）</p><ol><li>被<code>Vue</code>管理的函数，最好写成普通函数，这样this的指向才是vm 或者 组件实例对象。</li><li>所有不被<code>vue</code>管理的函数(异步任务如定时器、Ajax、promise的回调函数等)，最好写成箭头函数，这样this的指向才是<code>vm</code>，或者组件的实例对象。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-attr">watch</span>:&#123;<br><span class="hljs-title function_">firstName</span>(<span class="hljs-params">val</span>)&#123;<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);  <span class="hljs-comment">//结果是window</span><br>&#125;，<span class="hljs-number">1000</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);  <span class="hljs-comment">//结果是vm</span><br>&#125;，<span class="hljs-number">1000</span>);<br>&#125;<br>&#125;<br><span class="hljs-comment">//证明了如果在Vue实例对象中使用异步任务，其实不被Vue管理，因此需要写箭头函数。</span><br><span class="hljs-comment">//写成箭头函数的话就没有this，当箭头函数内用this的时候就会往外去找this。</span><br></code></pre></div></td></tr></table></figure><h3 id="绑定class">绑定class</h3><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;#root&#x27;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&#x27;basic&#x27;</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&#x27;mood&#x27;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&#x27;changeClass&#x27;</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&#x27;basic&#x27;</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&#x27;classArr&#x27;</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&#x27;basic&#x27;</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&#x27;classObj&#x27;</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--内联样式写法--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&#x27;basic&#x27;</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&#x27;styleObj&#x27;</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">scirpt</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&#x27;text/javascript&#x27;</span>&gt;</span><br>Vue.config.productionTip = false;<br>    const vm = new Vue(&#123;<br>      el:&#x27;#root&#x27;,<br>      data:&#123;<br>    name:&#x27;bitter-gourd&#x27;,<br>    mood:&#x27;nomal&#x27;,<br>    classArr:[&#x27;high&#x27;,&#x27;medium&#x27;,&#x27;low&#x27;],<br>    classObj:&#123;<br>    high:false,<br>    medium:false,<br>    low:false,<br>    &#125;<br>    classObj:&#123;<br>    //font-size写成fontSize<br>    fontSize:&#x27;40px&#x27;,<br>    //background-color写成backgroundColor<br>    backgroundColor:&#x27;orange&#x27;,<br>    &#125;<br>      &#125;<br>    &#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">scirpt</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="条件渲染">条件渲染</h3><ol><li><code>v-if</code></li></ol><p>​(1).<code>v-if=&quot;表达式&quot;</code></p><p>​(2).<code>v-else-if=&quot;表达式&quot;</code></p><p>​(3).<code>v-else=&quot;表达式&quot;</code></p><p><strong>特点：</strong></p><ul><li>适用于切换频率较低的场景。</li><li>不展示的DOM元素直接被移除。</li><li><code>v-if</code>可以跟<code>v-else-if</code>以及<code>v-else</code>一起使用，但要求结构不能被“打断”。</li></ul><ol start="2"><li><code>v-show</code></li></ol><p>​<code>v-show=&quot;表达式&quot;</code></p><p><strong>特点：</strong></p><ul><li>适用于切换频率较高的场景。</li><li>不展示的DOM元素添加 <code>display:none</code>隐藏，未被清除。</li></ul><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--底层实现是添加 display:none --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">&#x27;false&#x27;</span>&gt;</span>BitterGourd<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&#x27;false&#x27;</span>&gt;</span>BitterGourd<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--template是不会在DOM上显示 这样就可以与v-if配合使用 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;n === 1&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="列表渲染-2">列表渲染</h3><p><strong><code>v-for</code>指令</strong></p><ol><li>用于展示列表数据。</li><li>语法：<code>v-for=&quot;(item,index) in xxx &quot; :key=&quot;yyy&quot;</code></li><li>可遍历：数组、对象、字符串、指定次数。</li></ol><h3 id="Vue中的key">Vue中的<code>key</code></h3><ol><li><p><strong>key的作用：</strong></p><p>key是虚拟DOM对象的标识，当数据发生变化时，Vue会根据【新数据】生成【新的虚拟DOM】，随后Vue进行【新虚拟DOM】与【旧虚拟DOM】的差异比较。（<code>diff</code>算法）</p></li><li><p><strong>比较规则：</strong></p><p>旧虚拟DOM中找到了与新虚拟DOM的相同key值，若虚拟DOM中的内容没有变化，在渲染得到新的真实DOM时直接使用旧的真实DOM，若虚拟DOM中的内容变化了。则生成新的真实DOM，随后替换掉页面中之前的真实DOM。若旧的虚拟DOM中未找到与新虚拟DOM相同的key，则创建新的真实DOM，随后渲染到页面中。</p></li><li><p><strong>key用index作为值：</strong></p><p>若对数据进行逆序添加、逆序删除等破坏原有顺序操作，会产生没有必要的真实DOM更新，页面效果没问题但效率低下，若在结构中还存在输入类的<code>DOM(input)</code>，由于是在真实DOM中输入的内容，则在再次渲染的时候会产生错误的DOM更新，使得界面存在问题。</p></li><li><p><strong>如何选择key：</strong></p><p>最好使用每条数据的唯一标识作为key，比如id、手机号、身份证号、学号等唯一值。</p></li></ol><h3 id="Vue监测数据改变的原理">Vue监测数据改变的原理</h3><ol><li><p>Vue会监视data中所有层次的数据。</p></li><li><p>Vue监视对象中的数据</p><ul><li><p>通过<code>setter</code>实现监视，且要在new Vue时就传入要监测的数据。</p></li><li><p>对象中后追加的属性，Vue默认不做响应式处理</p></li><li><p>如需给后添加的属性做响应式，需要使用API：</p><p><code>Vue.set(target,propertyName/index,value)</code></p><p><code>vm.$set(target,propertyName/index,value)</code></p></li></ul></li><li><p>Vue修改数组中的某个元素可以使用的方法：</p><ul><li><p>使用数组方法：<code>push</code>  <code>pop</code>  <code>shift</code>  <code>unshift</code>  <code>splice</code>  <code>sort</code>   <code>reverse</code></p></li><li><p>使用API：</p><p><code>Vue.set(target,propertyName/index,value)</code></p><p><code>vm.$set(target,propertyName/index,value)</code></p></li></ul></li><li><p>注意：</p><p><code>Vue.set(target,propertyName/index,value)</code>和<code>vm.$set(target,propertyName/index,value)</code>不能给vm或者vm的根数据对象(data)添加属性。</p></li></ol><h3 id="v-model的三个修饰符"><code>v-model</code>的三个修饰符</h3><ul><li><p><code>v-model.trim</code> 输入首位空格过滤</p></li><li><p><code>v-model.number</code> 输入字符串转化为有效的数字</p></li><li><p><code>v-model.lazy</code> 失去焦点再收集数据</p></li></ul><h3 id="过滤器">过滤器</h3><p>定义：对要显示的数据进行特定格式化后再显示（适用于一些简单逻辑的处理）。</p><p>语法：</p><ol><li>注册过滤器：<code>Vue.filter(name,callback)</code> 或 <code>new Vue&#123;filter:&#123;&#125;&#125;</code>\</li><li>使用过滤器：<code>&#123;&#123;xxx | 过滤器名&#125;&#125;</code>  或 <code>v-bind: 属性  = “ xxx | 过滤器名”</code></li></ol><p>备注：</p><ol><li>过滤器也可以接受额外参数、多个过滤器也可以串联</li><li>过滤器并没有改变原本的数据，是产生新的对应的数据。</li></ol><h3 id="内置指令">内置指令</h3><p><code>v-cloak</code>(没有值)：</p><ol><li>本质是一个特殊属性，Vue实例创建完毕并接管容器后，会删掉<code>v-cloak</code>属性。</li><li>使用css配合<code>v-cloak</code>可以解决网速慢时页面展示出<code>&#123;&#123;XXX&#125;&#125;</code>的问题。</li></ol><p><code>v-once</code>(没有值)：</p><ol><li><code>v-once</code>所在节点在初次动态渲染后，就视为静态内容了。</li><li>以后数据的改变也不会引起<code>v-once</code>所在结构的更新，可以用于优化性能。</li></ol><p><code>v-pre</code>(没有值)：</p><ol><li>跳过其所在节点的编译过程。</li><li>可利用它跳过：没有使用指令语法、没有使用插值语法的节点，以加快编译速度。</li></ol><h3 id="自定义指令函数式">自定义指令函数式</h3><p><strong>自定义指令函数式什么时候会被调用？</strong></p><p>(1).指令与函数成功绑定时。（初次使用）</p><p>(2).指令所在的模板被重新解析的时候，即使该directive没有用到数据name，但当name被修改的时候，directives都会被重新调用。</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-enlarge</span>=<span class="hljs-string">&#x27;n&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript"><span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript"><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span>,</span><br><span class="language-javascript"><span class="hljs-attr">n</span>:<span class="hljs-number">1</span></span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript"><span class="hljs-attr">directives</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">enlarge</span>(<span class="hljs-params">element,binding</span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//element是一个HTML元素 binding是一个对象</span></span><br><span class="language-javascript">element.<span class="hljs-property">innerText</span> = binding.<span class="hljs-property">value</span> * <span class="hljs-number">10</span>;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="自定义指令对象式">自定义指令对象式</h3><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-enlarge</span>=<span class="hljs-string">&#x27;n&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript"><span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript"><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span>,</span><br><span class="language-javascript"><span class="hljs-attr">n</span>:<span class="hljs-number">1</span></span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript"><span class="hljs-attr">directives</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">fbind</span>:&#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//指令与元素成功绑定时调用</span></span><br><span class="language-javascript">                <span class="hljs-title function_">bind</span>(<span class="hljs-params">element,binding</span>)&#123;</span><br><span class="language-javascript">                    element.<span class="hljs-property">value</span> = binding.<span class="hljs-property">value</span>;</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-comment">//指令所在元素被插入页面时（在绑定之后）</span></span><br><span class="language-javascript">                <span class="hljs-title function_">inserted</span>(<span class="hljs-params">element,binding</span>)&#123;</span><br><span class="language-javascript">                    element.<span class="hljs-title function_">focus</span>();</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-comment">//指令所在模板被重新解析时</span></span><br><span class="language-javascript">                <span class="hljs-title function_">update</span>(<span class="hljs-params">element,binding</span>)&#123;</span><br><span class="language-javascript">                    element.<span class="hljs-property">value</span> = binding.<span class="hljs-property">value</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="生命周期">生命周期</h3><ol><li>又名：生命周期回调函数、生命周期函数、生命周期钩子。</li><li>是什么：Vue在关键时刻帮我们调用的一些特殊名称的函数。</li><li>生命周期函数的名字不可更改，但函数的具体内容可以自己写。</li><li>生命周期函数中的this指向的是vm或者组件实例对象。</li></ol><h4 id="生命周期钩子：">生命周期钩子：</h4><ol><li><p><code>beforeCreate</code>：</p><p>此时无法通过<code>vm</code>访问到<code>data</code>中的数据和<code>methods</code>中的方法。</p></li><li><p><code>Created</code>：</p><p>此时可以通过<code>vm</code>访问到<code>data</code>中的数据和<code>methods</code>中的方法。</p></li><li><p><code>beforemounted</code>：</p><p><code>Vue</code>开始解析模板并生成了虚拟DOM。</p><p>但页面呈现的是未经<code>Vue</code>编译的DOM结构，所有对DOM的操作都不奏效。</p></li><li><p><code>mounted</code>：</p><p><code>vue</code>完成模板的初次解析并把初始的真实DOM元素放入页面后（挂载完毕），调用<code>mounted</code>。</p><p>页面展示的是经过<code>Vue</code>编译的DOM，对DOM的操作均有效。</p><p>发送<code>ajax</code>请求、启动定时器、绑定自定义事件、订阅消息等【初始化操作】</p></li><li><p><code>beforeUpdate</code>：</p><p>此时：数据是新的，但页面仍然是旧的。</p><p>之后：根据新数据，生成新的虚拟DOM，随后与旧的虚拟DOM进行比较，完成更新。</p></li><li><p><code>Updated</code>：</p><p>之前：根据新数据，生成新的虚拟DOM，随后与旧的虚拟DOM进行比较，完成更新。</p><p>此时：数据是新的，页面也是新的，完成数据与页面的同步。</p></li><li><p><code>beforeDestroy</code>：</p><p>此时：<code>vm</code>中所有的：<code>data</code>、<code>methods</code>、指令等等，都处于可用状态，马上执行销毁过程。</p><p>一般在此阶段：清除定时器、解绑自定义事件、取消订阅消息等【收尾工作】</p></li><li><p><code>Destroy</code>：</p><p>销毁<code>vm</code>中所有的：<code>data</code>、<code>methods</code>、指令等等。</p></li></ol><h4 id="关于销毁Vue实例：">关于销毁Vue实例：</h4><ol><li>销毁后借助Vue开发者工具看不到任何消息</li><li>销毁后自定义事件会失效，但原生DOM事件依然有效</li><li>一般不会在<code>beforeDestroy</code>操作数据，因为即便操作数据，也不会再触发更新流程。</li></ol><h2 id="Vue组件">Vue组件</h2><h3 id="Vue中使用组件">Vue中使用组件</h3><ol><li>定义组件（创建组件）</li><li>注册组件</li><li>使用组件（写组件标签）</li></ol><h4 id="定义组件">定义组件</h4><p>使用<code>Vue.extend(options)</code>创建，其中<code>options</code>和<code>new Vue(options)</code>时传入的那个<code>options</code>几乎一样，但也有区别：</p><ol><li>不写<code>el</code>，因为最终所有的组件都要经过一个vm的管理，由vm中的el决定服务哪个容器。</li><li><code>data</code>必须写成函数式，因为要避免组件被复用的时，数据存在引用关系，即若用对象式，当组件被复用的时候修改数据会相互影响，而函数式则<code>return</code>一个对象存放数据，故每次在复用组件时都会在内存中开辟一块新的空间存放数据，每一次复用组件数据互不影响。（PS：对象式会直接报错）</li><li>使用<code>template</code>可以配置组件结构。</li><li>简写方式：</li></ol><p><code>const school = Vue.extend(options)</code>  =&gt;  <code>const school  = options</code></p><h4 id="注册组件">注册组件</h4><ol><li>局部注册：<code>new Vue</code>的时候传入<code>components</code>选项</li><li>全局注册：<code>Vue.component('组件名',组件)</code></li></ol><h4 id="使用组件">使用组件</h4><p>直接用组件名作为标签使用</p><h4 id="组件名">组件名</h4><ol><li><p>一个单词组成：</p><p>​(1).首字母小写</p><p>​(2).首字母大写</p></li><li><p>多个单词组成：</p></li></ol><p>​   (1).<code>kebab-case</code>命名：<code>my-school</code></p><p>​   (2).<code>CamlCase</code>命名：<code>MySchool</code>(需要<code>Vue</code>脚手架支持)</p><ol start="3"><li>可以用<code>name</code>配置项指定组件在开发者工具中呈现的名字。</li></ol><h4 id="组件标签">组件标签</h4><ol><li><code>&lt;school&gt;&lt;/school&gt;</code></li><li><code>&lt;school/&gt;</code>（如果不使用脚手架会导致后续组件不能渲染）</li></ol><h3 id="ref">ref</h3><ol><li>被用来给元素或子组件注册引用信息（<code>id</code>的替代者）</li><li>应用在<code>html</code>标签上获取的是真实的DOM元素，应用在组件标签上则是组件的实例对象<code>VueComponent</code></li><li>与<code>id</code>的区别在于，如果给组件标签使用<code>id</code>属性，并用<code>document.getElementById</code>，获取的是组件<code>&lt;template&gt;</code>内的根元素，也就是一个DOM元素，并不能获得组件的实例对象<code>VueComponent</code></li><li>使用方式<ul><li>标识：<code>&lt;h1 ref=&quot;xxx&quot;&gt;</code> 或者 <code>&lt;School ref=&quot;xxx&quot;&gt;&lt;/School&gt;</code></li><li>获取：<code>this.$refs.xxx</code></li></ul></li></ol><h3 id="props-2">props</h3><blockquote><p>用来接受组件标签中直接传入的数据。</p></blockquote><figure class="highlight dts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dts"><span class="hljs-symbol">props:</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-symbol">name:</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-symbol">type:</span>String,<br><span class="hljs-symbol">required:</span>true,<br><span class="hljs-punctuation">&#125;</span>,<br><span class="hljs-symbol">age:</span><span class="hljs-punctuation">&#123;</span><br><span class="hljs-symbol">type:</span>number,<br><span class="hljs-symbol">default:</span><span class="hljs-number">18</span>,<br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></div></td></tr></table></figure><ol><li>直接在组件标签中写接受到的数据，可以用<code>v-bind</code></li><li><code>prop</code>的优先级要高于<code>data</code></li><li><code>prop</code>是只读的，vue底层会监视到对<code>props</code>的修改，如果进行了修改就会发出警告，一定要修改的解决途径是，把<code>props</code>中的内容复制到<code>data</code>中一份，然后去修改<code>data</code>中的数据。</li></ol><h3 id="mixin">mixin</h3><p>功能：可以把多个组件共用的配置提取成一个混入对象</p><p>使用方法：</p><ol><li><code>src</code>目录下创建<code>mixin.js</code></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mixin1 = &#123;<br><span class="hljs-attr">methods</span>:&#123;&#125;,<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;&#125;,<br>&#125;<br></code></pre></div></td></tr></table></figure><ol start="2"><li>在组件中引入<code>mixin1</code></li></ol><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;mixin1&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../mixin&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript"><span class="hljs-keyword">return</span></span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript"><span class="hljs-attr">mixins</span>:[mixin1,]</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure><ol start="3"><li>注意点<ul><li>如果在<code>mixin</code>中和<code>data</code>中有重复定义，则<code>data</code>优先。</li><li>如果是生命周期钩子有重复定义，则取并集。</li></ul></li></ol><h3 id="plugins">plugins</h3><p><code>src</code>目录下创建<code>plugins.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br><span class="hljs-title function_">install</span>(<span class="hljs-params">Vue</span>)&#123;<br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">filter</span>()<br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>()<br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">mixin</span>()<br><span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><code>main.js</code>中使用插件</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> plugins <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./plugins&#x27;</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(plugins)<br></code></pre></div></td></tr></table></figure><ol><li>定义全局过滤器</li><li>定义全局指令</li><li>定义混入</li><li>在Vue原型上添加方法（<code>vm</code>和<code>VueComponents</code>都可以使用）</li></ol><h3 id="scoped样式">scoped样式</h3><p>作用：让样式在局部生效，防止多个组件使用相同选择器名称时发生冲突。</p><p>写法：<code>&lt;style scoped&gt;</code></p><h3 id="自定义事件和-emit">自定义事件和$emit</h3><blockquote><p>通过<code>$emit</code>和父组件给子组件绑定一个自定义事件实现：子给父传递数据</p><p>如下列代码中，父给子绑定的自定义事件为<code>PostName</code></p></blockquote><figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss"><span class="hljs-comment">//在父组件中：</span><br>&lt;Son <span class="hljs-keyword">@PostName</span>=<span class="hljs-string">&quot;getSonName&quot;</span>/&gt; <br>//&lt;Son <span class="hljs-attribute">v-on</span>:PostName=<span class="hljs-string">&quot;getSonName&quot;</span>&gt;<br><span class="hljs-attribute">methods</span>:&#123;<br><span class="hljs-built_in">getSonName</span>(name)&#123;<br>console<span class="hljs-selector-class">.log</span>(name)<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//在子组件中</span><br>methods:&#123;<br><span class="hljs-built_in">sendSonName</span>()&#123;<br>this.<span class="hljs-variable">$emit</span>(&#x27;PostName&#x27;,this.name,...params)<br>&#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><p>同时利用<code>ref</code>也可以实现 子组件传递数据给父组件 的过程</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//在父组件中</span><br>&lt;<span class="hljs-title class_">Son</span> ref=<span class="hljs-string">&quot;son&quot;</span>/&gt;<br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">getSonName</span>(<span class="hljs-params">name</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name)<br>&#125;<br>&#125;<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">son</span>.$on(<span class="hljs-string">&#x27;PostName&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">getSonName</span>)<br>&#125;<br><br><span class="hljs-comment">//在子组件中</span><br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">sendSonName</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;PostName&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,...params)<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>如果只想要传递一次数据</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//在父组件中：</span><br>&lt;<span class="hljs-title class_">Son</span> <span class="hljs-meta">@PostName</span>.<span class="hljs-property">once</span>=<span class="hljs-string">&quot;getSonName&quot;</span>/&gt; <br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">getSonName</span>(<span class="hljs-params">name</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name)<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//在父组件中</span><br>&lt;<span class="hljs-title class_">Son</span> ref=<span class="hljs-string">&quot;son&quot;</span>/&gt;<br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">getSonName</span>(<span class="hljs-params">name</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name)<br>&#125;<br>&#125;<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">son</span>.$once(<span class="hljs-string">&#x27;PostName&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">getSonName</span>)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>给子组件绑定原生事件的时候需要加上<code>.native</code></p><figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss">&lt;Son <span class="hljs-keyword">@PostName</span>.once=<span class="hljs-string">&quot;getSonName&quot;</span> <span class="hljs-keyword">@click</span>=<span class="hljs-string">&#x27;showInfo&#x27;</span>/&gt;<br><span class="hljs-attribute">methods</span>:&#123;<br><span class="hljs-built_in">getSonName</span>(name)&#123;<br>console<span class="hljs-selector-class">.log</span>(name)<br>&#125;,<br><span class="hljs-built_in">showInfo</span>()&#123;&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>在上述情况中，<code>click</code>属于是自定义事件</p><p>如果想要使它成为原生事件，可以使用<code>@click.native</code></p><h3 id="自定义事件的解绑">自定义事件的解绑</h3><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">//在父组件中：</span><br>&lt;<span class="hljs-title class_">Son</span> <span class="hljs-meta">@PostName</span>=<span class="hljs-string">&quot;getSonName&quot;</span> <span class="hljs-meta">@PostAge</span>=<span class="hljs-string">&quot;getSonAge&quot;</span>/&gt; <br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">getSonName</span>(<span class="hljs-params">name</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name);<br>&#125;,<br><span class="hljs-title function_">getSonAge</span>(<span class="hljs-params">age</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(age);<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//在子组件中</span><br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-title function_">sendSonName</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;PostName&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,...params)<br>&#125;,<br><span class="hljs-title function_">unbind</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.$off(<span class="hljs-string">&#x27;PostName&#x27;</span>); <br><span class="hljs-comment">//仅解绑一个自定义事件</span><br><span class="hljs-variable language_">this</span>.$off([<span class="hljs-string">&#x27;PostAge&#x27;</span>,<span class="hljs-string">&#x27;PostName&#x27;</span>]);<br><span class="hljs-comment">//解绑多个自定义事件,用数组的形式</span><br><span class="hljs-variable language_">this</span>.$off();<br><span class="hljs-comment">//不传参，即解绑所有的自定义事件</span><br>&#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h3 id="nextTick">$nextTick</h3><p><code>$nextTick(function()&#123;&#125;)</code>回调函数会在DOM节点更新完后再次执行</p><h3 id="vue中的过渡与动画">vue中的过渡与动画</h3><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml">//某个组件中<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">transition</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">appear</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">transition</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="slot-slot"><code>&lt;slot&gt;&lt;/slot&gt;</code></h3><blockquote><p>插槽是在组件标签内部添加DOM元素的一种技术</p></blockquote><h4 id="默认插槽">默认插槽</h4><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml">//App.vue中<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Category</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>123<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Category</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br>//Category.vue中<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><br></code></pre></div></td></tr></table></figure><ol><li>在 <code>&lt;slot&gt;&lt;/slot&gt;</code>的位置上 会放上  <code>&lt;div&gt;123&lt;div&gt;</code></li><li><code>&lt;slot&gt;&lt;/slot&gt;</code>内部也可以放上默认值，即如果在组件标签内部没有放DOM元素的时候，就用默认值。</li><li><code>&lt;div&gt;123&lt;div&gt;</code>的样式在即可以在<code>App.vue</code>中也可以在<code>Category.vue</code>中。</li></ol><h4 id="具名插槽">具名插槽</h4><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml">//App.vue中<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Category</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&#x27;center&#x27;</span>&gt;</span>123<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&#x27;footer&#x27;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&#x27;www.bitter-gourd.com&#x27;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Category</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br>//Category.vue中<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#x27;center&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#x27;footer&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br>//另一种写法<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot:footer</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><br></code></pre></div></td></tr></table></figure><ol><li>如果是在<code>&lt;template&gt;</code>标签中写<code>slot</code>，可以写成<code>v-slot:name</code>。</li></ol><h4 id="作用域插槽">作用域插槽</h4><figure class="highlight handlebars"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs handlebars"><span class="language-xml">//在App.vue中</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Category</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;items&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(g,index) in items.games&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;index&quot;</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">g</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">Category</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml">//在Category.vue中</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>游戏<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">:games</span>=<span class="hljs-string">&quot;games&quot;</span>&gt;</span>默认内容<span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-attr">games</span>:[<span class="hljs-string">&#x27;王者荣耀&#x27;</span>，<span class="hljs-string">&#x27;和平精英&#x27;</span>,<span class="hljs-string">&#x27;超级玛丽&#x27;</span>]</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure><ol><li>作用域插槽的作用是，当数据不在定义插槽内结构的组件身上，而在定义插槽位置的组件身上的时候，可以通过一些方式传递数据并让定义插槽内结构的组件使用这些数据。</li><li>上述代码中的<code>items</code>是一个对象，<code>:games='games'</code>中前者是<code>items</code>的属性。</li></ol><h1>Vue-cli</h1><h2 id="关于不同版本的vue">关于不同版本的vue</h2><ol><li><p><code>vue.js</code>和<code>vue.runtime.xxx.js</code>的区别：</p><p>(1). <code>vue.js</code>是完整版的<code>Vue</code>，包含：核心功能+模板解析器。</p><p>(2).<code>vue.runtime.xxx.js</code>是运行版的<code>Vue</code>，只包含：核心功能，没有模板解析器。</p></li></ol><h2 id="render"><code>render()</code></h2><ol><li>由于<code>vue.runtime.xxx.js</code>没有模板解析器，所以不能在<code>new Vue</code>中使用<code>template</code>配置项，需要使用<code>render</code>函数接收到<code>createElement</code>函数作为参数去指定具体内容。（只有在<code>main.js</code>入口文件中<code>new Vue</code>的时候会用到<code>render</code>）</li><li>组件中不需要用<code>render()</code>，因为组件中用到<code>&lt;template&gt;</code>标签，会有第三方库来解析标签中的代码。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//默认引入的是运行版的vue</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-comment">//render可以接受参数（function），需要有返回值</span><br><span class="hljs-title function_">render</span>(<span class="hljs-params">createElement</span>)&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;h1&#x27;</span>,<span class="hljs-string">&#x27;hello,render&#x27;</span>);<br>&#125;<br><span class="hljs-comment">//ES6的写法</span><br><span class="hljs-attr">render</span>:<span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-string">&#x27;h1&#x27;</span>,<span class="hljs-string">&#x27;hello,render&#x27;</span>)<br><span class="hljs-comment">//也可以在createElement中传入组件APP(变量)</span><br><span class="hljs-attr">render</span>:<span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-variable constant_">APP</span>)<br></code></pre></div></td></tr></table></figure><h2 id="Vue-cli默认配置">Vue-cli默认配置</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>仅查看<br>vue inspect &gt; output.js<br></code></pre></div></td></tr></table></figure><p><code>src</code>同级目录下新建<code>vue.config.js</code>文件来更改配置</p><h2 id="配置代理">配置代理</h2><h3 id="方法一">方法一</h3><p>在<code>vue.config.js</code>中添加如下配置</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">devServer:&#123;<br>proxy:<span class="hljs-string">&quot;http://localhost:5000&quot;</span><br>&#125;<br></code></pre></div></td></tr></table></figure><ol><li>优点：配置简单，请求资源时直接发给前端（8000）即可。</li><li>缺点：不能配置多个代理，不能灵活的控制请求是否走代理。</li><li>工作方式：若按照上述配置代理，当请求不存在的资源时，那么该请求会转发给服务器（优先匹配前端资源）</li></ol><h3 id="方法二">方法二</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">devServer:&#123;<br><span class="hljs-regexp">//</span>这样写的优势：克服了目标服务器单一的问题和<br><span class="hljs-regexp">//</span>自己端口文件存在影响用代理服务器获取目标服务器文件的错误<br>proxy:&#123;<br><span class="hljs-string">&#x27;/api&#x27;</span>:&#123;<br>target:<span class="hljs-string">&#x27;localhost:5000/api/&#x27;</span>,<br>pathRewrite:&#123;<span class="hljs-string">&#x27;^/api&#x27;</span>:<span class="hljs-string">&#x27;&#x27;</span>&#125;,<br>ws:true, <span class="hljs-regexp">//</span>用于支持websocket<br>changeOrigin:true, <span class="hljs-regexp">//</span>用于控制请求头中的host值<br>&#125;,<br>&#125;<br>&#125;<br>/*<br>changeOrigin设置为true时，服务器收到的请求头中的host为：<span class="hljs-number">5000</span><br>changeOrigin设置为false时，服务器收到的请求头中的host为：<span class="hljs-number">8080</span><br>changeOrigin的默认值为true<br>*/<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSS中的长度单位</title>
    <link href="/2022/05/21/CSS%E4%B8%AD%E7%9A%84%E9%95%BF%E5%BA%A6%E5%8D%95%E4%BD%8D/"/>
    <url>/2022/05/21/CSS%E4%B8%AD%E7%9A%84%E9%95%BF%E5%BA%A6%E5%8D%95%E4%BD%8D/</url>
    
    <content type="html"><![CDATA[<h1>长度单位px rem em vh vw</h1><h2 id="绝对长度">绝对长度</h2><h3 id="px">px</h3><p>px是像素值，是一个固定的长度，比如我们的米，厘米一样。</p><h2 id="相对长度">相对长度</h2><h3 id="为什么我们需要相对长度rem-em等？">为什么我们需要相对长度rem em等？</h3><p>固定长度已经不能满足我们现在的需求了。</p><p>举例：比如我们在缩小我们屏幕的时候，我们不仅仅是需要缩小我们的盒子的宽高，我们还想要让我们字体大小也随之缩小，这样用户体验会更好一点。</p><h3 id="rem">rem</h3><h4 id="rem-与-px-的计算关系">rem 与 px 的计算关系</h4><p>rem的值是px的倍数</p><p>默认情况下<code>font-size = 16px</code>,那么<code>1rem = 16px</code></p><h4 id="rem-如何修改与px的相对计算关系">rem 如何修改与px的相对计算关系</h4><p>我们可以在并且只能在<strong>html标签</strong>（因为html节点是根节点，就是rem里面的r：root）里面修改<code>font-size : 32px</code>， 从而<code>1rem = 32px</code></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">&lt;<span class="hljs-selector-tag">div</span> class=&quot;<span class="hljs-selector-tag">div</span>-rem&quot;&gt;rem&lt;/<span class="hljs-selector-tag">div</span>&gt;<br><br><span class="hljs-comment">/* rem的用法 */</span><br><span class="hljs-selector-tag">html</span>&#123;<br>    <span class="hljs-attribute">font-size</span>:<span class="hljs-number">16px</span>;  // <span class="hljs-number">1rem</span> = <span class="hljs-number">16px</span><br>&#125;<br><span class="hljs-selector-class">.div-rem</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">10rem</span>;    // <span class="hljs-number">10rem</span> = <span class="hljs-number">10</span> x <span class="hljs-number">16</span> = <span class="hljs-number">160px</span><br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">10rem</span>;   // <span class="hljs-number">10rem</span> = <span class="hljs-number">10</span> x <span class="hljs-number">16</span> = <span class="hljs-number">160px</span><br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1rem</span>; // <span class="hljs-number">1rem</span> = <span class="hljs-number">16px</span><br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#a58778</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="em">em</h3><h4 id="em-与-px-的计算关系">em 与 px 的计算关系</h4><p>em的值是px的倍数</p><p>默认情况下<code>font-size = 16px</code>,那么<code>1em = 16px</code></p><h4 id="em-如何修改与px的相对计算关系">em 如何修改与px的相对计算关系</h4><p>我们可以在自己元素上面修改<code>font-size : 32px</code>， 从而<code>1em = 32px</code></p><p>如果自己元素上面没有设置<code>font-size</code>, 我们也可以在父元素上面设置<code>font-size</code>，从而来影响自己元素（孩子元素）使用的em的值。</p><h5 id="rem-与-em-的区别">rem 与 em 的区别</h5><p>上面也正是rem 与 em的区别：</p><p>rem只能在html标签里面设置rem的依赖的值到底是多少</p><p>而em是可以在自己元素以及父级元素设置em依赖的值到底是多少</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">&lt;!<span class="hljs-attr">--em1--</span>&gt;<br>&lt;<span class="hljs-selector-tag">div</span> class=&quot;<span class="hljs-selector-tag">div</span>-<span class="hljs-selector-tag">em</span>&quot;&gt;<span class="hljs-selector-tag">em</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;<br><br>&lt;!<span class="hljs-attr">--em2--</span>&gt;<br>&lt;<span class="hljs-selector-tag">div</span> class=&quot;<span class="hljs-selector-tag">div</span>-<span class="hljs-selector-tag">em</span>-father&quot;&gt;<br>    &lt;<span class="hljs-selector-tag">div</span> class=&quot;<span class="hljs-selector-tag">div</span>-<span class="hljs-selector-tag">em</span>-child&quot;&gt;<span class="hljs-selector-tag">em</span> child&lt;/<span class="hljs-selector-tag">div</span>&gt;<br>&lt;/<span class="hljs-selector-tag">div</span>&gt;<br><br> <span class="hljs-comment">/* em的用法1：自己元素设置font-size的值来当作em的参照值 */</span><br><span class="hljs-selector-class">.div-em</span>&#123;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">32px</span>;  // <span class="hljs-number">1em</span> = <span class="hljs-number">32px</span><br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">10em</span>;      // <span class="hljs-number">10em</span> = <span class="hljs-number">10</span> x <span class="hljs-number">32</span> = <span class="hljs-number">320px</span><br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">10em</span>;     // <span class="hljs-number">10em</span> = <span class="hljs-number">10</span> x <span class="hljs-number">32</span> = <span class="hljs-number">320px</span><br>    <span class="hljs-attribute">background-color</span>: aquamarine;<br>&#125;<br><br> <span class="hljs-comment">/* em的用法2：子元素不设置，而父级元素设置font-size的值来当作em的参照值 */</span><br><span class="hljs-selector-class">.div-em-father</span>&#123;<br>    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">64px</span>;  // <span class="hljs-number">1em</span> = <span class="hljs-number">64px</span><br>&#125;<br><span class="hljs-selector-class">.div-em-child</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">10em</span>;     // <span class="hljs-number">10em</span> = <span class="hljs-number">10</span> x <span class="hljs-number">64</span> = <span class="hljs-number">640px</span><br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">10em</span>;    // <span class="hljs-number">10em</span> = <span class="hljs-number">10</span> x <span class="hljs-number">64</span> = <span class="hljs-number">640px</span><br>    <span class="hljs-attribute">background-color</span>: cadetblue;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="vh-vw">vh vw</h3><p>vh 和 vw 就是根据窗口的宽高，分成100等份，100vh就表示满高，50vh就表示一半高。</p><h5 id="那么vh-和-vw与百分比的区别是什么？">那么vh 和 vw与百分比的区别是什么？</h5><p>百分比是基于父元素的设置而言的，如果父元素为100px，那么子元素100%也就是100px。</p><p>而 vh 和 vw 始终是针对窗口的宽高。</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">&lt;<span class="hljs-selector-tag">div</span> class=&quot;<span class="hljs-selector-tag">div</span>-vh-vw&quot;&gt;<br>   &lt;<span class="hljs-selector-tag">div</span> class=&quot;<span class="hljs-selector-tag">div</span>-vh-vw-child&quot;&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;<br>&lt;/<span class="hljs-selector-tag">div</span>&gt;<br><br> <span class="hljs-comment">/* vh vw 的用法：视窗最为参照值 */</span><br><span class="hljs-selector-class">.div-vh-vw</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">10vw</span>;  // 视窗宽度的 <span class="hljs-number">1</span>/<span class="hljs-number">10</span><br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">10vh</span>;  // 视窗高度的 <span class="hljs-number">1</span>/<span class="hljs-number">10</span><br>    <span class="hljs-attribute">background-color</span>: pink;<br>&#125;<br><br><span class="hljs-comment">/* %百分比的用法：父元素的宽高作为参照值 */</span><br><span class="hljs-selector-class">.div-vh-vw-child</span>&#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">50%</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">50%</span>;<br>    <span class="hljs-attribute">background-color</span>: aliceblue;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="vmin-vmax">vmin vmax</h3><p>vmin它取的是相对于视口高度或宽度中*<strong>较小值</strong>的1/100</p><p>vmax它取的是相对于视口高度或宽度中<strong>较大值</strong>的1/100</p><h3 id="ex-ch">ex ch</h3><p>ex在开发中很少使用，1ex等于小写字母“x”的高度，但不同字体x的高度可能不同,取em值的一半作为ex值。</p><p>ch与ex类似，被定义为数字0的宽度。当无法确定数字0宽度时，取em值的一半作为ch值。</p>]]></content>
    
    
    <categories>
      
      <category>CSS和HTML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>git</title>
    <link href="/2022/05/19/git/"/>
    <url>/2022/05/19/git/</url>
    
    <content type="html"><![CDATA[<h1>Git</h1><h2 id="远程篇">远程篇</h2><h3 id="基本命令解释">基本命令解释</h3><p><code>git fetch</code> 并不会改变你本地仓库的状态。它不会更新你的 <code>main</code> 分支，也不会修改你磁盘上的文件。</p><p><code>git pull</code> 是 git fetch 和 git merge 的缩写。</p><h3 id="git-pull-rebase和git-pull处理历史偏差的区别"><code>git pull --rebase</code>和<code>git pull</code>处理历史偏差的区别</h3><h4 id="背景">背景</h4><p>假设你周一克隆了一个仓库，然后开始研发某个新功能。到周五时，你新功能开发测试完毕，可以发布了。但是 —— 天啊！你的同事这周写了一堆代码，还改了许多你的功能中使用的 API，这些变动会导致你新开发的功能变得不可用。但是他们已经将那些提交推送到远程仓库了，因此你的工作就变成了基于项目<strong>旧版</strong>的代码，与远程仓库最新的代码不匹配了。</p><p>这种情况下, <code>git push</code> 就不知道该如何操作了。如果你执行 <code>git push</code>，Git 应该让远程仓库回到星期一那天的状态吗？还是直接在新代码的基础上添加你的代码，亦或由于你的提交已经过时而直接忽略你的提交？</p><p>因为这情况（历史偏离）有许多的不确定性，Git 是不会允许你 <code>push</code> 变更的。实际上它会强制你先合并远程最新的代码，然后才能分享你的工作。我们必须人为决定新代码的内容。</p><p>在合并远程仓库的最新代码的时候我们有两个选择：</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql">git pull <span class="hljs-operator">=</span> git <span class="hljs-keyword">fetch</span> <span class="hljs-operator">+</span> git <span class="hljs-keyword">merge</span><br>git pull <span class="hljs-comment">--rebase = git fetch + git rebase</span><br></code></pre></div></td></tr></table></figure><p>如果在git pull的时候加上<code>rebase</code>参数，即<code>git pull --rebase</code>,这里表示把你的本地当前分支里的每个提交(commit)取消掉，并且把它们临时 保存为补丁(patch)(这些补丁放到&quot;.git/rebase&quot;目录中),然后把本地当前分支更新 为最新的&quot;origin&quot;分支，最后把保存的这些补丁应用到本地当前分支上。</p><p>用<code>rebase</code>还是不用<code>rebase</code>都可以实现代码的合并，用不用取决于你更重视哪一方的代码，如果认为origin是主要的，那么就加<code>rebase</code>，因为这样就能最大程度的保证origin代码不被你错误修改。</p><h3 id="什么是提PR？">什么是提PR？</h3><p>PR即pull request。</p><p>当你想更正别人仓库里的错误时，要走一个流程：</p><ol><li>先 fork 别人的仓库，相当于拷贝一份，不会有人直接让我们修改原仓库的。</li><li>clone 到本地分支，做一些 bug fix。</li><li>发起 pull request 给原仓库，让他看到你修改的 bug。</li><li>原仓库 review 这个 bug，如果是正确的话，就会 merge 到他自己的项目中。</li></ol><p>至此，整个 pull request 的过程就结束了。</p><h3 id="删除本地仓库">删除本地仓库</h3><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros"><span class="hljs-built_in">find</span> . -name <span class="hljs-string">&quot;.git&quot;</span> | xargs rm -Rf<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>开发环境配置</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Promise</title>
    <link href="/2022/05/17/Promise/"/>
    <url>/2022/05/17/Promise/</url>
    
    <content type="html"><![CDATA[<h1>Promise</h1><h2 id="Promise的理解">Promise的理解</h2><h3 id="Promise是什么？">Promise是什么？</h3><p>Promise是ES6规范下在JS中使用的进行异步编程的解决方案。</p><ol><li>Promise是一个构造函数。</li><li>Promise对象用来封装一个异步操作并可以获得其成功/失败的结果值。</li></ol><p>异步编程：</p><ol><li>fs文件操作。</li><li>数据库操作。</li><li>AJAX。</li><li>定时器。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//fs文件操作</span><br><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>).<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;./index.html&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err,data</span>)=&gt;</span>&#123;&#125;);<br><br><span class="hljs-comment">//axios发起Ajax请求</span><br>axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/axios-server&#x27;</span>,&#123;<br><span class="hljs-attr">username</span>:<span class="hljs-string">&#x27;admin&#x27;</span>,<br><span class="hljs-attr">password</span>:<span class="hljs-string">&#x27;12345&#x27;</span><br>&#125;,&#123;<br><span class="hljs-attr">params</span>:&#123;<br><span class="hljs-attr">a</span>:<span class="hljs-number">100</span>,<br><span class="hljs-attr">b</span>:<span class="hljs-number">200</span><br>&#125;,<br><span class="hljs-attr">headers</span>:&#123;<br><span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span>,<br>&#125;<br>&#125;);<br><br><span class="hljs-comment">//定时器</span><br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;&#125;,<span class="hljs-number">2000</span>);<br></code></pre></div></td></tr></table></figure><h4 id="Promise对象的值">Promise对象的值</h4><p><code>PromiseResult</code>保存的是异步任务成功或者失败的结果，只有resolve和reject可以对该值赋值。</p><h3 id="为什么要用Promise？">为什么要用Promise？</h3><h4 id="指定回调函数的方式更加灵活">指定回调函数的方式更加灵活</h4><ol><li><p>旧的方式：必须在启动异步任务前指定。</p></li><li><p>promise：启动异步任务 =&gt; 返回promise对象 =&gt; 给promise对象绑定回调函数（甚至可以在异步任务结束后指定多个）</p></li></ol><h4 id="支持链式调用，可以解决回调地狱问题">支持链式调用，可以解决回调地狱问题</h4><ol><li>回调地狱：回调函数嵌套调用，外部回调函数异步执行的结果是嵌套的回调函数执行的条件。</li><li>回调地狱的问题：不便于阅读、不便于异常处理。</li></ol><h2 id="使用Promise">使用Promise</h2><h4 id="API">API</h4><p>1.<code>Promise.excutor</code></p><p>excutor(执行器)  <code>(resolve,reject)=&gt;&#123;&#125;</code></p><p>excutor会在Promise内部立即同步调用，而异步操作在执行器中执行。</p><p>2.<code>Promise.prototype.then</code>方法</p><p><code>(onResolved,onRejected)=&gt;&#123;&#125;</code></p><p>指定用于得到成功value的成功回调和得到失败reason的失败回调，返回一个promise对象。</p><p>3.<code>Promise.prototype.catch</code>方法</p><p>得到失败reason的失败回调。</p><p>4.<code>Promise.resolve</code></p><p>该方法可以传入一个对象（非promise）将promise的状态转换为resolve（默认），但如果传入一个Promise对象且该对象的状态为reject，则会将promise的状态转换为reject。</p><p><strong>规则：</strong></p><p>如果传入的参数是非Promise类型的对象，则返回的结果为成功的Promise对象。</p><p>如果传入的参数是Promise对象，则参数的结果决定了resolve的结果。</p><p>5.<code>Promise.reject</code></p><p>与<code>Promise.resolve</code>不同的在于，即使传入状态为resolve的promise对象，该promise的状态仍然为reject。并且这个promise会成为它返回的reject的reason。</p><p>总而言之：使用该方法的promise的状态永远是reject，且传入什么reason就是什么。</p><p>6.<code>Promise.all(promises)=&gt;&#123;&#125;</code></p><p><code>(promises)=&gt;&#123;&#125;</code>promises是包含n个promise的数组</p><p>该方法会返回一个新的promise，只有当所有的promise都成功才成功，只要有一个失败了，就直接失败。</p><p>成功的值是所有promise的resolve状态传入的值。</p><p>7.<code>Promise.race(promises)=&gt;&#123;&#125;</code></p><p><code>(promises)=&gt;&#123;&#125;</code>promises是包含n个promise的数组</p><p>该方法会返回一个新的promise，第一个完成的promise的结果状态就是最终的结果状态。</p><p>成功的值是第一个完成的promise传入的值。</p><h4 id="定时器">定时器</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">rand</span>(<span class="hljs-params">min,max</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()*(max-min+<span class="hljs-number">1</span>)+min-<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">//resolve和reject本身就是函数类型的数据</span><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br><span class="hljs-comment">//在promise函数内部可以封装异步任务</span><br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-keyword">let</span> n = <span class="hljs-title function_">rand</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>);<br>        <span class="hljs-keyword">if</span>(n &lt;= <span class="hljs-number">30</span>)&#123;<br>            <span class="hljs-title function_">resolve</span>(n);  <span class="hljs-comment">//可以将promise对象的状态设置为成功，并传递参数</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_">reject</span>(n);<span class="hljs-comment">//可以将promise对象的状态设置为失败,并传递参数</span><br>        &#125;<br>    &#125;,<span class="hljs-number">2000</span>);<br>&#125;);<br><span class="hljs-comment">//第一个回调是promise对象状态为成功的时候的回调</span><br><span class="hljs-comment">//第二个回调是promise对象状态为失败的时候的回调</span><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value</span>)=&gt;</span>&#123;<br>    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;congratulations！&#x27;</span> + <span class="hljs-string">&#x27;value&#x27;</span>);   <span class="hljs-comment">//value和reason为形参</span><br>&#125;,(reason)=&#123;<br>    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;I am so sorry for you.&#x27;</span>+<span class="hljs-string">&#x27;reason&#x27;</span>);<br>&#125;);<br></code></pre></div></td></tr></table></figure><h4 id="fs模块">fs模块</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><br><span class="hljs-comment">//回调函数形式</span><br>fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;./content.txt&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err,data</span>)=&gt;</span>&#123;<br> <span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;<br> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data.<span class="hljs-title function_">toString</span>());<br>&#125;);<br><br><span class="hljs-comment">//promise封装</span><br><span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>    fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;./content.txt&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err,data</span>)=&gt;</span>&#123;<br>        <span class="hljs-keyword">if</span>(err) <span class="hljs-title function_">reject</span>(err);<br>        <span class="hljs-title function_">resolve</span>(data);<br>    &#125;);<br>&#125;);<br><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-title function_">toString</span>());<br>&#125;,<span class="hljs-function"><span class="hljs-params">reason</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reason);<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="AJAX请求">AJAX请求</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//原生AJAX</span><br><span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#btn&#x27;</span>);<br>btn.<span class="hljs-title function_">addEventListner</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>);<br>xhr.<span class="hljs-title function_">send</span>();<br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>)&#123;<br><span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">statue</span> &lt; <span class="hljs-number">300</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">response</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">status</span>);<br>&#125;<br>&#125;<br>&#125;<br>&#125;);<br><br><span class="hljs-comment">//promise封装</span><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">reslove,reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>);<br>xhr.<span class="hljs-title function_">send</span>();<br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>)&#123;<br><span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">statue</span> &lt; <span class="hljs-number">300</span>)&#123;<br><span class="hljs-title function_">resolve</span>(xhr.<span class="hljs-property">response</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-title function_">reject</span>(xhr.<span class="hljs-property">status</span>);<br>&#125;<br>&#125;<br>&#125;<br>&#125;);<br><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);<br>&#125;,<span class="hljs-function"><span class="hljs-params">reason</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(reason); <span class="hljs-comment">//向 Web 控制台输出一条警告信息。</span><br>&#125;);<br></code></pre></div></td></tr></table></figure><h4 id="Promise封装fs函数">Promise封装fs函数</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//封装一个函数mineReadFile</span><br><span class="hljs-comment">//参数：path 文件路径</span><br><span class="hljs-comment">//返回：promise 对象</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">myReadFile</span>(<span class="hljs-params">path</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>        <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>).<span class="hljs-title function_">readFile</span>(path,<span class="hljs-function">(<span class="hljs-params">err,data</span>)=&gt;</span>&#123;<br>            <span class="hljs-keyword">if</span>(err) <span class="hljs-title function_">reject</span>(err);<br>            <span class="hljs-title function_">resolve</span>(data);<br>        &#125;);<br>    &#125;);<br>&#125;<br><br><span class="hljs-title function_">myReadFile</span>(<span class="hljs-string">&#x27;./content.txt&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-title function_">toString</span>());<br>&#125;,<span class="hljs-function"><span class="hljs-params">reason</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reason);<br>&#125;);<br></code></pre></div></td></tr></table></figure><h4 id="Promise封装ajax发出GET请求">Promise封装ajax发出GET请求</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sendAJAX</span>(<span class="hljs-params">url</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>        <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;GET&quot;</span>,url);<br>        xhr.<span class="hljs-title function_">send</span>();<br>        xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>)&#123;<br>                <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;=<span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>)&#123;<br>                    <span class="hljs-title function_">resolve</span>(xhr);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-title function_">reject</span>();<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;);<br>&#125;<br><span class="hljs-title function_">sendAJAX</span>(<span class="hljs-string">&#x27;     &#x27;</span>)<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);<br>&#125;,<span class="hljs-function"><span class="hljs-params">reason</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(reason);<br>&#125;);<br></code></pre></div></td></tr></table></figure><h4 id="util-promisify方法"><code>util.promisify</code>方法</h4><p><code>util.promisify</code>方法是一种将回调函数转化为promise的工具。</p><p>传入一个遵循常见的错误优先的回调风格的函数，并返回一个返回promise版本。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;util&#x27;</span>);<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><span class="hljs-keyword">let</span> myReadFile = util.<span class="hljs-title function_">promisify</span>(fs.<span class="hljs-property">readFile</span>);<br><span class="hljs-title function_">myReadFile</span>(<span class="hljs-string">&#x27;./content.txt&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-title function_">toString</span>());<br>&#125;,<span class="hljs-function"><span class="hljs-params">reason</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reason);<br>&#125;);<br></code></pre></div></td></tr></table></figure><h2 id="Q-A">Q&amp;A</h2><h5 id="Q1：一个promise指定多个成功-失败回调函数，都会调用吗？">Q1：一个promise指定多个成功/失败回调函数，都会调用吗？</h5><p>A1：是的，都会调用，当promise改变为对应状态时都会调用。</p><h5 id="Q2：改变promise状态和指定回调函数谁先谁后？">Q2：改变promise状态和指定回调函数谁先谁后？</h5><p>A2：都有可能，正常情况下是先指定回调再改变状态，但也可以先改变状态再指定回调。</p><h5 id="Q3：如果先改变状态再指定回调？什么时候得到数据？">Q3：如果先改变状态再指定回调？什么时候得到数据？</h5><p>A3：先在执行器中直接调用<code>resolve()/reject()</code>，再延迟更长时间调用<code>then()</code>。如果是先指定回调，则当状态发生改变时，回调函数就会调用，得到数据。如果是先改变的状态，则当指定调用的时候，回调函数就会调用，得到数据。</p><h5 id="Q4：promise-then-返回的新promise的结果状态由什么决定？">Q4：<code>promise.then()</code>返回的新promise的结果状态由什么决定？</h5><p>A4：1.如果抛出异常，则新promise变为rejected，reason为抛出的异常。<code>throw</code></p><p>​2.如果返回的是非promise的任意值，新promise变为resolved，value为返回的值。</p><p>​3.如果返回的是另一个新promise，则此promise的结果就会成为新promise的结果。</p><h5 id="Q5：promise如何串联多个操作任务？">Q5：promise如何串联多个操作任务？</h5><p>A5：利用then的链式调用串连多个同步/异步任务。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;OK&#x27;</span>);<br>    &#125;,<span class="hljs-number">1000</span>);<br>&#125;);<br><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>       <span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;success&#x27;</span>);<br>   &#125;);<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">//success</span><br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">//undefined  </span><br>&#125;)<span class="hljs-comment">//因为.then会返回一个新的promise，但这个promise没有resolve</span><br></code></pre></div></td></tr></table></figure><h5 id="Q6：什么是promise异常穿透？">Q6：什么是promise异常穿透？</h5><p>A6：当使用promise的then链式回调时，可以在最后指定失败的回调，前面任何操作作出了异常，都会传到最后失败的回调里面。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-title function_">reject</span>(<span class="hljs-string">&#x27;err&#x27;</span>);<br>&#125;,<span class="hljs-number">1000</span>);<br>&#125;);<br><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">111</span>);<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">222</span>);<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">333</span>);<br>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">reason</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(reason);  <span class="hljs-comment">//err</span><br>&#125;)<br></code></pre></div></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;OK&#x27;</span>);<br>&#125;,<span class="hljs-number">1000</span>);<br>&#125;);<br><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-string">&#x27;error&#x27;</span><br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">222</span>);<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">333</span>);<br>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">reason</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(reason);  <span class="hljs-comment">//error</span><br>&#125;)<br></code></pre></div></td></tr></table></figure><h5 id="Q7：什么是promise链？如何中断promise链？">Q7：什么是promise链？如何中断promise链？</h5><p>A7：1.当使用promise的then链式调用时，在中间中断，不再调用后面的回调函数。</p><p>​2.在回调函数中返回一个pendding状态的promise对象。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;OK&#x27;</span>);<br>&#125;,<span class="hljs-number">1000</span>);<br>&#125;);<br><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">111</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">()=&gt;</span>&#123;&#125;);<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">222</span>);<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">333</span>);<br>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">reason</span>=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(reason); <br>&#125;)<br><span class="hljs-comment">//111</span><br></code></pre></div></td></tr></table></figure><h2 id="手写promise（class封装）">手写promise（class封装）</h2><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Promise</span> &#123;<br>    <span class="hljs-comment">//构造方法</span><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) &#123;<br>        <span class="hljs-comment">//添加内置属性</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">PromiseState</span> = <span class="hljs-string">&#x27;pending&#x27;</span>;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">PromiseResult</span> = <span class="hljs-literal">null</span>;<br>        <span class="hljs-comment">// this.callback=&#123;&#125;; </span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">callbacks</span> = [];  <span class="hljs-comment">//需要来保存多个回调函数</span><br>        <span class="hljs-keyword">let</span> _this = <span class="hljs-variable language_">this</span>;<br><br><br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-params">data</span>) &#123;<br>            <span class="hljs-comment">//判断状态，来确保只能从pending更改至fulfilled或rejected</span><br>            <span class="hljs-keyword">if</span> (_this.<span class="hljs-property">PromiseState</span> != <span class="hljs-string">&#x27;pending&#x27;</span>) <span class="hljs-keyword">return</span>;<br>            <span class="hljs-comment">//1.修改对象的状态（promiseState）</span><br>            _this.<span class="hljs-property">PromiseState</span> = <span class="hljs-string">&#x27;fulfilled&#x27;</span>;  <span class="hljs-comment">//这里的this指向的是调用者</span><br>            <span class="hljs-comment">//2.设置对象的结果值（promiseResult）</span><br>            _this.<span class="hljs-property">PromiseResult</span> = data;<br>            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                _this.<span class="hljs-property">callbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>                    item.<span class="hljs-title function_">onResolved</span>(data);<br>                &#125;)<br>            &#125;)<br>            <span class="hljs-comment">//item是当前forEach方法正在处理的元素</span><br>        &#125;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">reject</span>(<span class="hljs-params">data</span>) &#123;<br>            <span class="hljs-keyword">if</span> (_this.<span class="hljs-property">PromiseState</span> != <span class="hljs-string">&#x27;pending&#x27;</span>) <span class="hljs-keyword">return</span>;<br>            _this.<span class="hljs-property">PromiseState</span> = <span class="hljs-string">&#x27;reject&#x27;</span>;<br>            _this.<span class="hljs-property">PromiseResult</span> = data;<br>            <span class="hljs-comment">// if (_this.callback.onRejected) &#123;</span><br>            <span class="hljs-comment">//     _this.callback.onRejected(data);</span><br>            <span class="hljs-comment">//     //或者_this.callback.onRejected(_this.PromiseResult);</span><br>            <span class="hljs-comment">// &#125;</span><br>            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                _this.<span class="hljs-property">callbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>                    item.<span class="hljs-title function_">onRejected</span>(data);<br>                &#125;)<br>            &#125;)<br>        &#125;<br><br>        <span class="hljs-comment">//throw‘error’ 来改变promise状态</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//同步调用执行器函数</span><br>            <span class="hljs-title function_">executor</span>(resolve, reject);   <span class="hljs-comment">//executor同步调用的时候 相当于  resolve();  调用者为window</span><br>        &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-title function_">reject</span>(e);<br>        &#125;<br>    &#125;<br>    <span class="hljs-title function_">then</span>(<span class="hljs-params">onResolved, onRejected</span>) &#123;<br>        <span class="hljs-keyword">const</span> _this = <span class="hljs-variable language_">this</span>;<br>        <span class="hljs-comment">//判断回调函数参数，因为在实现异常穿透的时候，可以允许不传onRejected</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> onRejected !== <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>            onRejected = <span class="hljs-function"><span class="hljs-params">reason</span> =&gt;</span> &#123;<br>                <span class="hljs-keyword">throw</span> reason;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">//如果不传onResolved，也需要实现值传递，就补上一个return value这个then产生的promise的状态为resolve</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> onResolved !== <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>            onResolved = <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> value;<br>            <span class="hljs-comment">//箭头函数的简写形式 (value) =&gt; &#123;return value&#125;</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>            <span class="hljs-comment">//封装函数来判断p.then内返回的result为promise或者其它</span><br>            <span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">type</span>) &#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">let</span> result = <span class="hljs-title function_">type</span>(_this.<span class="hljs-property">PromiseResult</span>);<br>                    <span class="hljs-keyword">if</span> (result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span>) &#123;<br>                        <span class="hljs-comment">//如果是promise对象</span><br>                        result.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> &#123;<br>                            <span class="hljs-title function_">resolve</span>(v);<br>                        &#125;, <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> &#123;<br>                            <span class="hljs-title function_">reject</span>(r);<br>                        &#125;)<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-title function_">resolve</span>(result);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>                    <span class="hljs-title function_">reject</span>(e);<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">//调用回调函数</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">PromiseState</span> === <span class="hljs-string">&#x27;fulfilled&#x27;</span>) &#123;<br>                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                    <span class="hljs-title function_">callback</span>(onResolved);<br>                &#125;); <span class="hljs-comment">//因为promise.then方法内的函数是异步的</span><br>            &#125;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">PromiseState</span> === <span class="hljs-string">&#x27;rejected&#x27;</span>) &#123;<br>                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                    <span class="hljs-title function_">callback</span>(onRejected);<br>                &#125;);<br>            &#125;<br>            <span class="hljs-comment">//判断为 pending 来应对异步任务的情况</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">PromiseState</span> === <span class="hljs-string">&#x27;pending&#x27;</span>) &#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">callbacks</span>.<span class="hljs-title function_">push</span>(&#123;<br>                    <span class="hljs-attr">onResolved</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                        <span class="hljs-title function_">callback</span>(onResolved);<br>                    &#125;,<br>                    <span class="hljs-attr">onRejected</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                        <span class="hljs-title function_">callback</span>(onRejected);<br>                    &#125;<br>                &#125;);<br>            &#125;<br><br>        &#125;)<br>    &#125;<br>    <span class="hljs-keyword">catch</span>(<span class="hljs-title class_">OnRejected</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">undefined</span>, onRejected);<br>    &#125;<br>    <span class="hljs-comment">//属于静态对象，而不是实例成员</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-params">value</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span>) &#123;<br>                value.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> &#123;<br>                    <span class="hljs-title function_">resolve</span>(v);<br>                &#125;, <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> &#123;<br>                    <span class="hljs-title function_">reject</span>(r);<br>                &#125;)<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-title function_">resolve</span>(value);<br>            &#125;<br>        &#125;);<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-title function_">reject</span>(<span class="hljs-params">reason</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>            <span class="hljs-title function_">reject</span>(reason);<br>        &#125;);<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-title function_">all</span>(<span class="hljs-params">promises</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, rejetc</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">let</span> arr = [];<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; promises.<span class="hljs-property">length</span>; i++) &#123;<br>                promises[i].<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> &#123;<br>                    count++;<br>                    arr[i] = v;<br>                    <span class="hljs-keyword">if</span> (count === promises.<span class="hljs-property">length</span>) &#123;<br>                        <span class="hljs-title function_">resolve</span>(arr);<br>                    &#125;<br>                &#125;, <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> &#123;<br>                    <span class="hljs-title function_">reject</span>(r);<br>                &#125;);<br>            &#125;<br>        &#125;);<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-title function_">race</span>(<span class="hljs-params">promises</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, rejetc</span>) =&gt;</span> &#123;<br>            promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>                item.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> &#123;<br>                    <span class="hljs-title function_">resolve</span>(v);<br>                &#125;, <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> &#123;<br>                    <span class="hljs-title function_">reject</span>(r);<br>                &#125;)<br>            &#125;)<br>        &#125;)<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="async与await">async与await</h2><h3 id="async函数">async函数</h3><ol><li>函数的返回值为promise对象</li><li>promise对象的结果由async函数执行的返回值决定。规则同then。</li></ol><h3 id="awit表达式">awit表达式</h3><ol><li>await右侧的表达式一般为promise对象，但也可以是其它的值。</li><li>如果表达式是promise对象，awit返回的是promise成功的值。</li><li>如果表达式是其它值，直接将此值作为await的返回值。</li></ol><h3 id="用法">用法</h3><ol><li>await必须写在async函数中，但async函数中可以没有await</li><li>如果await的promise失败了，就会抛出异常，需要通过try…catch捕获处理。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> ()=&gt;&#123;<br><span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;OK&#x27;</span>);<br>    &#125;)<br>    <span class="hljs-keyword">let</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>        <span class="hljs-title function_">reject</span>(<span class="hljs-string">&#x27;error&#x27;</span>);<br>    &#125;)<br>    <span class="hljs-comment">//1.右侧为promise且状态为成功的情况，await会返回value</span><br>    <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> p;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);  <span class="hljs-comment">//OK</span><br>    <span class="hljs-comment">//2.右侧为其它类型的数据，是什么返回什么</span><br>    <span class="hljs-keyword">let</span> res2 = <span class="hljs-keyword">await</span> <span class="hljs-number">20</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res2); <span class="hljs-comment">//20</span><br>    <span class="hljs-comment">//3.右侧为promise且状态为失败的情况</span><br>    <span class="hljs-keyword">let</span> res3 = <span class="hljs-keyword">await</span> p2;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res3);  <span class="hljs-comment">//报错，需要使用try...catch的方式捕获</span><br>    <span class="hljs-keyword">try</span>&#123;<br>        <span class="hljs-keyword">let</span> res4 = <span class="hljs-keyword">await</span> p2；<br>    &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);  <span class="hljs-comment">//error</span><br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="async与await结合读取文件">async与await结合读取文件</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//需求：读取三个文件内容并合在一起</span><br><br><span class="hljs-comment">//1.回调函数的方式</span><br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br>fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;./1.html&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err,data1</span>)=&gt;</span>&#123;<br>    <span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;<br>     fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;./2.html&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err,data2</span>)=&gt;</span>&#123;<br>    <span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;<br>            fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;./3.html&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err,data3</span>)=&gt;</span>&#123;<br>    <span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data1 + data2 + data3);<br>&#125;);<br>&#125;);<br>&#125;);<br><span class="hljs-comment">//async和await的运用</span><br><span class="hljs-keyword">const</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;util&#x27;</span>);<br><span class="hljs-keyword">const</span> myReadFile = util.<span class="hljs-title function_">promisify</span>(fs.<span class="hljs-property">readFile</span>);<br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">try</span>&#123;<br><span class="hljs-keyword">let</span> data1 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">myReadFile</span>(<span class="hljs-string">&#x27;./1.html&#x27;</span>);<br>    <span class="hljs-keyword">let</span> data2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">myReadFile</span>(<span class="hljs-string">&#x27;./2.html&#x27;</span>); <br>    <span class="hljs-keyword">let</span> data3 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">myReadFile</span>(<span class="hljs-string">&#x27;./3.html&#x27;</span>);<br>    &#125;<span class="hljs-keyword">catch</span>(e)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);<br>    &#125;<br>&#125;<br><span class="hljs-title function_">main</span>();<br></code></pre></div></td></tr></table></figure><h3 id="async和await结合发送Ajax请求">async和await结合发送Ajax请求</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">senAjax</span>(<span class="hljs-params">url</span>)&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>);<br>xhr.<span class="hljs-title function_">send</span>();<br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>)&#123;<br><span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">statue</span> &lt; <span class="hljs-number">300</span>)&#123;<br><span class="hljs-title function_">resolve</span>(xhr.<span class="hljs-property">response</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-title function_">reject</span>(xhr.<span class="hljs-property">status</span>);<br>&#125;<br>&#125;<br>&#125;<br>&#125;)<br>&#125;<br><span class="hljs-keyword">let</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">let</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">sendAjax</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<br>&#125;)<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Axios</title>
    <link href="/2022/05/17/axios/"/>
    <url>/2022/05/17/axios/</url>
    
    <content type="html"><![CDATA[<h1>Axios</h1><h3 id="介绍-2">介绍</h3><p>Axios 是一个基于 promise 的网络请求库，可以用于浏览器和 node.js。</p><p><a href="https://axios-http.com/zh/docs/intro">中文文档</a></p><h3 id="设置默认配置">设置默认配置</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//默认请求配置</span><br>axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">method</span> = <span class="hljs-string">&#x27;GET&#x27;</span>;<br>axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">baseURL</span> = <span class="hljs-string">&#x27;http://localhost:3000&#x27;</span>;<br>axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">params</span> = &#123;<span class="hljs-attr">id</span>:<span class="hljs-number">100</span>&#125;;<br>axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">timeout</span> = <span class="hljs-number">3000</span>;<br></code></pre></div></td></tr></table></figure><h3 id="axios实例对象">axios实例对象</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> instance = axios.<span class="hljs-title function_">create</span>(&#123;<br>  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">&#x27;https://some-domain.com/api/&#x27;</span>,<br>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">1000</span>,<br>  <span class="hljs-attr">headers</span>: &#123;<span class="hljs-string">&#x27;X-Custom-Header&#x27;</span>: <span class="hljs-string">&#x27;foobar&#x27;</span>&#125;<br>&#125;);<br><br><span class="hljs-comment">//再直接用instance对象的方法</span><br><span class="hljs-title function_">instance</span>(&#123;<br>    <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;/example&#x27;</span>,<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>&#125;)<br><span class="hljs-comment">//也可以用封装好的内置方法</span><br>instance.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/example&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>);<br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="axios拦截器-interceptors">axios拦截器(interceptors)</h3><p>作用：在请求或响应被 then 或 catch 处理前拦截它们。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 添加请求拦截器</span><br>axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">config</span>) &#123;<br>    <span class="hljs-comment">// 在发送请求之前做些什么   顺序1</span><br>    <span class="hljs-keyword">return</span> config;<br>  &#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) &#123;<br>    <span class="hljs-comment">// 对请求错误做些什么</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);<br>&#125;);<br><br><span class="hljs-comment">// 添加响应拦截器</span><br>axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) &#123;<br>    <span class="hljs-comment">// 2xx 范围内的状态码都会触发该函数。  顺序2</span><br>    <span class="hljs-comment">// 对响应数据做点什么</span><br>    <span class="hljs-keyword">return</span> response;<br>  &#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) &#123;<br>    <span class="hljs-comment">// 超出 2xx 范围的状态码都会触发该函数。</span><br>    <span class="hljs-comment">// 对响应错误做点什么</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);<br>&#125;);<br><br><span class="hljs-title function_">axios</span>(&#123;<br>    <span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;GET&#x27;</span>,<br>    <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;xxx&#x27;</span><br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span>=&gt;</span>&#123;<br>    <span class="hljs-comment">// 顺序3</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>&#125;)<br></code></pre></div></td></tr></table></figure><p><code>axios.interceptors.request.use</code>也有两个函数作为参数，与<code>promise.then</code>方法相似。</p><h3 id="axios取消请求">axios取消请求</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> btns = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br><span class="hljs-comment">//声明全局变量</span><br><span class="hljs-keyword">let</span> cencel = <span class="hljs-literal">null</span>;<br>btns[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-comment">//在发送请求之前先检测上一次请求是否完成</span><br>    <span class="hljs-keyword">if</span>(cancel != <span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-comment">//取消上一次的请求</span><br>        <span class="hljs-title function_">cancel</span>();<br>    &#125;<br>    <span class="hljs-title function_">axios</span>(&#123;<br>        <span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;GET&#x27;</span>,<br>        <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-comment">//添加配置对象的属性</span><br>   cancelToken：<span class="hljs-keyword">new</span> axios.<span class="hljs-title class_">CancelToken</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>)&#123;<br>        <span class="hljs-comment">//将c的值赋给 cancel</span><br>        cancel = c;<br>    )&#125;<br>    &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span>&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>        <span class="hljs-comment">//完成请求后将cancel初始化</span><br>        cancel = <span class="hljs-literal">null</span>;<br>    &#125;)<br>&#125;<br><br>btns[<span class="hljs-number">1</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-comment">//取消请求</span><br>    <span class="hljs-title function_">cancel</span>();<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="axios的创建过程">axios的创建过程</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Axios</span>(<span class="hljs-params">config</span>)&#123;<br>    <span class="hljs-comment">//初始化</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaults</span> = config;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span> = &#123;<br>        <span class="hljs-attr">request</span>:&#123;&#125;,<br>        <span class="hljs-attr">response</span>:&#123;&#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//原型添加方法</span><br><span class="hljs-title class_">Axios</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">request</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;发送AJAX请求，请求的类型为&#x27;</span>+ config.<span class="hljs-property">method</span>)；<br>&#125;;<br><span class="hljs-title class_">Axios</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">get</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(&#123;<span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;GET&#x27;</span>&#125;);<br>&#125;;<br><span class="hljs-title class_">Axios</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">post</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(&#123;<span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;POST&#x27;</span>&#125;);<br>&#125;;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">createInstance</span>(<span class="hljs-params">config</span>)&#123;<br>    <span class="hljs-keyword">let</span> context = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Axios</span>(config);<br>    <span class="hljs-comment">//context 是一个对象 可以 context.get()；但不能 context()</span><br>    <span class="hljs-keyword">let</span> instance = <span class="hljs-title class_">Axios</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">bind</span>(context);<br>    <span class="hljs-comment">//instance 是一个函数 可以 instance(&#123;&#125;); 但不能 instance.get()</span><br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-title class_">Axios</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span>=&gt;</span>&#123;<br>        instance[key] = <span class="hljs-title class_">Axios</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>[ket].<span class="hljs-title function_">bind</span>(context);<br>        <span class="hljs-comment">//get post request 方法在使用的时候 内部的this均指向实例对象</span><br>    &#125;)<br>    <span class="hljs-comment">//为instance 函数对象添加属性 default 与 interceptors</span><br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(context).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span>=&gt;</span>&#123;<br>        instance[key] = context[key];<br>        <span class="hljs-comment">//把context中的属性放到instance下面</span><br>    &#125;);<br>    <span class="hljs-keyword">return</span> instance;<br>&#125;<br><br><span class="hljs-comment">//总结：需要创建axios 既可以把它当对象来使用也可以把它当函数来使用</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>前后端交互</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VScode Tips</title>
    <link href="/2022/05/15/VScode-Tips/"/>
    <url>/2022/05/15/VScode-Tips/</url>
    
    <content type="html"><![CDATA[<h1>VScode Tips</h1><h2 id="好用的快捷键">好用的快捷键</h2><ol><li><p><strong><code>Alt+Shift+L</code></strong> ：编辑相同的内容</p></li><li><p><strong><code>Alt+鼠标</code></strong>：多行编辑</p></li><li><p><strong><code>Ctrl+Shift+i</code></strong>：linux下格式化代码</p></li></ol><h2 id="前端相关">前端相关</h2><h3 id="快速创建自带框架的html文件">快速创建自带框架的html文件</h3><p>先新建一个.html文件，有两种方法可以创建：</p><ol><li><strong><code>！+ 回车</code></strong></li></ol><p><img src="!+%E5%9B%9E%E8%BD%A6.png" alt="!+回车"></p><ol start="2"><li><code>html:5</code></li></ol><p><img src="html.png" alt="html:5"></p><p>两种方式创建的自带框架的html文件是一样的。</p><p><img src="%E7%BB%93%E6%9E%9C.png" alt="结果"></p><h3 id="缩进-tab-size-调整为2个空格">缩进(tab size)调整为2个空格</h3><ol><li>打开<code>setting.json</code></li><li>写入如下代码：</li></ol><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json"><span class="hljs-attr">&quot;editor.detectIndentation&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;editor.insertSpaces&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">false</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;editor.tabSize&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>开发环境配置</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ajax</title>
    <link href="/2022/05/15/Ajax/"/>
    <url>/2022/05/15/Ajax/</url>
    
    <content type="html"><![CDATA[<h1>Ajax</h1><h3 id="什么是Ajax">什么是Ajax</h3><p>Ajax的全称是Asynchronous Javascript And XML（异步Javascript 和 XML）</p><p>通俗的理解：在网页中利用XMLHttpRequest对象和服务器进行数据交互的方式，就是Ajax。</p><p>最大的优势：无刷新获取数据。</p><h4 id="Ajax的优点">Ajax的优点</h4><ol><li>可以无需刷新页面而与服务器端进行通信。</li><li>允许你根据用户事件来更新部分页面内容。</li></ol><h4 id="Ajax的缺点">Ajax的缺点</h4><ol><li>没有浏览历史，不能回退。</li><li>存在跨域问题（同源）。</li><li>SEO不友好。（搜索引擎优化，页面源代码中无数据）</li></ol><h3 id="XML">XML</h3><p>XML是可扩展标记语言，被设计用来传输和存储数据。</p><p>XML和HTML类似，不同是HTML中都是预定义标签，XML中没有预定义标签全是自定义标签。</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">student</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>孙悟空<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>18<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">gender</span>&gt;</span>男<span class="hljs-tag">&lt;/<span class="hljs-name">gender</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">student</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>现在在数据传递、解析的时候已经用JSON了</p><h3 id="IE浏览器缓存问题">IE浏览器缓存问题</h3><p>IE浏览器会对Ajax返回的结果做一个缓存，等下一次再进行ajax请求的时候，会使用本地缓存的信息，而不是服务器返回的。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;result&#x27;</span>);<br>result.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mouseover&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>       <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>       <span class="hljs-comment">//xhr.open(&#x27;POST&#x27;, &#x27;http://127.0.0.1:8000/ie&#x27;);</span><br>       <span class="hljs-comment">//解决方案，加一个时间，会让IE浏览器明白这是最新的请求，就不会走缓存。</span><br>       xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;http://127.0.0.1:8000/ie?t=&#x27;</span>+<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>());<br>       xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>);<br>       xhr.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;a=100&amp;b=200&amp;c=300&#x27;</span>);<br>       xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>           <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) &#123;<br>               <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>                   result.<span class="hljs-property">innerHTML</span> = xhr.<span class="hljs-property">response</span>;<br>               &#125;<br>           &#125;<br>       &#125;<br>&#125;);<br></code></pre></div></td></tr></table></figure><h3 id="取消请求">取消请求</h3><h3 id="jQury中的Ajax">jQury中的Ajax</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">$(<span class="hljs-string">&#x27;button&#x27;</span>).<span class="hljs-title function_">eq</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>$.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;http://127.0.0.1:8000/jquery-server&#x27;</span>,&#123;<span class="hljs-attr">a</span>:<span class="hljs-number">100</span>,<span class="hljs-attr">b</span>:<span class="hljs-number">200</span>&#125;,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>&#125;,<span class="hljs-string">&#x27;json&#x27;</span>);<br>&#125;);<br><br>$(<span class="hljs-string">&#x27;button&#x27;</span>).<span class="hljs-title function_">eq</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>$.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;http://127.0.0.1:8000/jquery-server&#x27;</span>,&#123;<span class="hljs-attr">a</span>:<span class="hljs-number">100</span>,<span class="hljs-attr">b</span>:<span class="hljs-number">200</span>&#125;,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>&#125;,<span class="hljs-string">&#x27;json&#x27;</span>);<br>&#125;);<br><br>$(<span class="hljs-string">&#x27;button&#x27;</span>).<span class="hljs-title function_">eq</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>$.<span class="hljs-title function_">ajax</span>(&#123;<br>        <span class="hljs-comment">//url</span><br>        <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;http://127.0.0.1:8000/jquery-server&#x27;</span>,<br>        <span class="hljs-comment">//参数(parameter)</span><br>        <span class="hljs-attr">data</span>:&#123;<span class="hljs-attr">a</span>:<span class="hljs-number">100</span>,<span class="hljs-attr">b</span>:<span class="hljs-number">200</span>&#125;,<br>        <span class="hljs-comment">//类型</span><br>        <span class="hljs-attr">type</span>:<span class="hljs-string">&#x27;GET&#x27;</span>,<br>        <span class="hljs-comment">//响应体数据格式</span><br>        <span class="hljs-attr">dataType</span>:<span class="hljs-string">&#x27;json&#x27;</span>,<br>        <span class="hljs-comment">//延迟时间</span><br>        <span class="hljs-attr">timeout</span>:<span class="hljs-number">2000</span>,<br>        <span class="hljs-comment">//成功的回调函数</span><br>        <span class="hljs-attr">success</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>        &#125;,<br>        <span class="hljs-comment">//失败的回调</span><br>        <span class="hljs-attr">error</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;出错了&#x27;</span>)；<br>        &#125;,<br>        <span class="hljs-comment">//头信息</span><br>        <span class="hljs-attr">headers</span>:&#123;<br>            <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;bitter-gourd&#x27;</span><br>        &#125;<br>    &#125;);<br>&#125;);<br></code></pre></div></td></tr></table></figure><h3 id="axios发送Ajax请求">axios发送Ajax请求</h3><h3 id="跨域">跨域</h3><h4 id="同源策略">同源策略</h4><p>同源策略(Same-Origin Policy)最早由网景公司提出，是浏览器的一种安全策略。</p><p>同源：协议、域名、端口  必须完全相同。</p><p>违背同源策略就是跨域。</p><h4 id="JSONP解决跨域">JSONP解决跨域</h4><ol><li>什么是JSONP?</li></ol><p>JSONP(JSON with Padding)，是一个非官方的跨域解决方案，只接受get请求。</p><ol start="2"><li>JSON是怎么工作的？</li></ol><p>在网页中有一些标签天生具有跨越能力，比如： img link iframe script</p><p>JSONP就是利用script标签来解决跨域问题。</p><h4 id="CORS">CORS</h4><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS">MDN有关CORS的介绍</a></p><ol><li>什么是CORS？</li></ol><p>CORS(Cross-Origin Resource Sharing)，跨域资源共享。CORS是官方的跨域解决方案，它的特点是不需要在客户端做任何特殊的操作，完全在服务器中进行处理，支持get和post等请求，跨域资源共享标准新增了一组HTTP首部字段，允许服务器声明哪些源站通过浏览器有权访问哪些资源。</p><ol start="2"><li>CORS是怎么工作的？</li></ol><p>CORS是通过设置一个响应头来告诉浏览器，该请求允许跨域，浏览器收到该响应头以后就会对相应放行。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/cors-server&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">req,res</span>) =&gt;</span>&#123;<br>res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Origin&quot;</span>,<span class="hljs-string">&quot;*&quot;</span>);<br>res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Headers&quot;</span>,<span class="hljs-string">&quot;*&quot;</span>);<br>res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;Access-Control-Allow-Method&quot;</span>,<span class="hljs-string">&quot;*&quot;</span>);<br>res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;hello,bitter-gourd&#x27;</span>);<br>&#125;)<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>前后端交互</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>有趣的网站分享</title>
    <link href="/2022/05/15/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BD%91%E7%AB%99/"/>
    <url>/2022/05/15/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BD%91%E7%AB%99/</url>
    
    <content type="html"><![CDATA[<h1>一些有趣的网站分享</h1><h3 id="前言-3">前言</h3><p>bitter-gourd总是热衷于把一些有趣的网站放在收藏夹吃灰。</p><h3 id="闯关式学习">闯关式学习</h3><p><a href="http://flexboxfroggy.com/">Flexbox-Froggy</a></p><p><img src="flexbox-froggy.png" alt="学习flex盒子的小青蛙"></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-comment">/* level 24 answer */</span><br><span class="hljs-selector-id">#pond</span> &#123;<br>  <span class="hljs-attribute">display</span>: flex;<br><span class="hljs-attribute">flex-direction</span>: column-reverse;<br><span class="hljs-attribute">flex-wrap</span>: wrap-reverse;<br><span class="hljs-attribute">align-content</span>: space-between;<br><span class="hljs-attribute">justify-content</span>:center;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><a href="https://learngitbranching.js.org/?locale=zh_CN">LearnGitBranch</a></p><p><img src="learngitbranch.png" alt="学习gitbranch的沙盒"></p><p>参考答案：</p><p><strong>MainCategorySolutions</strong></p><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh"><span class="hljs-number">1.1</span> Introduction to Git Commits<br>git commit<br>git commit<br><br><span class="hljs-number">1.2</span> Branching i分支，那么这个分支就叫 main，远程仓库的名称就是 o。<br><br>大多数的开发人员会将它们主要的远程仓n Git<br>git branch bugFix<br>git checkout bugFix<br><br><span class="hljs-number">1.3</span> Merging <span class="hljs-keyword">in</span> Git<br>git checkout -b bugFix    <br>git commit  <br>git checkout <span class="hljs-keyword">master</span><br><span class="hljs-title">git</span> commit<br>git merge bugFix<br><br><span class="hljs-number">1.4</span>  Rebase Introduction<br>git checkout -b bugFix    <br>git commit    <br>git checkout <span class="hljs-keyword">master</span>    <br><span class="hljs-title">git</span> commit    <br>git checkout bugFix    <br>git rebase <span class="hljs-keyword">master</span><br><br><span class="hljs-title">2</span>.<span class="hljs-number">1</span> Detach yo’ HEAD<br>git checkout C4<br><br><span class="hljs-number">2.2</span> Relative Refs (^)<br>git checkout C4^<br><br><span class="hljs-number">2.3</span> Relative Refs <span class="hljs-comment">#2 (~)</span><br>git branch -f <span class="hljs-keyword">master</span> <span class="hljs-title">C6</span><br>git branch -f bugFix C0<br>git checkout C1<br><br><span class="hljs-number">2.4</span> Reversing Changes <span class="hljs-keyword">in</span> Git<br>git reset local~<span class="hljs-number">1</span><br>git checkout pushed<br>git revert pushed<br><br><span class="hljs-number">3.1</span> Cherry-pick Intro<br>git cherry-pick C3 C4 C7<br><br><span class="hljs-number">3.2</span> Interactive Rebase Intro<br>git rebase -i <span class="hljs-literal">master</span>~<span class="hljs-number">4</span> --aboveAll<br><br><span class="hljs-number">4.1</span> Grabbing Just <span class="hljs-number">1</span> Commit<br>git checkout <span class="hljs-keyword">master</span><br><span class="hljs-title">git</span> cherry-pick C4<br><br><span class="hljs-number">4.2</span> Juggling Commits<br>git rebase -i caption~<span class="hljs-number">2</span> --aboveAll<br>git commit --amend<br>git rebase -i caption~<span class="hljs-number">2</span> --aboveAll<br>git branch -f <span class="hljs-keyword">master</span> <span class="hljs-title">caption</span><br><br><span class="hljs-number">4.3</span> Juggling Commits <span class="hljs-comment">#2</span><br>git checkout <span class="hljs-keyword">master</span><br><span class="hljs-title">git</span> cherry-pick C2<br>git commit --amend<br>git cherry-pick C3<br><br><span class="hljs-number">4.4</span> Git Tags<br>git <span class="hljs-keyword">tag</span> <span class="hljs-title">v0</span> C1<br>git <span class="hljs-keyword">tag</span> <span class="hljs-title">v1</span> C2<br>git checkout C2<br><br><span class="hljs-number">4.5</span> Git Describe<br>git commit<br><br><span class="hljs-number">5.1</span> Rebasing over <span class="hljs-number">9000</span> times<br>git rebase <span class="hljs-keyword">master</span> <span class="hljs-title">bugFix</span><br>git rebase bugFix side<br>git rebase side another<br>git rebase another <span class="hljs-keyword">master</span><br><br><span class="hljs-title">5</span>.<span class="hljs-number">2</span> Multiple Parents<br>git branch bugWork <span class="hljs-literal">master</span>~^<span class="hljs-number">2</span>~<br><br><span class="hljs-number">5.3</span> Branch Spaghetti<br>git checkout one<br>git cherry-pick C4 C3 C2<br>git checkout two<br>git cherry-pick C5 C4 C3 C2<br>git branch -f three C2<br></code></pre></div></td></tr></table></figure><p><strong>RemoteCategorySolutions</strong></p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-number">1.1</span> Clone Intro<br>git clone<br><br><span class="hljs-number">1.2</span> Remote Branches<br>git <span class="hljs-keyword">commit</span><br>git checkout o<span class="hljs-operator">/</span>main<br>git <span class="hljs-keyword">commit</span><br><br><span class="hljs-number">1.3</span> Git Fetchin’<br>git <span class="hljs-keyword">fetch</span><br><br><span class="hljs-number">1.4</span> Git Pullin’<br>git pull<br><br><span class="hljs-number">1.5</span> Fakeing Teamwork<br>git clone<br>git fakeTeamwork main <span class="hljs-number">2</span><br>git <span class="hljs-keyword">commit</span><br>git pull<br><br><span class="hljs-number">1.6</span> Git Pushin’<br>git <span class="hljs-keyword">commit</span><br>git <span class="hljs-keyword">commit</span><br>git push<br><br><span class="hljs-number">1.7</span> Diverged History<br>git clone<br>git fakeTeamwork<br>git <span class="hljs-keyword">commit</span><br>git pull <span class="hljs-comment">--rebase</span><br>git push<br><br><span class="hljs-number">1.8</span> Locked branch Master<br>git reset <span class="hljs-comment">--hard o/main</span><br>git checkout <span class="hljs-operator">-</span>b feature C2<br>git push origin feature<br><br><span class="hljs-number">2.1</span> Push Master<span class="hljs-operator">!</span><br>git rebase side1 side2<br>git rebase side2 side3<br>git rebase side3 master<br>git pull <span class="hljs-comment">--rebase</span><br>git push<br><br><span class="hljs-number">2.2</span> Merging <span class="hljs-keyword">with</span> remotes<br>git checkout main<br>git pull<br>git <span class="hljs-keyword">merge</span> side1<br>git <span class="hljs-keyword">merge</span> side2<br>git <span class="hljs-keyword">merge</span> side3<br>git push<br><br><span class="hljs-number">2.3</span> Remoting Tracking<br>git checkout <span class="hljs-operator">-</span>b side o<span class="hljs-operator">/</span>main<br>git <span class="hljs-keyword">commit</span><br>git pull <span class="hljs-comment">--rebase</span><br>git push<br><br><span class="hljs-number">2.4</span> Git push arguments<br>git push origin main<br>git push origin foo<br><br><span class="hljs-number">2.5</span> Git push arguments — Expanded<span class="hljs-operator">!</span><br>git push origin main<span class="hljs-operator">~</span><span class="hljs-number">1</span>:foo<br>git push origin foo:main<br><br><span class="hljs-number">2.6</span> <span class="hljs-keyword">Fetch</span> arguments<br>git <span class="hljs-keyword">fetch</span> origin main<span class="hljs-operator">~</span><span class="hljs-number">1</span>:foo<br>git <span class="hljs-keyword">fetch</span> origin foo:main<br>git checkout foo<br>git <span class="hljs-keyword">merge</span> main<br><br><span class="hljs-number">2.7</span> Source <span class="hljs-keyword">of</span> nothing<br>git push origin :foo<br>git <span class="hljs-keyword">fetch</span> origin :bar<br><br><span class="hljs-number">2.8</span> Pull arguments<br>git pull origin bar:foo<br>git pull origin main:side<br></code></pre></div></td></tr></table></figure><p><a href="https://flukeout.github.io/">CSS-dinner</a></p><p><img src="flukeout.png" alt="在线练习CSS"></p>]]></content>
    
    
    <categories>
      
      <category>learning-resources</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习资源</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>移动端网页特效</title>
    <link href="/2022/05/14/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E7%BD%91%E9%A1%B5%E7%89%B9%E6%95%88/"/>
    <url>/2022/05/14/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E7%BD%91%E9%A1%B5%E7%89%B9%E6%95%88/</url>
    
    <content type="html"><![CDATA[<h1>移动端网页特效</h1><h3 id="触屏事件">触屏事件</h3><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">touchstart</span>手指触摸到一个DOM元素时触发<br>touchmove手指在一个DOM元素上滑动时触发<br>touchend手指从一个DOM元素上移开时触发<br></code></pre></div></td></tr></table></figure><h4 id="触摸事件对象">触摸事件对象</h4><figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade"><span class="hljs-built_in">touches</span>正在触摸屏幕的所有手指的列表<br>targetTouches正在触摸当前DOM元素上的手指的一个列表<br>changedTouches手指状态发生改变的列表，从无到有，从有到无<br></code></pre></div></td></tr></table></figure><h4 id="移动端拖动元素">移动端拖动元素</h4><p>元素移动距离 = 盒子原来的位置 + 手指移动的距离</p><p>手指移动的距离 = 手指移动中的坐标 - 手指刚开始触摸的位置</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br><span class="hljs-keyword">var</span> startX = <span class="hljs-number">0</span>;   <span class="hljs-comment">//获得手指初始位置</span><br><span class="hljs-keyword">var</span> startY = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>;   <span class="hljs-comment">//获得盒子原来的位置</span><br><span class="hljs-keyword">var</span> y = <span class="hljs-number">0</span>;   <br>div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;touchstart&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br>startX = e.<span class="hljs-property">targetTouches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">pageX</span>;<br>startY = e.<span class="hljs-property">targetTouches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">pageY</span>;<br>x = <span class="hljs-variable language_">this</span>.<span class="hljs-property">offsetLeft</span>;<br>y = <span class="hljs-variable language_">this</span>.<span class="hljs-property">offsetTop</span>;<br>&#125;)<br>div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;touchmove&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br><span class="hljs-keyword">var</span> moveX = e.<span class="hljs-property">targetTouches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">pageX</span> - startX;<br><span class="hljs-keyword">var</span> moveY = e.<span class="hljs-property">targetTouches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">pageY</span> - startY;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = x + moveX + <span class="hljs-string">&#x27;px&#x27;</span>；<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = y + moveY + <span class="hljs-string">&#x27;px&#x27;</span>；<br>e.<span class="hljs-title function_">preventDefault</span>();   <span class="hljs-comment">//阻止屏幕的滚动行为</span><br><span class="hljs-comment">//手指移动也会触发滚动屏幕所以这里需要阻止默认的屏幕滚动事件。</span><br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="移动端常见特效">移动端常见特效</h3><p>移动端轮播图p145–153</p><p>返回顶部p154</p><h4 id="移动端click事件延迟">移动端click事件延迟</h4><p>移动端click事件都会有300ms的延迟，原因是移动端屏幕双击会缩放页面。</p><ol><li>禁止缩放，浏览器禁用默认的双击缩放行为并且去掉300ms的点击延迟。</li></ol><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;user-scalable=no&quot;</span>&gt;</span><br></code></pre></div></td></tr></table></figure><ol start="2"><li>利用touch事件系列自己封装函数来解决300ms延迟。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">tap</span>(<span class="hljs-params">obj,callback</span>)&#123;<br>    <span class="hljs-keyword">var</span> isMove = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">var</span> startTime = <span class="hljs-number">0</span>;   <span class="hljs-comment">//记录触摸时候的时间变量</span><br>    obj.<span class="hljs-title function_">addEventListner</span>(<span class="hljs-string">&#x27;touchstart&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br>        startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();  <span class="hljs-comment">//记录触摸时间</span><br>    &#125;);<br>    obj.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;touchmove&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br>        isMove = <span class="hljs-literal">true</span>;  <span class="hljs-comment">//判断是否有滑动，有滑动算拖拽，不算点击</span><br>    &#125;);<br>    obj.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;touchend&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br>        <span class="hljs-keyword">if</span>(!isMove &amp;&amp; (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime) &lt; <span class="hljs-number">150</span>)&#123;<br>            callback &amp;&amp; <span class="hljs-title function_">callback</span>();<br>        &#125;<br>        isMove = <span class="hljs-literal">false</span>;<br>        startTime = <span class="hljs-number">0</span>;<br>    &#125;)<br>&#125;<br></code></pre></div></td></tr></table></figure><ol start="3"><li>利用<code>fastclick.js</code></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;addEventListener&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">document</span>) &#123;<br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-title class_">FastClick</span>.<span class="hljs-title function_">attach</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>);<br>&#125;, <span class="hljs-literal">false</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="常用开发框架">常用开发框架</h3><h4 id="框架与插件的区别">框架与插件的区别</h4><p>框架，顾名思义就是一套架构，它会基于自身的特点向用户提供一套较为完整的解决方案。框架的控制权在框架本身，使用者需要按照框架的规范进行开发。</p><p>插件，是为了解决某一个问题而专门存在的，其功能单一，并且比较小。</p><p>前端常用框架有:<code>Bootstrap</code>  <code>Vue</code>  <code>Angular</code>  <code>React</code>等，既能开发PC端又能开发移动端。</p><p>前端常用的插件有:<code>swipr</code>  <code>superslide</code>  <code>iscroll</code></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PC端网页特效</title>
    <link href="/2022/05/14/PC%E7%AB%AF%E7%BD%91%E9%A1%B5%E7%89%B9%E6%95%88/"/>
    <url>/2022/05/14/PC%E7%AB%AF%E7%BD%91%E9%A1%B5%E7%89%B9%E6%95%88/</url>
    
    <content type="html"><![CDATA[<h1>PC端网页特效</h1><h3 id="元素偏移量offset">元素偏移量offset</h3><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">offsetTop</span><br><span class="hljs-attribute">offsetLeft</span><br><span class="hljs-attribute">offsetWidth</span><br><span class="hljs-attribute">offsetHeight</span><br><span class="hljs-attribute">offsetParent</span><br></code></pre></div></td></tr></table></figure><ol><li><code>offsetLeft</code>  <code>offsetTop</code> 以带有定位的父亲为准，如果没有父亲或者父亲没有定位，则以body为准，返回距离上边和距离左边的偏移量。</li><li><code>offsetWidth</code>  <code>offsetHeight</code>可以得到元素的大小（包括宽度和高度），这个值是<code>padding + border + width</code>。</li><li><code>offsetParent</code>返回的是带有定位的父亲，否则返回body。</li></ol><h4 id="offset与style的区别"><code>offset</code>与<code>style</code>的区别</h4><ol><li>offset可以得到任意样式表中的样式值，而style只能得到行内样式表中的样式值。</li><li>offset系列得到的数值是没有单位的，而style.width得到的是带有单位的字符串。</li><li>offsetWidth为<code>padding + border + width</code>，而style.width不包含。</li><li>offsetWidth等属性是只读属性，只能获取不能赋值，而style.width是可读写属性，可以获取也可以赋值。</li><li>总结：想获取元素大小用offser，想给元素更改值，用style。</li></ol><h4 id="得到鼠标在某个盒子内的坐标">得到鼠标在某个盒子内的坐标</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">box.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mousemove&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br><span class="hljs-keyword">var</span> x = e.<span class="hljs-property">pageX</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">offsetLeft</span>;<br><span class="hljs-keyword">var</span> y = e.<span class="hljs-property">pageY</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">offsetTop</span>;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="拖动模态框">拖动模态框</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">box.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mousedown&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br><span class="hljs-keyword">var</span> x = e.<span class="hljs-property">pageX</span> - login.<span class="hljs-property">offsetLeft</span>;<br><span class="hljs-keyword">var</span> y = e.<span class="hljs-property">pageY</span> - login.<span class="hljs-property">offsetTop</span>;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mousemove&#x27;</span>,move)<br>     <span class="hljs-keyword">function</span> <span class="hljs-title function_">move</span>(<span class="hljs-params">e</span>)&#123;<br>        login.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = e.<span class="hljs-property">pageX</span> - x + <span class="hljs-string">&#x27;px&#x27;</span>;<br>        login.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = e.<span class="hljs-property">pageY</span> - y + <span class="hljs-string">&#x27;px&#x27;</span>;<br>    &#125;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListner</span>(<span class="hljs-string">&#x27;mouseup&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>         <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;mousemove&#x27;</span>,move);<br>    &#125;)<br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="元素可视区client">元素可视区client</h3><p>client系列跟offset系列最大的区别在于其不包括border但包括padding。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">clientTop       返回元素上边框的大小<br>clientLeft返回元素左边框的大小<br></code></pre></div></td></tr></table></figure><h4 id="flexible源码分析">flexible源码分析</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">(<span class="hljs-keyword">function</span> <span class="hljs-title function_">flexible</span> (<span class="hljs-variable language_">window</span>, <span class="hljs-variable language_">document</span>) &#123;<br>    <span class="hljs-comment">//获取的html根元素&lt;html&gt;</span><br>    <span class="hljs-keyword">var</span> docEl = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span><br>    <span class="hljs-comment">//dpr 物理像素比  前者是移动端，后者是PC端（默认为1）</span><br>    <span class="hljs-keyword">var</span> dpr = <span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span> || <span class="hljs-number">1</span><br>  <br>    <span class="hljs-comment">// adjust body font size</span><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">setBodyFontSize</span> () &#123;<br>      <span class="hljs-comment">//如果页面中有body这个元素，就设置body的字体大小</span><br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>) &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">fontSize</span> = (<span class="hljs-number">12</span> * dpr) + <span class="hljs-string">&#x27;px&#x27;</span><br>      &#125;<br>      <span class="hljs-comment">//这是为了防止script标签放在body标签之前而没有body标签出现的一种做法。</span><br>      <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>, setBodyFontSize)<br>      &#125;<br>    &#125;<br>    <span class="hljs-title function_">setBodyFontSize</span>();<br>  <br>    <span class="hljs-comment">// set 1rem = viewWidth / 10</span><br>    <span class="hljs-comment">// 设置html元素的字体大小</span><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">setRemUnit</span> () &#123;<br>      <span class="hljs-keyword">var</span> rem = docEl.<span class="hljs-property">clientWidth</span> / <span class="hljs-number">10</span><br>      docEl.<span class="hljs-property">style</span>.<span class="hljs-property">fontSize</span> = rem + <span class="hljs-string">&#x27;px&#x27;</span><br>    &#125;<br>  <br>    <span class="hljs-title function_">setRemUnit</span>()<br>  <br>    <span class="hljs-comment">// reset rem unit on page resize</span><br>    <span class="hljs-comment">// 当页面尺寸大小发生变化的时候重新设置rem</span><br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>, setRemUnit)<br>    <span class="hljs-comment">// pageshow是页面出现的时候会触发的事件</span><br>    <span class="hljs-comment">// e.persisted 返回的是true 如果这个页面是从缓存取过来的页面，也需要重新计算一下rem的大小</span><br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;pageshow&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">persisted</span>) &#123;<br>        <span class="hljs-title function_">setRemUnit</span>()<br>      &#125;<br>    &#125;)<br>  <br>    <span class="hljs-comment">// detect 0.5px supports</span><br>    <span class="hljs-comment">// 原因是有些移动端的浏览器不支持0.5像素的写法</span><br>    <span class="hljs-keyword">if</span> (dpr &gt;= <span class="hljs-number">2</span>) &#123;<br>      <span class="hljs-keyword">var</span> fakeBody = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;body&#x27;</span>)<br>      <span class="hljs-keyword">var</span> testElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>      testElement.<span class="hljs-property">style</span>.<span class="hljs-property">border</span> = <span class="hljs-string">&#x27;.5px solid transparent&#x27;</span><br>      fakeBody.<span class="hljs-title function_">appendChild</span>(testElement)<br>      docEl.<span class="hljs-title function_">appendChild</span>(fakeBody)<br>      <span class="hljs-keyword">if</span> (testElement.<span class="hljs-property">offsetHeight</span> === <span class="hljs-number">1</span>) &#123;<br>        docEl.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;hairlines&#x27;</span>)<br>      &#125;<br>      docEl.<span class="hljs-title function_">removeChild</span>(fakeBody)<br>    &#125;<br>  &#125;(<span class="hljs-variable language_">window</span>, <span class="hljs-variable language_">document</span>)) <br><br></code></pre></div></td></tr></table></figure><h4 id="pageshow和load的区别"><code>pageshow</code>和<code>load</code>的区别</h4><p>首先需要明白下面三种情况都会触发load事件：</p><ol><li>a标签的超链接。</li><li>F5或者刷新按钮。</li><li>前进后退按钮。</li></ol><p>但是在火狐浏览器中有一个“往返缓存”，这个缓存中不仅保存这页面数据，还保存这DOM和JavaScript的状态，实际上是将整个页面都保存在了内存里面。所有此时后退按钮不能刷新页面。</p><p>此时可以使用<code>pageshow</code>事件来触发，这个事件在页面显示的时候触发，无论页面是否来自缓存，在重新加载页面中，<code>pageshow</code>会在load事件触发后触发；根据事件对象中的persisted来判断是否是缓存中的页面触发的<code>pageshow</code>事件。</p><h3 id="元素滚动scroll">元素滚动scroll</h3><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm"><span class="hljs-keyword">scrollTop</span>返回被卷去的上侧距离，返回数值不带单位<br><span class="hljs-keyword">scrollLeft</span>返回被卷去的左侧距离，返回数值不带单位<br><span class="hljs-keyword">scrollWidth</span>返回自身实际的宽度，不含边框，返回数值不带单位<br><span class="hljs-keyword">scrollHeight</span>返回自身实际的高度，不含边框，返回数值不带单位<br>window.pageYOffset页面被卷去的头部长度，返回数值不带单位<br></code></pre></div></td></tr></table></figure><h4 id="页面被卷去头部长度兼容性问题">页面被卷去头部长度兼容性问题</h4><ol><li>声明了<code>DTD</code>，使用<code>document.documentElement.scrollTop</code></li><li>未声明<code>DTD</code>，使用<code>document.body.scrollTop</code></li><li>新方法（IE9开始支持）<code>window.pageYOffset</code>和<code>window.pageXOffset</code></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getScroll</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">return</span>&#123;<br><span class="hljs-attr">left</span>:<span class="hljs-variable language_">window</span>.<span class="hljs-property">pageXOffset</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">scrollLeft</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">scrollLetf</span> || <span class="hljs-number">0</span>;<br><span class="hljs-attr">top</span>:<span class="hljs-variable language_">window</span>.<span class="hljs-property">pageYOffset</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">scrollTop</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">scrollTop</span> || <span class="hljs-number">0</span>;<br>&#125;<br>&#125;<br><span class="hljs-comment">//然后在使用的时候  getScroll().left 或者 getScroll().top </span><br></code></pre></div></td></tr></table></figure><h3 id="动画函数封装">动画函数封装</h3><h4 id="实现原理">实现原理</h4><ol><li>获取盒子当前的位置。</li><li>让盒子在当前位置加上1个移动距离。</li><li>利用定时器不断重复这个操作。</li><li>加一个定时器结束的条件。</li><li>注意此元素需要添加定位，才能只用<code>element.style.left</code></li></ol><h4 id="函数封装">函数封装</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params">obj,target</span>)&#123;<br>    <span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);  <span class="hljs-comment">//先清除以前的定时器，只留下最新的一个，防止叠加。</span><br>obj.<span class="hljs-property">timer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(obj.<span class="hljs-property">offsetLeft</span> &gt;= target)&#123;<br><span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);<br>&#125;<br>obj.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = obj.<span class="hljs-property">offsetLeft</span> + <span class="hljs-number">1</span> + <span class="hljs-string">&#x27;px&#x27;</span>;<br>&#125;,<span class="hljs-number">30</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="缓动动画实现">缓动动画实现</h4><p>比如采用公式： （目标值-当前位置）/10</p><p><code>(target - obj.offsetLeft)/10</code></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params">obj,target</span>)&#123;<br>    <span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);  <span class="hljs-comment">//先清除以前的定时器，只留下最新的一个，防止叠加。</span><br>obj.<span class="hljs-property">timer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(obj.<span class="hljs-property">offsetLeft</span> &gt;= target)&#123;<br><span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);<br>&#125;<br>        <span class="hljs-keyword">var</span> step = (target - obj.<span class="hljs-property">offsetLeft</span>)/<span class="hljs-number">10</span>;<br>obj.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = obj.<span class="hljs-property">offsetLeft</span> + step + <span class="hljs-string">&#x27;px&#x27;</span>;<br>&#125;,<span class="hljs-number">30</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>上述程序会出现bug：达不到我们设定的target值。改进如下：</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params">obj,target</span>)&#123;<br>    <span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);  <span class="hljs-comment">//先清除以前的定时器，只留下最新的一个，防止叠加。</span><br>obj.<span class="hljs-property">timer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(obj.<span class="hljs-property">offsetLeft</span> &gt;= target)&#123;<br><span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);<br>&#125;<br>        <span class="hljs-keyword">var</span> step = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>((target - obj.<span class="hljs-property">offsetLeft</span>)/<span class="hljs-number">10</span>);  <span class="hljs-comment">//加一个向上取整</span><br>obj.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = obj.<span class="hljs-property">offsetLeft</span> + step + <span class="hljs-string">&#x27;px&#x27;</span>;<br>&#125;,<span class="hljs-number">30</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>上述程序仍会出现bug：如果是后退（即step&lt;0），仍然达不到我们设定的target值。改进如下：</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params">obj,target</span>)&#123;<br>    <span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);  <span class="hljs-comment">//先清除以前的定时器，只留下最新的一个，防止叠加。</span><br>obj.<span class="hljs-property">timer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(obj.<span class="hljs-property">offsetLeft</span> &gt;= target)&#123;<br><span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);<br>&#125;<br>        <span class="hljs-keyword">var</span> step = (target - obj.<span class="hljs-property">offsetLeft</span>)/<span class="hljs-number">10</span>; <br>        step = step &gt; <span class="hljs-number">0</span> ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(step) ; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(step);   <span class="hljs-comment">//向下取整</span><br>obj.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = obj.<span class="hljs-property">offsetLeft</span> + step + <span class="hljs-string">&#x27;px&#x27;</span>;<br>&#125;,<span class="hljs-number">30</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="给动画函数添加回调函数">给动画函数添加回调函数</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params">obj,target,callback</span>)&#123;<br>    <span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);  <span class="hljs-comment">//先清除以前的定时器，只留下最新的一个，防止叠加。</span><br>obj.<span class="hljs-property">timer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(obj.<span class="hljs-property">offsetLeft</span> &gt;= target)&#123;<br><span class="hljs-built_in">clearInterval</span>(obj.<span class="hljs-property">timer</span>);<br>            <span class="hljs-keyword">if</span>(callback)&#123;   <span class="hljs-comment">//如果存在callback则调用</span><br>                <span class="hljs-title function_">callback</span>();<br>            &#125;<br>&#125;<br>        <span class="hljs-keyword">var</span> step = (target - obj.<span class="hljs-property">offsetLeft</span>)/<span class="hljs-number">10</span>; <br>        step = step &gt; <span class="hljs-number">0</span> ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(step) ; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(step);   <span class="hljs-comment">//向下取整</span><br>obj.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = obj.<span class="hljs-property">offsetLeft</span> + step + <span class="hljs-string">&#x27;px&#x27;</span>;<br>&#125;,<span class="hljs-number">30</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>轮播图p127-138</p><p>返回顶部p139</p><p>筋斗云导航栏p140</p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Web API</title>
    <link href="/2022/05/13/Web-API/"/>
    <url>/2022/05/13/Web-API/</url>
    
    <content type="html"><![CDATA[<h1>Web API</h1><h3 id="API-2">API</h3><p>API(应用程序编程接口)是一些预先定义的函数，目的是提供应用程序与开发人员基于某软件或者硬件得以访问一组例程的能力，而又无需访问源码，或理解内部工作机制的细节。</p><p>简单理解：API是一种工具，以便我们更轻松的实现想要完成的功能。</p><h4 id="Web-API">Web API</h4><p>BOM和DOM</p><h3 id="获取元素">获取元素</h3><ol><li><p>因为我们文档页面从上往下加载，所以先得有标签，script得写在标签下面。</p></li><li><p><code>getElementById</code>返回的是一个元素对象。</p></li><li><p><code>console.dir</code>打印对象可以更好的查看里面的属性和方法。</p></li><li><p><code>getElementsByTagName</code>方法可以返回带有指定标签名的对象的<strong>集合</strong>。（伪数组）</p></li><li><p><code>element.getElenmentsByTagName</code>可以获得这个元素里面的某些标签。</p></li><li><p><code>getElementsByClassName</code>根据类名获得元素对象<strong>集合</strong>。</p></li><li><p><code>querySelector</code>返回指定选择器的第一个元素对象。</p></li><li><p><code>querySelectorAll</code>返回指定选择器的所有元素对象<strong>集合</strong>。</p></li><li><p><code>document.body</code>获得body标签。</p></li><li><p><code>document.documentElement</code>获得html元素对象。</p></li></ol><h3 id="事件基础">事件基础</h3><p>事件由三部分组成：事件源，事件类型，事件处理程序。</p><h3 id="innerText和innerHTML的区别"><code>innerText</code>和<code>innerHTML</code>的区别</h3><p><code>innerHTML</code>可以识别HTML标签。（多用HTML）</p><p>注意点：这两个方法是可以读写的，可以获取元素里面的内容。</p><h3 id="操作元素">操作元素</h3><p>可以修改元素属性</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;button id=<span class="hljs-string">&quot;ldh&quot;</span>&gt;刘德华&lt;/button&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;zxy&quot;</span>&gt;</span>张学友<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;images/ldh.jpg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml">var ldh = document.getElementById(&#x27;ldh&#x27;);</span><br><span class="language-xml">var zxy = document.getElementById(&#x27;zxy&#x27;);</span><br><span class="language-xml">var img = document.querySelector(&#x27;img&#x27;);</span><br><span class="language-xml">zxy.onclick = function()&#123;</span><br><span class="language-xml">img.src = &#x27;imgages/zxy.jpg&#x27;;</span><br><span class="language-xml">    img.title = &#x27;张学友&#x27;;</span><br><span class="language-xml">&#125;</span><br><span class="language-xml">ldh.onclick = function()&#123;</span><br><span class="language-xml">img.src = &#x27;images/ldh.hpg&#x27;；</span><br><span class="language-xml">    img.title = &#x27;刘德华&#x27;;  </span><br><span class="language-xml">&#125;</span><br><span class="language-xml">//title属性是鼠标经过时显示的文字。</span><br></code></pre></div></td></tr></table></figure><h4 id="操作元素之表单元素设置">操作元素之表单元素设置</h4><p>表单里面的值（文字内容）是通过value来修改的。</p><p><code>.innerHTML</code>是普通盒子如div改变内容使用的。</p><h4 id="登录注册时密码显示处理">登录注册时密码显示处理</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;img src=<span class="hljs-string">&#x27;images/eye.png&#x27;</span> alt=<span class="hljs-string">&#x27;&#x27;</span> id=<span class="hljs-string">&#x27;eye&#x27;</span>&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&#x27;password&#x27;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;pwd&#x27;</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml">var eye = document.getElementById(&#x27;eye&#x27;);</span><br><span class="language-xml">var pwd = document.getElementById(&#x27;pwd&#x27;);</span><br><span class="language-xml">var flag = 0;</span><br><span class="language-xml">eye.onclick = function()&#123;</span><br><span class="language-xml">if(flag == 0)&#123;</span><br><span class="language-xml">        pwd.type = &#x27;text&#x27;;</span><br><span class="language-xml">        flag = 1;</span><br><span class="language-xml">    &#125;else &#123;</span><br><span class="language-xml">        pwd.type = &#x27;password&#x27;;</span><br><span class="language-xml">        flag = 0;</span><br><span class="language-xml">    &#125;</span><br><span class="language-xml">&#125;</span><br></code></pre></div></td></tr></table></figure><h4 id="操作元素之样式属性操作">操作元素之样式属性操作</h4><ol><li><p>JS里面的样式采用的是驼峰命名法，比如fontSize、backgroundColor</p></li><li><p>JS修改style样式操作，产生的是行内样式，权重比较高。</p></li><li><p>更好的做法其实是封装一个className，在JS操作时直接修改类名。</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br>div.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">backgroudColor</span> = <span class="hljs-string">&#x27;pueple&#x27;</span>;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&#x27;250px&#x27;</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="显示隐藏文本框">显示隐藏文本框</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> text = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;input&#x27;</span>);<br>text.<span class="hljs-property">onfocus</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> === <span class="hljs-string">&#x27;手机&#x27;</span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>&#125;<br>&#125;<br>text.<span class="hljs-property">onblur</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> === <span class="hljs-string">&#x27;&#x27;</span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> =<span class="hljs-string">&#x27;手机&#x27;</span>;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="自定义属性操作">自定义属性操作</h4><p>自定义属性，就是开发者自己添加的属性。</p><ol><li>获取元素的属性值</li></ol><p><code>getAttribute('属性')</code></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">id</span>);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;id&#x27;</span>));<br></code></pre></div></td></tr></table></figure><ol start="2"><li>设置属性值</li></ol><p><code>element.setAttribute('属性','值')</code></p><ol start="3"><li>H5自定义属性</li></ol><p>H5规定自定义属性<code>data-</code>开头作为属性名并且赋值。</p><p><code>element.dataset.index</code>H5新增的更改自定义属性的方法。</p><h3 id="利用节点关系来进行节点操作">利用节点关系来进行节点操作</h3><p><code>parentNode</code>父节点，得到最近的父级节点。</p><p><code>childNodes</code>子节点，得到所有的子节点，包括元素节点和文本节点（包括换行）。</p><p>如果只想获得里面的元素节点，需要专门处理，因此一般不提倡使用childNodes。</p><p><code>children</code>获取所有的子元素节点，实际开发常用。</p><p><code>firstChild</code>  <code>lastChild</code>针对特定位置的子节点，但是包括元素节点和文本节点。</p><p><code>firstElementChild</code>针对特定位置的子节点，只获取元素节点，但是存在兼容性问题。</p><p><code>nextSibling</code>下一个兄弟节点，包含元素节点或者文本节点。</p><p><code>previousSibling</code>上一个兄弟节点，包含元素节点或者文本节点。</p><p><code>nextElementSibling</code>下一个兄弟元素节点，但是存在兼容性问题。</p><p><code>previousElementSibling</code>上一个兄弟元素节点，但是存在兼容性问题。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> ol = <span class="hljs-variable language_">document</span>,<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ol&#x27;</span>);  <span class="hljs-comment">//会以伪数组的形式存储子节点</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>]);   <span class="hljs-comment">//第一个子节点</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-property">children</span>[ol.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]);  <span class="hljs-comment">//最后一个节点</span><br></code></pre></div></td></tr></table></figure><h4 id="如何解决兄弟元素节点的兼容性问题？">如何解决兄弟元素节点的兼容性问题？</h4><p>封装一个兼容性函数。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getNextElementSibling</span>(<span class="hljs-params">element</span>)&#123;<br><span class="hljs-keyword">var</span> el = element;<br><span class="hljs-keyword">while</span>(el = el.<span class="hljs-property">nextSiling</span>)&#123;<br><span class="hljs-keyword">if</span>(el.<span class="hljs-property">nodeType</span> === <span class="hljs-number">1</span>)&#123;<br><span class="hljs-keyword">return</span> el;<br>&#125;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="下拉菜单">下拉菜单</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> nav = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.nav&#x27;</span>);<br><span class="hljs-keyword">var</span> lis = nav.<span class="hljs-property">children</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;i &lt; lis.<span class="hljs-property">length</span>;i++)&#123;<br>lis[i].<span class="hljs-property">onmouseover</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>[<span class="hljs-number">1</span>].<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;block&#x27;</span>;<br>&#125;<br>lis[i].<span class="hljs-property">onmouseout</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>[<span class="hljs-number">1</span>].<span class="hljs-property">style</span>.<span class="hljs-property">displat</span> = <span class="hljs-string">&#x27;none&#x27;</span>;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="创建节点和添加节点">创建节点和添加节点</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br><span class="hljs-keyword">var</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ul&#x27;</span>);<br>ul.<span class="hljs-title function_">appendChild</span>(li);<br><br><span class="hljs-comment">//添加节点（在前面）node.insertBefore(child,指定元素)</span><br><span class="hljs-keyword">var</span> lili = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br>ul.<span class="hljs-title function_">insertBefore</span>(lili,ul.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>]);<br></code></pre></div></td></tr></table></figure><h4 id="发布留言案例-补充删除">发布留言案例(补充删除)</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br><span class="hljs-keyword">var</span> text = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;textarea&#x27;</span>);<br><span class="hljs-keyword">var</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ul&#x27;</span>);<br>btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(text.<span class="hljs-property">value</span> === <span class="hljs-string">&#x27;&#x27;</span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;您没有输入内容&#x27;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">var</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br>li.<span class="hljs-property">innerHTML</span> = text.<span class="hljs-property">value</span> + <span class="hljs-string">&quot;&lt;a href=&#x27;javascript:;&#x27;&gt;删除&lt;/a&gt;&quot;</span>;<br>ul.<span class="hljs-title function_">appendChild</span>(li);<br>        <span class="hljs-keyword">var</span> <span class="hljs-keyword">as</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;a&#x27;</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;i &lt; <span class="hljs-keyword">as</span>.<span class="hljs-property">length</span>;i++)&#123;<br>            <span class="hljs-keyword">as</span>[i].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>                ul.<span class="hljs-title function_">removeChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">parentNode</span>);<br>            &#125;<br>        &#125;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="删除节点">删除节点</h4><p><code>node.removeChild(child)</code></p><h4 id="克隆节点">克隆节点</h4><p><code>node.cloneNode()</code></p><ol><li>如果括号参数为空或者false，只复制标签不复制内容。</li><li>括号为true，复制标签复制标签里面的内容（包含子节点）。</li></ol><h4 id="三种创建元素的区别">三种创建元素的区别</h4><p><code>document.write()</code></p><p><code>element.innerHTML</code></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">ul.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">&#x27;&lt;a href=&quot;#&quot;&gt;链接&lt;/a&gt;’  //效率不高</span><br><span class="hljs-string">var arr[];</span><br><span class="hljs-string">for(var i = 0;i &lt;= 100;i++)&#123;</span><br><span class="hljs-string">    arr.push(&#x27;</span>&lt;a href=<span class="hljs-string">&quot;#&quot;</span>&gt;链接&lt;/a&gt;’);<br>&#125;<br>ul.<span class="hljs-property">innerHTML</span> = arr.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br></code></pre></div></td></tr></table></figure><p><code>document.createElement()</code></p><ol><li><code>document.write()</code>会直接将内容写入页面的文档流，但是文档流执行完毕后再执行（比如给button绑定事件，后续执行时；或者window.onload绑定事件），它会重置整个页面，覆盖直接写过的全部东西。</li><li><code>innerHTML</code>是将内容写入某个DOM节点，不会导致页面全部重绘。</li><li><code>innerHTML</code>穿件多个元素的效率更高，前提是不要拼接字符串要用数组，结构稍微复杂。</li><li><code>document.createElement()</code>创建多个元素效率稍低，但结构清晰。</li></ol><h3 id="注册事件的两种方式">注册事件的两种方式</h3><h4 id="传统注册方式">传统注册方式</h4><ol><li>利用on开头的实现onclick</li><li>注册事件的唯一性</li><li>同一个元素同一个事件只能设置一个处理函数，最后注册的处理函数将会覆盖前面注册的处理函数。</li></ol><h4 id="方法监听注册方式">方法监听注册方式</h4><p><code>addEventListener()</code></p><p>特点：同一个元素同一个事件可以注册多个监听器。</p><p>按注册顺序依次执行。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">eventTarget.<span class="hljs-title function_">addEventListener</span>(type,listener[,useCapture])<br>eventTarget.<span class="hljs-title function_">addEventListener</span>()方法将指定的监听器注册到<span class="hljs-title function_">eventTarget</span>(目标对象)上，当该对象触发指定的事件时，就会执行事件处理函数。<br>三个参数：<br>type：事件类型字符串，如click、mouseover，不带on<br>listener：事件处理函数，事件发生时，会调用该监听函数<br>useCapture：可选参数，是一个布尔值，默认是<span class="hljs-literal">false</span>。<br><br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-number">111</span>);<br>&#125;)<br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-number">222</span>);<br>&#125;)<br><span class="hljs-comment">//先弹出111再弹出222</span><br></code></pre></div></td></tr></table></figure><p>IE9之前用<code>attachEvent</code>替代<code>addEventListener()</code></p><h4 id="删除事件">删除事件</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">传统方式：<br><span class="hljs-keyword">var</span> divs = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySeletorAll</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br>divs[<span class="hljs-number">0</span>].<span class="hljs-property">oncilck</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-number">111</span>);<br>divs[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-literal">null</span>;  <span class="hljs-comment">//在点完一次后解绑</span><br>&#125;<br>方式监听注册方式：<br>divs[<span class="hljs-number">1</span>].<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,fn)   <span class="hljs-comment">//里面的fn不需要加调动小括号</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title function_">alert</span>(<span class="hljs-number">222</span>);<br>    divs[<span class="hljs-number">1</span>].<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,fn);<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="DOM事件流">DOM事件流</h3><p>事件流描述的是从页面中接收事件的顺序。</p><p>事件发生时会在元素节点之间按照特定的顺序传播，这个传播过程即DOM事件流。</p><p><img src="DOM%E4%BA%8B%E4%BB%B6%E6%B5%81.png" alt="DOM事件流"></p><p>**事件冒泡：**IE最早提出，事件开始时由最具体的元素接收，然后逐级向上传播到DOM最顶层节点的过程。</p><p>**事件捕获：**网景最早提出，由DOM最顶层节点开始，然后逐级向下传播到最具体的元素接收的过程。</p><p>注意：</p><ol><li>JS代码只能执行捕获或者冒泡其中的一个阶段。</li><li>onclick 和 attachEvent 只能得到冒泡阶段。</li><li><code>addEventListener(type,listen[,useCapture])</code>第三个参数如果是true，表示在事件捕获阶段调用事件处理程序；如果是false（不写的话默认是flase），表示在事件冒泡阶段调用事件处理程序。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//冒泡阶段，如果addEventListener第三个参数是 false 或者 省略 那么则处于冒泡阶段</span><br><span class="hljs-comment">// son -&gt; father -&gt; body -&gt;html -&gt; document</span><br><span class="hljs-keyword">var</span> son = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.son&#x27;</span>);<br>son.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;son&#x27;</span>);<br>&#125;,<span class="hljs-literal">false</span>);   <span class="hljs-comment">//false可以省略不写</span><br><span class="hljs-keyword">var</span> father = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.father&#x27;</span>);<br>son.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;father&#x27;</span>);<br>&#125;,<span class="hljs-literal">false</span>); <br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;document&#x27;</span>);<br>&#125;)<br></code></pre></div></td></tr></table></figure><ol start="4"><li>有些事件是没有冒泡的，比如<code>onblur</code>  <code>onfocus</code>   <code>onmouseenter</code>  <code>onmouseleave</code></li></ol><h3 id="事件对象">事件对象</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br>div.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)&#123;&#125;<br>div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);<br>    <span class="hljs-comment">// e = e || window.event；</span><br>&#125;)<br></code></pre></div></td></tr></table></figure><ol><li><code>event</code>就是一个事件对象 写到我们侦听函数的小括号里面，可以当做形参。</li><li>事件对象只有有了事件才会存在，它是系统给我们自动创建的，不需要我们传递参数。</li><li>事件对象，是我们事件的一系列相关数据的集合，跟事件有关，鼠标点击、键盘按下等。</li><li>事件对象可以由我们自己命名，比如<code>e</code></li><li>事件对象也存在兼容性问题，如ie678，用<code>window.event</code>可以处理。</li></ol><h4 id="事件对象的常见属性和方法：">事件对象的常见属性和方法：</h4><ol><li><code>e.target</code>返回的是触发事件的对象（元素），<code>this</code>返回的是绑定事件的对象（元素）。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br>div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">target</span>);  <span class="hljs-comment">//div</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);<br>&#125;);<br><span class="hljs-comment">//如何区别e.target 和 this</span><br><br><span class="hljs-keyword">var</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">quertSelector</span>(<span class="hljs-string">&#x27;ul&#x27;</span>);<br>ul.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">target</span>);<br>&#125;);<br><span class="hljs-comment">//当你点击li的时候  this指向绑定对象ul  但是e.target指向的是触发对象li（父元素和子元素）</span><br><br><span class="hljs-comment">//来处理兼容性问题(ie678中无e.target)</span><br>div.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br>e = e || <span class="hljs-variable language_">window</span>.<span class="hljs-property">event</span>;<br><span class="hljs-keyword">var</span> target = e.<span class="hljs-property">target</span> || e.<span class="hljs-property">srcElement</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><ol start="2"><li><code>e.type</code>返回事件的类型。</li><li><code>e.preventDefault();</code>阻止默认行为（事件）。特别地，在ie678中使用returnValue属性。</li></ol><p>还可以用return false（会让这一条代码以上的代码无法执行，但无法阻止后续代码）。</p><ol start="4"><li><code>e.stopPropagation()</code>阻止冒泡。兼容性：<code>e.cancelBubble = true</code>。</li></ol><h4 id="事件委托">事件委托</h4><p>原理：不是每个子节点单独设置事件监听器，而是事件监听器设置在其父节点上，然后利用冒泡原理影响每个子节点。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;ul&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br>&lt;/ul&gt;<br><br><span class="hljs-keyword">var</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ul&#x27;</span>);<br>ul.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>e.<span class="hljs-property">target</span>.<span class="hljs-property">backgroundcolor</span> = pink;  <span class="hljs-comment">//点击li使得li变色</span><br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="文字无法选中和右键菜单栏隐藏">文字无法选中和右键菜单栏隐藏</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//1.contextmenu  我们可以禁用右键菜单</span><br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;contextmenu&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br>e.<span class="hljs-title function_">preventDefault</span>();<br>&#125;)<br><span class="hljs-comment">//2.selectstart 禁止选中文字</span><br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;selectstartt&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br>e.<span class="hljs-title function_">preventDefault</span>();<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="鼠标事件对象"><strong>鼠标事件对象</strong></h4><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">e<span class="hljs-selector-class">.clientX</span>     返回鼠标相对于浏览器窗口可视区的X坐标<br>e<span class="hljs-selector-class">.clientY</span>     返回鼠标相对于浏览器窗口可视区的Y坐标<br>e<span class="hljs-selector-class">.pageX</span>       返回鼠标相对于文档页面的X坐标<br>e<span class="hljs-selector-class">.pageY</span>       返回鼠标相对于文档页面的Y坐标<br>e<span class="hljs-selector-class">.screenX</span>     返回鼠标相对于电脑屏幕的X坐标<br>e<span class="hljs-selector-class">.screenY</span>     返回鼠标相对于电脑屏幕的Y坐标<br></code></pre></div></td></tr></table></figure><h4 id="mouseenter和mouseover-的区别">mouseenter<code>和</code>mouseover`的区别</h4><p><code>mouseenter</code>只会在经过自身盒子的时候触发；<code>mouseover</code>在鼠标经过自身盒子的时候触发同时也会在鼠标经过子盒子的时候触发。</p><p>原因：<code>mouseenter</code>不会冒泡。</p><h4 id="如何做一个鼠标图案？">如何做一个鼠标图案？</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;style&gt;<br>img&#123;<br><span class="hljs-attr">position</span>:absolute;<br>&#125;<br>&lt;/style&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mousemove&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-comment">//1.mousemove 只要我们鼠标移动1px，就会触发这个事件</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> x = e.<span class="hljs-property">pageX</span>；</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> y = e.<span class="hljs-property">pageY</span>;</span></span><br><span class="language-javascript"><span class="language-xml">pic.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = x + <span class="hljs-string">&#x27;px&#x27;</span>;  <span class="hljs-comment">//别忘了字符串拼接</span></span></span><br><span class="language-javascript"><span class="language-xml">pic.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = y + <span class="hljs-string">&#x27;px&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;);</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure><h4 id="键盘事件对象">键盘事件对象</h4><figure class="highlight xl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xl">onkeyup<br>onkeydown<br>onkeypress (不能识别功能键 如 ctrl shift等)、<br>三个事件的执行顺序：<span class="hljs-function"><span class="hljs-title">keydown</span> -&gt;</span> <span class="hljs-function"><span class="hljs-title">keypress</span> -&gt;</span>keyup<br></code></pre></div></td></tr></table></figure><p><code>e.key</code>返回按下的键</p><p><code>e.keycode</code>返回按下的键的ASCII码值</p><ol><li>keyup和keydown事件不区分字母大小写。</li><li>keypress区分字母大小写。</li></ol><h4 id="京东按S后focus搜索框">京东按S后focus搜索框</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> search = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;input&#x27;</span>);<br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;keyup&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)&#123;<br><span class="hljs-keyword">if</span>(e.<span class="hljs-property">keyCode</span> == <span class="hljs-number">83</span>)&#123;<br>search.<span class="hljs-title function_">focus</span>();<br>&#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="BOM">BOM</h3><h4 id="什么是BOM">什么是BOM</h4><p>BOM是浏览器对象模型，它提供了独立于内容而与浏览器窗口进行交互的对象，其核心对象为window。它是JS访问浏览器的一个接口。</p><p>BOM由一系列的对象构成，并且每个对象都提供了很多的方法与属性。</p><p>BOM缺乏标准，JS的语法标准化阻止是ECMA，DOM的标准化组织是W3C。因此兼容性差。</p><p>BOM包含DOM。window(document,location,navigation,screen,history)</p><h4 id="窗口加载事件">窗口加载事件</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;<br>或者<br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;);<br></code></pre></div></td></tr></table></figure><p>window.onload是串口（页面）加载事件，当文档内容完全加载完成后会触发该事件（包括图像、脚本文件、CSS文件等），就调用的处理函数。</p><ol><li>有了<code>window.onload</code>就可以把JS代码写到页面元素上方，因为onload是等页面全部加载完毕后再去执行处理函数。</li><li><code>window.onload</code>传统注册事件只能写一次，如果有多个，会以最后一个<code>window.inload</code>为准。但用<code>addEventListener</code>则可以注册多个。</li><li><code>DOMContentLoaded</code>事件触发的时候，仅当DOM加载完毕，不包括样式表、图片、flash等。如果页面的图片很多的话，从用户访问到<code>onload</code>触发可能需要较长的事件，交互效果就不能实现，必然会影响用户体验，此处用<code>DOMContentLoaded</code>事件比较合适。</li></ol><h4 id="调整窗口大小事件">调整窗口大小事件</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><br>&#125;)<br></code></pre></div></td></tr></table></figure><ol><li>只要窗口大小发生变化就会触发。</li><li>我们经常利用这个事件完成响应式布局。<code>window.innerWidth</code>是当前的屏幕的宽度。</li></ol><h3 id="定时器-2">定时器</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><br>&#125;,<span class="hljs-number">1000</span>)<br><span class="hljs-keyword">var</span> timer1 = <span class="hljs-built_in">setTimeout</span>(callback,<span class="hljs-number">1000</span>);<br><span class="hljs-keyword">var</span> timer2 = <span class="hljs-built_in">setTimeout</span>(callback,<span class="hljs-number">2000</span>);<br><br><span class="hljs-built_in">clearTimeout</span>(timer1);  <span class="hljs-comment">//可以用来停止定时器</span><br><span class="hljs-built_in">setInterval</span>(callback,<span class="hljs-number">1000</span>);  <span class="hljs-comment">//间隔定时器（每隔一定时间不断调用）</span><br><span class="hljs-built_in">clearInterval</span>();<br></code></pre></div></td></tr></table></figure><ol><li><p>window可以省略。</p></li><li><p>延时时间的单位是ms，可以省略。</p></li><li><p>调用函数的位置可以是直接定义函数也可以写函数名。或者<code>'函数名()'</code>。</p></li><li><p>页面中可能有很多的定时器，我们经常给定时器加标识符（名字）。</p></li><li><p>在定时器内的函数我们也称为回调函数<code>callback</code>，普通函数是按找代码顺序执行的，但是这个函数需要等待时间，时间到了采取调用这个函数，因此称为回调函数。简单理解：回调，就是回头调用的意思，上一件事情干完，回头在调用这个函数。</p></li><li><p>清除定时器<code>window.clearTimeout(timer)</code>。</p></li><li><p><code>setInterval(callback,1000)</code>也是一个定时器，区别在于每隔1s都会调用函数，而<code>setTimeout()</code>只会调用一次。</p></li></ol><h4 id="定时器实现倒计时">定时器实现倒计时</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> hour = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.hour&#x27;</span>);<br><span class="hljs-keyword">var</span> minute = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.minute&#x27;</span>);<br><span class="hljs-keyword">var</span> second = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.second&#x27;</span>);<br><span class="hljs-keyword">var</span> inputTime = +<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&#x27;2022-5-13 18:00:00&#x27;</span>);  <span class="hljs-comment">//返回的是用户输入时间的总的毫秒数</span><br><span class="hljs-built_in">setInterval</span>(countDown,<span class="hljs-number">1000</span>);<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">countDown</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> nowTime = +<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();  <span class="hljs-comment">//返回的是当前时间的总的毫秒数</span><br><span class="hljs-keyword">var</span> times = (inputTime - nowTime ) / <span class="hljs-number">1000</span>;<br><span class="hljs-keyword">var</span> d = <span class="hljs-built_in">parseInt</span>(times / <span class="hljs-number">60</span> / <span class="hljs-number">60</span> / <span class="hljs-number">24</span>);<br>d = d &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + d : d;<br><span class="hljs-keyword">var</span> h = <span class="hljs-built_in">parseInt</span>(times / <span class="hljs-number">60</span> / <span class="hljs-number">60</span> % <span class="hljs-number">24</span>);<br>h = h &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + h : h;<br>    hour.<span class="hljs-property">innerHTML</span> = h;<br><span class="hljs-keyword">var</span> m = <span class="hljs-built_in">parseInt</span>(times / <span class="hljs-number">60</span> % <span class="hljs-number">60</span>);<br>m = m &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + m : m;<br>    minute.<span class="hljs-property">innerHTML</span> = m;<br><span class="hljs-keyword">var</span> s = <span class="hljs-built_in">parseInt</span>(times % <span class="hljs-number">60</span>);<br>s = s &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + s : s;<br>    second.<span class="hljs-property">innerHTML</span> = s;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="定时器实现按钮禁用和复原">定时器实现按钮禁用和复原</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">quertSelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br><span class="hljs-keyword">var</span> time = <span class="hljs-number">3</span>;<br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>btn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;<br><span class="hljs-keyword">var</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(time == <span class="hljs-number">0</span>)&#123;<br>btn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-built_in">clearInterval</span>(timer);<br>button.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;发送&#x27;</span>；<br>time = <span class="hljs-number">3</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>btn.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;还剩下&#x27;</span>+ time +<span class="hljs-string">&#x27;秒&#x27;</span>;<br>time --;<br>&#125;<br>&#125;,<span class="hljs-number">1000</span>);<br>&#125;);<br></code></pre></div></td></tr></table></figure><h3 id="JavaScript的执行机制">JavaScript的执行机制</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">3</span>);<br>&#125;,<span class="hljs-number">0</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">2</span>);<br><span class="hljs-comment">//A question: console.log的顺序是？   ——1、2、3</span><br></code></pre></div></td></tr></table></figure><h4 id="同步任务">同步任务</h4><p>同步任务都在主线程上执行，形成一个执行栈。</p><h4 id="异步任务">异步任务</h4><p>JS的异步是通过回调函数实现的。</p><p>一般而言，异步任务有以下三种类型。</p><ol><li>普通事件，如click、resize等。</li><li>资源加载，如load、error等。</li><li>定时器，包括setInterval、setTimeout等。</li></ol><p>异步任务相关回调函数添加到任务队列中（任务队列也称为消息队列）。</p><h4 id="执行机制">执行机制</h4><ol><li><p>先执行执行栈中的同步任务。</p></li><li><p>异步任务（回调函数）放到任务队列中。</p></li><li><p>一旦执行栈中的所有同步任务执行完毕后，系统就会按次序读取任务队列中的异步任务，于是被读取的异步任务结束等待状态，进入执行栈，开始执行。</p></li><li><p>只有经过异步进程处理的异步任务才能被写入任务队列。（如click的异步任务，不点击的话就不会进入异步任务队列，同时每次click后都会有异步任务进入任务队列）</p></li><li><p>主进程不断的获得任务、执行任务、再获取任务、再执行任务，这种机制叫做事件循环。</p></li></ol><h3 id="Location对象">Location对象</h3><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql"><span class="hljs-keyword">location</span>.href        获取或者设置整个URL<br><span class="hljs-keyword">location</span>.host        返回主机（域名）<br><span class="hljs-keyword">location</span>.port        返回端口号（如果未写则返回空字符串）<br><span class="hljs-keyword">location</span>.pathname    返回路径<br><span class="hljs-keyword">location</span>.<span class="hljs-keyword">search</span>      返回参数<br><span class="hljs-keyword">location</span>.hash        返回片段  #后面内容（常见于链接锚点）<br><span class="hljs-keyword">location</span>.assign()    跟href一样，可以跳转页面（也称为重定向页面）<br><span class="hljs-keyword">location</span>.replace()   替换当前页面，因为不记录历史，所以不能后退页面<br></code></pre></div></td></tr></table></figure><h4 id="定时器自动跳转页面">定时器自动跳转页面</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>location.<span class="hljs-property">href</span> = <span class="hljs-string">&quot;https://www.bitter-gourd.com&quot;</span>;<br>&#125;,<span class="hljs-number">5000</span>)；<br></code></pre></div></td></tr></table></figure><h4 id="数据在不同页面之间传递">数据在不同页面之间传递</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//利用form表单可以submit参数,在通过一些字符串操作把需要的参数分离出来</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(location.<span class="hljs-property">search</span>);  <span class="hljs-comment">//?uname=andy</span><br><span class="hljs-comment">//1.先去掉？  substr(&#x27;起始位置&#x27;，截取的字符数);</span><br><span class="hljs-keyword">var</span> params = location.<span class="hljs-property">search</span>.<span class="hljs-title function_">substr</span>(<span class="hljs-number">1</span>);  <span class="hljs-comment">//uname=andy</span><br><span class="hljs-comment">//2.利用=把字符串分割为数组  spilt(&#x27;=&#x27;);</span><br><span class="hljs-keyword">var</span> arr = params.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;=&#x27;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr);  <span class="hljs-comment">//[uname,andy];</span><br></code></pre></div></td></tr></table></figure><h4 id="location对象的一些方法">location对象的一些方法</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//location.assign()  记录浏览记录，可以实现后退功能</span><br><span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>location.<span class="hljs-title function_">assign</span>(<span class="hljs-string">&#x27;https://www.bitter-gourd.com&#x27;</span>);<br>&#125;)<br><br><span class="hljs-comment">//location.replace()  不记录浏览记录，不可以实现后退功能</span><br><span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>location.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;https://www.bitter-gourd.com&#x27;</span>);<br>&#125;)<br><br><span class="hljs-comment">//location.reload()  相当于刷新页面</span><br><span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);<br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>location.<span class="hljs-title function_">reload</span>();<br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="navigator对象">navigator对象</h3><p><code>navigator</code>对象包含有关浏览器的信息，它有很多属性，我们最常用的是<code>userAgent</code>，该属性可以返回由客户端发生服务器的<code>user-agent</code>头部的值。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span>((navigator,userAgent.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(phone|pad|pod|iphone|ipad|ipod|ios|Androdi|Mobile|BlachBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows phone)/i</span>)))&#123;<br><span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&quot;&quot;</span>;  <span class="hljs-comment">//移动端</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&quot;&quot;</span>;  <span class="hljs-comment">//PC端</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="history对象">history对象</h3><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">history.<span class="hljs-title function_">forward</span>();  <span class="hljs-comment">//后退</span><br>history.<span class="hljs-title function_">back</span>();     <span class="hljs-comment">//前进</span><br>history.<span class="hljs-title function_">go</span>(参数);    <span class="hljs-comment">//后退和前进，参数1则前进1个页面，参数为-1则后退一个页面</span><br></code></pre></div></td></tr></table></figure><h3 id="本地存储">本地存储</h3><h4 id="本地存储特性">本地存储特性</h4><ol><li>数据存储在用户浏览器中。</li><li>设置、读取方便、甚至页面刷新不丢失数据。</li><li>容量较大，<code>sessionStorage</code>约5M、<code>localStorage</code>约20M。</li><li>只能存储字符串，可以将对象<code>JSON.stringify()</code>编码后存储。</li></ol><h4 id="window-sessionStorage"><code>window.sessionStorage</code></h4><ol><li>生命周期为关闭浏览器窗口。</li><li>在同一个窗口（页面）下数据可以共享。</li><li>以键值对的形式存储使用。</li></ol><p><code>sessionStorage.setItem(key,value)</code>存储数据</p><p><code>sessionStorage.getItem(key)</code> 得到数据</p><p><code>sessionStorage.removeItem(key)</code>删除数据</p><p><code>sessionStorage.clear()</code>清除所有数据</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> ipt = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.input&#x27;</span>);<br><span class="hljs-keyword">var</span> set = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.set&#x27;</span>);<br><span class="hljs-keyword">var</span> get = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.get&#x27;</span>);<br><span class="hljs-keyword">var</span> remove = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.remove&#x27;</span>);<br>set.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> val = ipt.<span class="hljs-property">value</span>;<br>sessionStorage.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&#x27;uname&#x27;</span>,val);<br>&#125;)<br>get.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> name = sessionStorage.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;uname&#x27;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name);<br>&#125;)<br>remove.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    sessionStorage.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">&#x27;uname&#x27;</span>);<br>&#125;)<br><br><span class="hljs-comment">//如何查看？   Application -&gt; Storage -&gt; Session Storage</span><br></code></pre></div></td></tr></table></figure><h4 id="window-localStorage"><code>window.localStorage</code></h4><ol><li>生命周期永久生效，除非手动删除否则关闭页面也会存在。</li><li>可以多窗口（页面）共享，前提是同一浏览器。</li><li>以键值对的形式存储。</li><li>用处：记住用户名的</li></ol><p><code>localStorage.setItem(key,value)</code>存储数据</p><p><code>localStorage.getItem(key)</code> 得到数据</p><p><code>localStorage.removeItem(key)</code>删除数据</p><p><code>localStorage.clear()</code>清除所有数据</p><h4 id="记住用户名的勾选框">记住用户名的勾选框</h4><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">//&lt;input type=&quot;text&quot; id=&quot;username&quot;&gt;</span><br><span class="hljs-comment">//&lt;input type=&quot;checkbox&quot; name=&quot;&quot; id=&quot;remember&quot;&gt;</span><br><br><span class="hljs-keyword">var</span> username = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#username&#x27;</span>);<br><span class="hljs-keyword">var</span> remember = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#remember&#x27;</span>);<br><span class="hljs-keyword">if</span>(localStory.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;username&#x27;</span>))&#123;<br>username.<span class="hljs-property">value</span> = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;username&#x27;</span>);<br>remember.<span class="hljs-property">checked</span> = <span class="hljs-literal">true</span>;<br>&#125;<br>remember.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span>)&#123;<br><span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&#x27;username&#x27;</span>,username.<span class="hljs-property">value</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">&#x27;username&#x27;</span>);<br>&#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>github上显示图片</title>
    <link href="/2022/05/10/github%E4%B8%8A%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87/"/>
    <url>/2022/05/10/github%E4%B8%8A%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87/</url>
    
    <content type="html"><![CDATA[<h2 id="在github上显示图片">在github上显示图片</h2><p>（1）首先在你的本地项目目录下新建一个Screenshots文件夹，用于来存放需要显示的图片，我放入1.png一张图片；</p><p>（2）在本地编辑.md文件，来引用这张图片，引用图片的语法如下：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">![Alt text](https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/用户名/</span>repository仓库名<span class="hljs-regexp">/raw/</span>分支名<span class="hljs-regexp">/存放图片的文件夹名/</span>.png .jpg)<br></code></pre></div></td></tr></table></figure><p>（3）最后把你的项目提交或者更新到Github上时，Github会自动解析这个语法，并把图片在.md文件中显示出来。</p><p>(4)  同时你会发现本地.md文件也可以解析文件地址，此时就可以愉快地删除本地文件了！因为这一操作等价于将图片上传到服务器上。</p>]]></content>
    
    
    <categories>
      
      <category>开发环境配置</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hexo+fluid使用指南</title>
    <link href="/2022/05/10/hexo-fluid%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    <url>/2022/05/10/hexo-fluid%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
    
    <content type="html"><![CDATA[<h2 id="Hexo命令整理">Hexo命令整理</h2><h4 id="更新博客">更新博客</h4><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">hexo g -d</span><br><span class="hljs-attribute">hexo s</span><br></code></pre></div></td></tr></table></figure><h4 id="创建文章">创建文章</h4><p>执行如下命令创建一篇新文章，名为《测试文章》</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">hexo new post 测试文章<br></code></pre></div></td></tr></table></figure><p>执行完成后在<code>source\_posts</code>目录下生成了一个<code>.md</code>文件和一个同名的资源目录(用于存放图片)。</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">测试文章</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2021-06-10 16:35:20</span><br><span class="hljs-attr">tags:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">原创</span><br><span class="hljs-attr">categories:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">Javascript</span><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-string">这是一篇测试文章</span><br><span class="hljs-type">![</span><span class="hljs-string">图片引用方法三](test.png)</span><br></code></pre></div></td></tr></table></figure><h4 id="删除文章">删除文章</h4><p>直接删除本地文件，然后更新博客。</p><h4 id="在文章里面显示图片">在文章里面显示图片</h4><p>插件<code>hexo-renderer-marked</code>解决了这个问题。可以只用<code>npm install hexo-renderer-marked</code>命令直接安装，之后在<code>config.yaml</code>中更改配置如下：</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">post_asset_folder:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">marked:</span><br>  <span class="hljs-attr">prependRoot:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">postAsset:</span> <span class="hljs-literal">true</span><br></code></pre></div></td></tr></table></figure><p>之后就可以在使用<code>![](test.jpg)</code>的方式愉快的插入图片了。</p><h4 id="文章在首页的封面图">文章在首页的封面图</h4><p>对于单篇文章，在文章开头中配置 <code>index_img</code> 属性。</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">文章标题</span><br><span class="hljs-attr">tags:</span> [<span class="hljs-string">Hexo</span>, <span class="hljs-string">Fluid</span>]<br><span class="hljs-attr">index_img:</span> <span class="hljs-string">/img/example.jpg</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2022-5</span><span class="hljs-number">-10</span> <span class="hljs-number">22</span><span class="hljs-string">:00:00</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">以下是文章内容</span><br></code></pre></div></td></tr></table></figure><p><code>/img/example.jpg</code> 对应的是存放在 <code>/source/img/example.jpg</code> 目录下的图片（目录也可自定义，但必须在 source 目录下）。</p><p>也可以使用外链 Url 的绝对路径。</p><p>如果想统一给文章设置一个默认图片（文章不设置 <code>index_img</code> 则默认使用这张图片），可在<strong>主题配置</strong>中设置：</p><figure class="highlight dts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dts"><span class="hljs-symbol">post:</span><br><span class="hljs-symbol">  default_index_img:</span> <span class="hljs-keyword">/img/</span>example.jpg<br></code></pre></div></td></tr></table></figure><p>当 <code>default_index_img</code> 和 <code>index_img</code> 都为空时，该文章在首页将不显示图片。</p><h2 id="Hexo-fluid美化">Hexo+fluid美化</h2><h3 id="1-友链设置">1. 友链设置</h3><p>友情链接页用于展示好友的博客入口，默认关闭，开启需要先在 <code>navbar</code> 项中将 <code>links</code> 的注释(#号)删掉。</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">navbar:</span><br>  <span class="hljs-attr">menu:</span><br>    <span class="hljs-bullet">-</span> &#123; <span class="hljs-attr">key:</span> <span class="hljs-string">&#x27;links&#x27;</span>, <span class="hljs-attr">link:</span> <span class="hljs-string">&#x27;/links/&#x27;</span>, <span class="hljs-attr">icon:</span> <span class="hljs-string">&#x27;iconfont icon-link-fill&#x27;</span> &#125;<br><span class="hljs-string">Copy</span><br></code></pre></div></td></tr></table></figure><p>然后找到 <code>links</code> 的配置项，对页面内容进行配置：</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">links:</span><br>  <span class="hljs-attr">items:</span><br>    <span class="hljs-bullet">-</span> &#123;<br>      <span class="hljs-attr">title:</span> <span class="hljs-string">&#x27;Fluid Docs&#x27;</span>,<br>      <span class="hljs-attr">intro:</span> <span class="hljs-string">&#x27;主题使用指南&#x27;</span>,<br>      <span class="hljs-attr">link:</span> <span class="hljs-string">&#x27;https://hexo.fluid-dev.com/docs/&#x27;</span>,<br>      <span class="hljs-attr">image:</span> <span class="hljs-string">&#x27;/img/favicon.png&#x27;</span><br>    &#125;<br><span class="hljs-string">Copy</span><br></code></pre></div></td></tr></table></figure><ul><li><code>title</code>: 友链站的标题</li><li><code>intro</code>: 站点或博主的简介，可省略</li><li><code>link</code>: 跳转链接</li><li><code>image</code>: 头像图片，可省略</li></ul><h3 id="2-hexo支持emoji">2.hexo支持emoji</h3><p>首先进入博客目录,卸载<code>hexo</code>默认的marked渲染器，安装markdown-it渲染器，运行的命令如：</p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">cd Documents/blog<br>npm un hexo-renderer-marked <span class="hljs-comment">--save</span><br>npm i hexo-renderer-markdown-<span class="hljs-keyword">it</span> <span class="hljs-comment">--save</span><br></code></pre></div></td></tr></table></figure><p>之后安装<code>markdown-it-emoji</code>插件：</p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">npm install markdown-<span class="hljs-keyword">it</span>-emoji <span class="hljs-comment">--save</span><br></code></pre></div></td></tr></table></figure><p>这里的站点配置文件是指位于博客根目录下的 <code>_config.yml</code>，编辑它，然后在末尾添加如下内容：</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-comment">## Markdown-it config</span><br><span class="hljs-comment">## Docs: https://github.com/celsomiranda/hexo-renderer-markdown-it/wiki</span><br><span class="hljs-attr">markdown:</span><br>  <span class="hljs-attr">render:</span><br>    <span class="hljs-attr">html:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">xhtmlOut:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">breaks:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">linkify:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">typographer:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">quotes:</span> <span class="hljs-string">&#x27;“”‘’&#x27;</span><br>  <span class="hljs-attr">plugins:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">markdown-it-abbr</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">markdown-it-footnote</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">markdown-it-ins</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">markdown-it-sub</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">markdown-it-sup</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">markdown-it-emoji</span>  <span class="hljs-comment"># add emoji</span><br>  <span class="hljs-attr">anchors:</span><br>    <span class="hljs-attr">level:</span> <span class="hljs-number">2</span><br>    <span class="hljs-attr">collisionSuffix:</span> <span class="hljs-string">&#x27;v&#x27;</span><br>    <span class="hljs-attr">permalink:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">permalinkClass:</span> <span class="hljs-string">header-anchor</span><br>    <span class="hljs-attr">permalinkSymbol:</span> <span class="hljs-string">¶</span><br></code></pre></div></td></tr></table></figure><p>在anchors这里配置需要小心，我不是很喜欢这个风格，于是就删去了。</p><h3 id="3-评论">3.评论</h3><p>开启评论需要在<strong>主题配置</strong>中开启并指定评论模块：</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">comments:</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">disqus</span><br></code></pre></div></td></tr></table></figure><p>然后在下方还要设置对应评论模块的参数，比如 disqus 对应设置：</p><figure class="highlight dts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dts"><span class="hljs-symbol">disqus:</span><br><span class="hljs-symbol">  shortname:</span> fluid<br></code></pre></div></td></tr></table></figure><p>当前支持 Valine、Disqus、Gitalk、Utterances、畅言、来必力 (livere)、Remark42、twikoo，使用和参数设置需要自行查询各自的文档（文档地址在配置注释里）。</p><p>若需要自定义添加其他评论系统，请自行在 <code>fluid/layout/_partial/comments/</code> 目录内创建 ejs 文件，参照自带的 ejs 填入评论服务商提供的代码，再修改 <code>post.comments.type</code> 为对应文件名。</p><h3 id="4-生成站点地图">4.生成站点地图</h3><ol><li>安装站点地图生成插件</li></ol><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">npm <span class="hljs-keyword">install </span>hexo-generator-<span class="hljs-keyword">baidu-sitemap </span>--save<br>npm <span class="hljs-keyword">install </span>hexo-generator-sitemap --save<br></code></pre></div></td></tr></table></figure><ol start="2"><li>在博客根目录的<code>_config.yml</code>中添加自动生成sitemap的配置</li></ol><figure class="highlight dts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dts"><span class="hljs-symbol">sitemap:</span><br><span class="hljs-symbol">  path:</span> sitemap.xml<br><span class="hljs-symbol">baidusitemap:</span><br><span class="hljs-symbol">  path:</span> baidusitemap.xml<br></code></pre></div></td></tr></table></figure><p>同时确认一下该文件里面url对应的是否是接下来要提交的域名</p><ol start="3"><li>生成和部署</li></ol><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">hexo g</span><br><span class="hljs-attribute">hexo d</span><br></code></pre></div></td></tr></table></figure><p>此时会在<code>public</code>目录下生成两个文件</p><blockquote><p><code>sitemap.xml</code> 用于提交给谷歌</p><p><code>baidusitemap.xml</code> 用于提交给百度</p></blockquote><p>部署成功后，在浏览器打开 <code>你的域名/baidusitemap.xml</code>，成功展示即代表成功</p><p><img src="test.png" alt="部署测试"></p><h4 id="百度收录">百度收录</h4><p><strong>开发目的（摘录）：</strong></p><p>某些主机，比如Github，禁止百度爬虫访问博客，导致博客无法被百度收录。多亏百度提供了主动提交的接口，这才有了个补救的方法。</p><p>除此之外， 使用主动推送还会达到如下功效：</p><ul><li>及时发现：可以缩短百度爬虫发现您站点新链接的时间，使新发布的页面可以在第一时间被百度收录</li><li>保护原创：对于网站的最新原创内容，使用主动推送功能可以快速通知到百度，使内容可以在转发之前被百度发现</li></ul><figure class="highlight mipsasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mipsasm">npm <span class="hljs-keyword">install </span>hexo-<span class="hljs-keyword">baidu-url-submit </span>--save<br></code></pre></div></td></tr></table></figure><p>配置根目录_config.yml写入以下配置：</p><figure class="highlight dts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dts"><span class="hljs-symbol">baidu_url_submit:</span><br><span class="hljs-symbol">  count:</span> <span class="hljs-number">100</span>                          <span class="hljs-meta"># 提交最新的多少个链接</span><br><span class="hljs-symbol">  host:</span> https:<span class="hljs-comment">//yourname.gitee.io/    # 在百度站长平台中添加的域名</span><br><span class="hljs-symbol">  token:</span> your_token               <span class="hljs-meta"># 秘钥</span><br><span class="hljs-symbol">  path:</span> baidu_urls.txt                <span class="hljs-meta"># 文本文档的地址,新链接会保存在此文本文档里Copy</span><br></code></pre></div></td></tr></table></figure><p>修改<strong>站点url为自己购买的域名</strong>，最后获取token配置提交方案：</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">deploy:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">git</span> <span class="hljs-comment">## 这是原来的deployer</span><br>  <span class="hljs-attr">repo:</span><br>  <span class="hljs-attr">branch:</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">baidu_url_submitter</span> <span class="hljs-comment">## 在这里添加新内容即可</span><br></code></pre></div></td></tr></table></figure><p>可以看出是增加了一个提交的type，然后执行部署提交的时候就可以实现主动推送了</p><p>同时在<code>hexo\.deploy_git\</code>路径下会生成一个<code>baidu_urls.txt</code>文件，其中包含了你站点中的URL链接。</p><p><strong>如何获取百度收录的token?</strong></p><p>您得注册百度站长工具，然后在<strong>工具-&gt;网页抓取-&gt;链接提交</strong>里找到你的密匙。</p><p>在注册百度站长工具的时候，需要我们验证个人信息、添加网站域名。</p><p><img src="%E6%B7%BB%E5%8A%A0%E7%BD%91%E7%AB%99.png" alt="添加网站"></p><p>然后验证网站所有权。有三种方式：（我选择了第一种）</p><ol><li>文件验证。</li><li>HTML标签验证。</li><li>CNAME验证</li></ol><p><img src="%E9%AA%8C%E8%AF%81%E7%BD%91%E7%AB%99.png" alt="验证网站，找来的图有点糊"></p><p>下载文件，放在<code>themes/fluid/source</code>(或者其他主题的source目录下面)</p><p><strong>为什么放到主题的source下而不直接放在站点source下面呢？</strong></p><p>因为站点source下面的html文件都会被按照主题样式重新渲染，最后html文件的内容会被改变，百度验证就不能识别。</p><p><img src="your_token.png" alt="获取token"></p><p><strong>再次生成和部署</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">hexo g</span><br><span class="hljs-attribute">hexo d</span><br></code></pre></div></td></tr></table></figure><p><img src="success.png" alt="成功推送"></p><h4 id="谷歌收录">谷歌收录</h4><p><a href="search.google.com/search-console">谷歌搜索域名提交网站</a></p><p><img src="%E8%B0%B7%E6%AD%8C%E6%8F%90%E4%BA%A4%E7%BD%91%E7%AB%99.png" alt="谷歌添加网站"></p><p>然后需要验证，与百度验证的方式相同，下载文件放在<code>themes/fluid/source</code>(或者其他主题的source目录下面)</p><p><strong>生成和部署</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">hexo g</span><br><span class="hljs-attribute">hexo d</span><br></code></pre></div></td></tr></table></figure><p><img src="%E5%AE%8C%E6%88%90%E6%94%B6%E5%BD%95%E5%90%8E%E7%AD%89%E5%BE%85.png" alt="完成网站提交后需要等一天..."></p>]]></content>
    
    
    <categories>
      
      <category>开发环境配置</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>js中===和==</title>
    <link href="/2022/05/09/js%E4%B8%AD-%E5%92%8C/"/>
    <url>/2022/05/09/js%E4%B8%AD-%E5%92%8C/</url>
    
    <content type="html"><![CDATA[<h1>JavaScript 中 == 和 === 的区别</h1><p>和其他语言有些不同，在 JavaScript 中除了用<code>==</code>操作符来判断是否相等外，还有一个<code>===</code>操作符，它们的区别是：<code>==</code>操作符会先将两边的值进行强制类型转换再比较是否相等，而<code>===</code>操作符不会进行类型转换。<code>==</code>操作符只要求比较两个值是否相等，而<code>===</code>操作符不仅要求值相等，而且要求类型相同。<code>!=</code>和<code>!==</code>的区别也是类似的，<code>!=</code>号会做强制类型转换，而<code>!==</code>不会。</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-number">55</span> == <span class="hljs-string">&#x27;55&#x27;</span><br><span class="hljs-comment">// true</span><br><span class="hljs-number">55</span> === <span class="hljs-string">&#x27;55&#x27;</span><br><span class="hljs-comment">// false</span><br></code></pre></div></td></tr></table></figure><p>第一个操作数是数值类型的<code>55</code>，第二个操作数是字符串类型的<code>&quot;55&quot;</code>。当一个操作数是字符串，另一个操作数是数值的时候，操作符<code>==</code>会把字符串转换成数值，所以结果就返回了<code>true</code>。而<code>===</code>不会做强制转换，所以数值类型的<code>55</code>和字符串类型的<code>&quot;55&quot;</code>当然是不相等的了。</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-title class_">NaN</span> == <span class="hljs-title class_">NaN</span><br><span class="hljs-comment">// false</span><br><span class="hljs-title class_">NaN</span> === <span class="hljs-title class_">NaN</span><br><span class="hljs-comment">// false</span><br></code></pre></div></td></tr></table></figure><p>这里有一个特殊值<code>NaN</code>，即 Not a Number，表示非数字，它和任何数做相等比较，包括它自己，都会返回<code>false</code>。所以判断<code>NaN</code>最好用<code>isNaN()</code>函数。</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-literal">null</span> == <span class="hljs-literal">undefined</span><br><span class="hljs-comment">// true</span><br><span class="hljs-literal">null</span> === <span class="hljs-literal">undefined</span><br><span class="hljs-comment">// false</span><br></code></pre></div></td></tr></table></figure><p><code>null</code>也让人觉得难以理解。<code>null</code>用来表示空值，<code>undefined</code>用来表示不存在，但这在实际开发中并没有什么用，而且==和===对它们的处理也不一样。</p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Problems-Using-Arch</title>
    <link href="/2022/05/09/Problems-Using-Arch/"/>
    <url>/2022/05/09/Problems-Using-Arch/</url>
    
    <content type="html"><![CDATA[<h1>Tons of problems bitter-gourd meets when using archlinux</h1><h3 id="前言：">前言：</h3><p>为了纪念存活17天的archlinux（4.9-4.25）以及懊恼于重装系统后搭建开发环境时第二遍踩入的坑。也为了防止下一次重装系统时走入歧途，同时希望对完成装载archlinux系统后配置环境的同学提供一些帮助，bitter-gourd决定写下一些文字。</p><p>此处特别鸣谢全世界最好的❤️鲨鱼姐姐❤️</p><p><strong>一些友情链接:</strong></p><p><a href="https://www.viseator.com/2017/07/02/arch_more/">1.viseator学长archlinux下配置开发环境</a></p><p><a href="https://www.viseator.com/2017/05/17/arch_install/">2.viseator学长安装arch教程</a></p><p><a href="https://github.com/JunkFood02/Arch-Linux-Installation-Guide">3.鲨鱼姐姐安装arch教程</a></p><h3 id="4-30补充："><strong>4.30补充</strong>：</h3><p>为了纪念存活4天的archlinux(4.26-4.29)bitter-gourd决定再写点配置过程中新遇到的坑和解决方案。</p><h3 id="配置git">配置git</h3><p>1.git默认编辑器为vi，而非vim，因此建议在安装vscode后将默认编辑器转换后再打开configuration file</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">git config --global core.editor &quot;code --wait&quot;<br>git config --global -e<br></code></pre></div></td></tr></table></figure><p>2.但是我们如果需要配置git的代理，又不能打开configuration file该怎么办捏？</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">git config --global http.proxy http://<br></code></pre></div></td></tr></table></figure><h3 id="使用yay过程中遇到的困难">使用yay过程中遇到的困难</h3><p>在一个<em>天xian气de晴dan朗teng</em>的下午想yay a package 但看到这个东西。</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">error: GPGME error: No data<br>error: GPGME error: No data<br>error: GPGME error: No data<br>:: Synchronising package databases...<br> core                                                                974.9 KiB  1134 KiB/s 00:01 [#########################################################] 100%<br> extra                                                               974.9 KiB  1547 KiB/s 00:01 [#########################################################] 100%<br> community                                                           974.9 KiB  1486 KiB/s 00:01 [#########################################################] 100%<br>error: GPGME error: No data<br>error: GPGME error: No data<br>error: GPGME error: No data<br></code></pre></div></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">Solution:<br>sudo rm -R /var/lib/pacman/sync<br>sudo -E pacman -Syu<br></code></pre></div></td></tr></table></figure><h3 id="安装ZShell过程中遇到的困难">安装ZShell过程中遇到的困难</h3><p>1.<a href="https://ohmyz.sh/#install">oh-my-zsh的安装</a> 需要安装curl然后直接在官网复制命令行。</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yay -Syu curl<br>sh -c &quot;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&quot;<br></code></pre></div></td></tr></table></figure><p>2.初次安装zsh选择设置时<s>脑抽</s>选到q，将设置界面跳过，关于如何再次打开和做处理。</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">设置界面：<br>This is the Z Shell configuration function for new users,<br>zsh-newuser-install.<br>You are seeing this message because you have no zsh startup files<br>(the files .zshenv, .zprofile, .zshrc, .zlogin in the directory<br>~).  This function can help you with a few settings that should<br>make your use of the shell easier.<br><br>You can:<br><br>(q)  Quit and do nothing.  The function will be run again next time.<br><br>(0)  Exit, creating the file ~/.zshrc containing just a comment.<br>     That will prevent this function being run again.<br><br>(1)  Continue to the main menu.<br><br>(2)  Populate your ~/.zshrc with the configuration recommended<br>     by the system administrator and exit (you will need to edit<br>     the file by hand, if so desired).<br><br>--- Type one of the keys in parentheses --- <br><br>solution:<br>autoload -U zsh-newuser-install<br>zsh-newuser-install -f<br>成功打开 zsh-new-install 的界面<br>但是会发现界面变了，需要自己配置1、2、3然后按0保存退出（本人英语水平较差，此处也遇到困难）<br></code></pre></div></td></tr></table></figure><p>3.oh-my-zsh插件通过yay安装且添加到.zshrc后报错</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">error:<br>[oh-my-zsh] plugin &#x27;zsh-autosuggestions&#x27; not found<br>[oh-my-zsh] plugin &#x27;zsh-syntax-highlighting&#x27; not found<br><br>solution:<br>git clone https://github.com/zsh-users/zsh-autosuggestions ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions<br>git clone https://github.com/zsh-users/zsh-syntax-highlighting ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting<br><br></code></pre></div></td></tr></table></figure><p>4.在zsh中始终出现 ➜  ~ git:(master) ✗ 如何改成 ~</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">error:<br>➜  ~ git:(master) ✗<br><br>solution:<br>code .zshrc<br>PROMPT=&quot;%(?:%&#123;$fg_bold[green]%&#125;➜ :%&#123;$fg_bold[red]%&#125;➜ ) %&#123;$fg[cyan]%&#125;%c%&#123;$reset_color%&#125;&#x27;<br></code></pre></div></td></tr></table></figure><p>补充：事实上只是 git init了home目录。</p><p>5.将zsh设为默认shell</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo chsh -s /bin/zsh username<br></code></pre></div></td></tr></table></figure><p>6.zsh内中文显示与git中文显示问题</p><p>发现将zsh locale设置成英文后，仍然有大量中文。</p><p>友情链接：</p><p><a href="https://wiki.archlinux.org/title/Locale_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E6%88%91%E7%9A%84%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%AF%AD%E8%A8%80%E8%BF%98%E6%98%AF%E4%B8%8D%E5%AF%B9">https://wiki.archlinux.org/title/Locale_(简体中文)#我的系统的语言还是不对</a></p><figure class="highlight makefile"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs makefile">cd ~/.config<br>code plasma-localerc<br><br><span class="hljs-section">delete:</span><br>[Translations]<br>LANGUAGE=en_US:zh_CN<br><br><span class="hljs-section">reason:</span><br>KDE Plasma change the locale in zsh<br></code></pre></div></td></tr></table></figure><p>git设置：</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">code .zshrc<br>alias git=&#x27;LANG=en_GB git&#x27;<br></code></pre></div></td></tr></table></figure><h3 id="一些有用的package">一些有用的package</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yay -S tokei   (代码统计)<br>yay -S spectacle（截图工具，可以自己设置快捷键）<br>yay -S Yakuake  (终端模拟器,快捷键F12)<br>yay -S screenfetch (终端上显示archlinux系统信息)<br>yay -S deepin-wine-qq (qq)<br>yay -S typora  (typora)<br></code></pre></div></td></tr></table></figure><h3 id="中文输入法">中文输入法</h3><p>中文输入法需要安装<code>fcitx</code>包与<code>fcitx-im</code>集合包，再加上一个中文支持包，可以到下面这个链接中挑选一个喜欢的包装上。(推荐搜狗拼音)</p><p><a href="https://wiki.archlinux.org/index.php/fcitx#Chinese">https://wiki.archlinux.org/index.php/fcitx#Chinese</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yay -S fcitx<br>yay -S fcitx-im<br>yay -S fcitx-sogoupinyin<br></code></pre></div></td></tr></table></figure><p>装完以后需要修改<code>/etc/profile</code>文件，在文件开头加入三行：</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">export XMODIFIERS=&quot;@im=fcitx&quot;<br>export GTK_IM_MODULE=&quot;fcitx&quot;<br>export QT_IM_MODULE=&quot;fcitx&quot;<br></code></pre></div></td></tr></table></figure><p>倘若在安装中文输入法的过程中不小心安装某些百度输入法会发现无法使用，且每次yay都会在“searching AUR for updates”中出现如下提示(孤儿包)：</p><p><a href="https://wiki.archlinux.org/index.php/fcitx#Chinese">https://wiki.archlinux.org/index.php/fcitx#Chinese</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">Orphaned AUR Packages:  fcitx-baidupinyin<br><br>solution:<br>pacman -Qtdq | pacman -Rns -<br></code></pre></div></td></tr></table></figure><h3 id="系统时间">系统时间</h3><p>如果发现系统时间错乱(包括archlinux和windows)的解决方案：</p><p>友情链接：</p><p><a href="https://wiki.archlinux.org/title/System_time#Read_hardware_clock">https://wiki.archlinux.org/title/System_time#Read_hardware_clock</a></p><p><a href="https://wiki.archlinux.org/title/System_time#UTC_in_Microsoft_Windows">https://wiki.archlinux.org/title/System_time#UTC_in_Microsoft_Windows</a></p><h3 id="安装QQ">安装QQ</h3><p>友情链接：</p><p><a href="https://github.com/vufa/deepin-wine-qq-arch">https://github.com/vufa/deepin-wine-qq-arch</a></p><p>省流版：</p><p><code>deepin-wine-qq</code> 依赖<code>Multilib</code>仓库中的一些32位库，Archlinux默认没有开启 <code>Multilib</code>仓库，需要编辑<code>/etc/pacman.conf</code>，取消对应行前面的注释(<a href="https://wiki.archlinux.org/index.php/Official_repositories#multilib">Archlinux wiki</a>):</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">If you want to run 32 bit applications on your x86_64 system,</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">enable</span> the multilib repositories as required here.</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">[multilib-testing]</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">Include = /etc/pacman.d/mirrorlist</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">-#</span><span class="language-bash">[multilib]</span><br><span class="hljs-meta prompt_">-#</span><span class="language-bash">Include = /etc/pacman.d/mirrorlist</span><br>+[multilib]<br>+Include = /etc/pacman.d/mirrorlist<br></code></pre></div></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yay -S deepin-wine-qq<br></code></pre></div></td></tr></table></figure><p>如果还是发现32位文件无法安装，应该是需要<code>-Syu</code></p><figure class="highlight perl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs perl">yay -Syu<br>或者上述命令改为 yay -Syu deepin-wine-<span class="hljs-keyword">qq</span><br></code></pre></div></td></tr></table></figure><p>-y 更新database<br>-u 更新系统<br>-Syu 需要一起出现！！！ 否则会出现新AUR包不匹配旧的系统。</p><p>长时间没有更新，则…喜提重装arch体验卡！</p><p>yay -Syu的时候是先更新系统再更新AUR包。</p><h3 id="视频无法播放">视频无法播放</h3><p>遇到YouTubu无法播放视频，原因很有可能是<a href="https://wiki.archlinux.org/title/PulseAudio">pulseaudio</a></p><p><strong>临时的解决方法</strong></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">pulseaudio --kill<br>pulseaudio --start<br></code></pre></div></td></tr></table></figure><p><strong>更好的解决方法</strong></p><p><a href="https://bbs.archlinux.org/viewtopic.php?id=276596">Browser Not Playing Video</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yay -Rdd pulseaudio<br>yay -Syu pipewire-pulse<br></code></pre></div></td></tr></table></figure><h3 id="PC喇叭">PC喇叭</h3><p>遇到关机、休眠、重启时有“嘟”的一声，在wine-qq里面多按一下backspace键会有“嘟”的一声。<a href="https://wiki.archlinux.org/title/PC_speaker">PC speaker</a></p><p>可以通过在内核模块中移除<code>pcspkr</code> 模块来完全禁用PC喇叭：</p><figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c"><span class="hljs-meta"># rmmod pcspkr</span><br></code></pre></div></td></tr></table></figure><p>将 <code>pcspkr</code> 模块加入黑名单的方法可以阻止 udev 在启动时加载它。创建文件：</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/etc/m</span>odprobe.d/nobeep.conf<br>blacklist pcspkr<br></code></pre></div></td></tr></table></figure><h3 id="修正简体中文显示为异体（日文）字形">修正简体中文显示为异体（日文）字形</h3><p><strong>问题描述：</strong></p><p>安装完字体包后会有个别字的写法不符合简体中文世界的标准。</p><p><strong>解决方法：</strong></p><p><a href="https://wiki.archlinux.org/title/Localization_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)/Simplified_Chinese_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E4%BF%AE%E6%AD%A3%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%E6%98%BE%E7%A4%BA%E4%B8%BA%E5%BC%82%E4%BD%93%EF%BC%88%E6%97%A5%E6%96%87%EF%BC%89%E5%AD%97%E5%BD%A2">archwiki上给出了清晰的解决方法</a></p><h3 id="VScode安装相关">VScode安装相关</h3><p>1.about failing to use contension:<code>open in browers </code></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">Vscode Error : <br>Open browser failed!! Please check if you have installed the browser correctly!<br><br>solution:<br>~/.vscode/extentions/techer.open-in-browser-2.0.0/out/config.js<br>change google-chrome to google-chrome-stable<br><br>reason:<br>for google chrome in arch linux is google-chrome-stable<br></code></pre></div></td></tr></table></figure><p>2.<code>Live Server</code></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">solution:<br>~<span class="hljs-regexp">/.vscode/</span>extentions<span class="hljs-regexp">/ritwickdet.liveserver-5.7.5/</span>out<span class="hljs-regexp">/src/</span>appModel.js<br>change google-chrome to google-chrome-stable<br><br>reason:<br><span class="hljs-keyword">for</span> google chrome <span class="hljs-keyword">in</span> arch linux is google-chrome-stable<br></code></pre></div></td></tr></table></figure><p>3.格式化代码快捷键变化</p><p><code>ctrl + shift + i </code></p>]]></content>
    
    
    <categories>
      
      <category>开发环境配置</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux命令全称</title>
    <link href="/2022/05/09/linux%E5%91%BD%E4%BB%A4%E5%85%A8%E7%A7%B0/"/>
    <url>/2022/05/09/linux%E5%91%BD%E4%BB%A4%E5%85%A8%E7%A7%B0/</url>
    
    <content type="html"><![CDATA[<h1>Linux命令缩写的全称</h1><h4 id="【前言】">【前言】</h4><p>为了方便记忆linux命令，bitter-gourd决定整理一些linux命令缩写的全称。</p><h4 id="【目录-文件】">【目录|文件】</h4><p>ls : list(列出目录内容)</p><p>pwd : print work directory(打印当前目录，现示当前工作目录的绝对路径)</p><p>cd : change directory(改变目录)</p><p>rmdir: remove directory(删除目录)</p><p>mkdir: make directory(创建目录)</p><p>rm : remove(删除目录或文件)</p><p>mv : move file (移动文件)</p><p>cp : copy file(复制文件)</p><p>cat : concatenate(连锁)</p><h4 id="【系统-权限】">【系统|权限】</h4><p>su : switch user(切换用户)</p><p>uname: unix name(用于打印当前系统相关信息)</p><p>chown: change owner(改变某和文件或目录所有者和所属的组，，)</p><p>chgrp: change group(用于改变文件或所属的用户组)</p><p>chmod: change mode(用于变更文件或目录的权限)</p><h4 id="【进程-磁盘】">【进程|磁盘】</h4><p>ps : process status(进程状态，类似于wins任务管理器)</p><p>常用参数: -auxf ps -auxf (进程现示状态)</p><p>df : disk free(显示磁盘可用空间数目信息及空间节点信息。换句话说，就是查看在任何安装的设备或目录中还剩多少自由空间)</p><p>du : disk usage(查看已使用空间)</p><h4 id="【打包管理】">【打包管理】</h4><p>rpm : redhat package manger(红帽子打包管理器)</p><p>dpkg: debian package manager</p><p>apt: advanced package tool</p><h4 id="【文件后缀】">【文件后缀】</h4><p>文件结尾的rc: resource configratin(如 .xinitrc, .bashrc等)</p><p>knnxxx/snnxxx(位于rcx.d目录下):k(kill),s(service);nn(执行顺序号);xxx(服务标识)</p><p>.a(扩展名a): archive ,static library</p><p>.s(扩展名so): shared object,dynamically linked library</p><p>.o(扩展名o): olbject file, compiled result of c/c++ source file</p><h4 id="【其他】">【其他】</h4><p>insmod: install module(载入模块)</p><p>lsmod: list modules(用于显示已加载到内核模块的状态信息)</p><p>rmmod:remove module</p><p>in -s : link -soft(创建一个软链接，相当于创建一个快捷方式)</p><p>touch man:manual</p><p>mkfs: make file system (创建linux系统文件)</p><p>fsck: file system check(用于检查并试图修复文件系统中错误)</p><p>ln : link file(用于文件创建连接分为硬盘连接和符号连接)</p><p>fg : foreground(用于后台作业放到前台终端运行)</p><p>bg : background(用于将作业放到后台运行)</p><p>umount: unmount(用于卸载已经加载的系统文件)</p><p>tar : tape archive</p><p>ldd : list dynamic dependencies</p><h4 id="【部分linux-目录-参数-缩写】">【部分linux 目录|参数 缩写】</h4><p>bin = binarines</p><p>/dev = devices</p><p>/dev = etcetera</p><p>/lib = library</p><p>/proc = processes</p><p>/sbin= superuser binaries</p><p>/tmp= temporary</p><p>/usr= unix shared resources</p><p>/var= variable</p><p>? fifo= first in ,fitst out</p><p>grub= grand unified bootloader</p><p>ifs= internal field seperators</p><p>lilo= linux loader</p><p>mysql= my是最初作者的女儿的名字，sql=structured query language</p><p>（<strong>MySQL</strong>的发明者名叫 Michael “Monty” Widenius，<strong>MySQL是</strong>以他女儿的名字“<strong>My</strong>” 来命名的。 对这位发明者来说，<strong>MySQL</strong>数据库就仿佛<strong>是</strong>他可爱的女儿。）</p><p>php= personal home page tools=php hypertext preprocessor</p><p>ps = prompt string</p><p>perl= pratical extraction and report language=pathologically eclectic rubbish lister python得名于电视剧monty python’s flying circus</p><p>tcl= tool command language</p><p>tk = toolkit</p><p>vt = video terminal</p><p>yast= yet another</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>整理</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
